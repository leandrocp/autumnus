<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>zig - kanagawa_dragon - Autumnus</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,300;0,400;0,700;1,300;1,400;1,700&display=swap" rel="stylesheet">
    <style>
        * {
            font-family: 'JetBrains Mono', monospace;
            line-height: 1.5;
        }
        pre {
            font-size: 15px;
            margin: 20px;
            padding: 50px;
            border-radius: 10px;
        }
    </style>
</head>
<body>
<pre class="athl" style="color: #c5c9c5; background-color: #181616;"><code class="language-zig" translate="no" tabindex="0"><span class="athl-line" data-athl-line="1"><span style="color: #737c73;">//! Top-level documentation.</span>
</span><span class="athl-line" data-athl-line="2">
</span><span class="athl-line" data-athl-line="3"><span style="color: #737c73;">/// Documentation comment.</span>
</span><span class="athl-line" data-athl-line="4">
</span><span class="athl-line" data-athl-line="5"><span style="color: #737c73;">// Simple comment.</span>
</span><span class="athl-line" data-athl-line="6">```
</span><span class="athl-line" data-athl-line="7">
</span><span class="athl-line" data-athl-line="8">### <span style="color: #8ea4a2;">Hello</span> <span style="color: #c5c9c5;">world</span><span style="color: #9e9b93;">.</span>
</span><span class="athl-line" data-athl-line="9">
</span><span class="athl-line" data-athl-line="10">```<span style="color: #c4b28a;">zig</span>
</span><span class="athl-line" data-athl-line="11"><span style="color: #737c73;">// Import standard library, reachable through the &quot;std&quot; constant.</span>
</span><span class="athl-line" data-athl-line="12"><span style="color: #8992a7;">const</span> <span style="color: #8ea4a2;">std</span> <span style="color: #c4746e;">=</span> <span style="color: #c4746e;">@import</span><span style="color: #9e9b93;">(</span><span style="color: #8a9a7b;">&quot;std&quot;</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="13">
</span><span class="athl-line" data-athl-line="14"><span style="color: #737c73;">// &quot;info&quot; now refers to the &quot;std.log.info&quot; function.</span>
</span><span class="athl-line" data-athl-line="15"><span style="color: #8992a7;">const</span> <span style="color: #c5c9c5;">info</span> <span style="color: #c4746e;">=</span> <span style="color: #c5c9c5;">std</span><span style="color: #9e9b93;">.</span><span style="color: #c4b28a;">log</span><span style="color: #9e9b93;">.</span><span style="color: #c4b28a;">info</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="16">
</span><span class="athl-line" data-athl-line="17"><span style="color: #737c73;">// Usual hello world.</span>
</span><span class="athl-line" data-athl-line="18"><span style="color: #737c73;">// syntax: [pub] fn &lt;function-name&gt;(&lt;arguments&gt;) &lt;return-type&gt; { &lt;body&gt; }</span>
</span><span class="athl-line" data-athl-line="19"><span style="color: #8992a7;">pub</span> <span style="color: #8992a7;">fn</span> <span style="color: #8ba4b0;">main</span><span style="color: #9e9b93;">(</span><span style="color: #9e9b93;">)</span> <span style="color: #949fb5;">void</span> <span style="color: #9e9b93;">{</span>
</span><span class="athl-line" data-athl-line="20">    <span style="color: #737c73;">// Contrary to C functions, Zig functions have a fixed number of arguments.</span>
</span><span class="athl-line" data-athl-line="21">    <span style="color: #737c73;">// In C: &quot;printf&quot; takes any number of arguments.</span>
</span><span class="athl-line" data-athl-line="22">    <span style="color: #737c73;">// In Zig: std.log.info takes a format and a list of elements to print.</span>
</span><span class="athl-line" data-athl-line="23">    <span style="color: #8ba4b0;">info</span><span style="color: #9e9b93;">(</span><span style="color: #8a9a7b;">&quot;hello world&quot;</span><span style="color: #9e9b93;">,</span> <span style="color: #9e9b93;">.</span><span style="color: #9e9b93;">{</span><span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">;</span>  <span style="color: #737c73;">// .{} is an empty anonymous tuple.</span>
</span><span class="athl-line" data-athl-line="24"><span style="color: #9e9b93;">}</span>
</span><span class="athl-line" data-athl-line="25">```
</span><span class="athl-line" data-athl-line="26">
</span><span class="athl-line" data-athl-line="27">### <span style="color: #c4b28a;">Booleans</span><span style="color: #9e9b93;">,</span> <span style="color: #c5c9c5;">integers</span> <span style="color: #c4746e; font-weight: bold;">and</span> <span style="color: #c5c9c5;">float</span><span style="color: #9e9b93;">.</span>
</span><span class="athl-line" data-athl-line="28">
</span><span class="athl-line" data-athl-line="29">```<span style="color: #8ba4b0;">zig</span>
</span><span class="athl-line" data-athl-line="30"><span style="color: #737c73;">// Booleans.</span>
</span><span class="athl-line" data-athl-line="31"><span style="color: #737c73;">// Keywords are preferred to operators for boolean operations.</span>
</span><span class="athl-line" data-athl-line="32">print<span style="color: #9e9b93;">(</span><span style="color: #8a9a7b;">&quot;{}<span style="color: #c4746e; font-weight: bold;">\n</span>{}<span style="color: #c4746e; font-weight: bold;">\n</span>{}<span style="color: #c4746e; font-weight: bold;">\n</span>&quot;</span><span style="color: #9e9b93;">,</span> <span style="color: #9e9b93;">.</span><span style="color: #9e9b93;">{</span>
</span><span class="athl-line" data-athl-line="33">    <span style="color: #b6927b; font-weight: bold;">true</span> <span style="color: #c4746e; font-weight: bold;">and</span> <span style="color: #b6927b; font-weight: bold;">false</span><span style="color: #9e9b93;">,</span>
</span><span class="athl-line" data-athl-line="34">    <span style="color: #b6927b; font-weight: bold;">true</span> <span style="color: #c4746e; font-weight: bold;">or</span> <span style="color: #b6927b; font-weight: bold;">false</span><span style="color: #9e9b93;">,</span>
</span><span class="athl-line" data-athl-line="35">    <span style="color: #c4746e;">!</span><span style="color: #b6927b; font-weight: bold;">true</span><span style="color: #9e9b93;">,</span>
</span><span class="athl-line" data-athl-line="36"><span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="37">
</span><span class="athl-line" data-athl-line="38"><span style="color: #737c73;">// Integers.</span>
</span><span class="athl-line" data-athl-line="39"><span style="color: #8992a7;">const</span> <span style="color: #c5c9c5;">one_plus_one</span><span style="color: #9e9b93;">:</span> <span style="color: #949fb5;">i32</span> <span style="color: #c4746e;">=</span> <span style="color: #a292a3;">1</span> <span style="color: #c4746e;">+</span> <span style="color: #a292a3;">1</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="40"><span style="color: #8ba4b0;">print</span><span style="color: #9e9b93;">(</span><span style="color: #8a9a7b;">&quot;1 + 1 = {}<span style="color: #c4746e; font-weight: bold;">\n</span>&quot;</span><span style="color: #9e9b93;">,</span> <span style="color: #9e9b93;">.</span><span style="color: #9e9b93;">{</span><span style="color: #c5c9c5;">one_plus_one</span><span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">;</span> <span style="color: #737c73;">// 2</span>
</span><span class="athl-line" data-athl-line="41">
</span><span class="athl-line" data-athl-line="42"><span style="color: #737c73;">// Floats.</span>
</span><span class="athl-line" data-athl-line="43"><span style="color: #8992a7;">const</span> <span style="color: #c5c9c5;">seven_div_three</span><span style="color: #9e9b93;">:</span> <span style="color: #949fb5;">f32</span> <span style="color: #c4746e;">=</span> <span style="color: #a292a3;">7.0</span> <span style="color: #c4746e;">/</span> <span style="color: #a292a3;">3.0</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="44"><span style="color: #8ba4b0;">print</span><span style="color: #9e9b93;">(</span><span style="color: #8a9a7b;">&quot;7.0 / 3.0 = {}<span style="color: #c4746e; font-weight: bold;">\n</span>&quot;</span><span style="color: #9e9b93;">,</span> <span style="color: #9e9b93;">.</span><span style="color: #9e9b93;">{</span><span style="color: #c5c9c5;">seven_div_three</span><span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">;</span> <span style="color: #737c73;">// 2.33333325e+00</span>
</span><span class="athl-line" data-athl-line="45">
</span><span class="athl-line" data-athl-line="46"><span style="color: #737c73;">// Integers have arbitrary value lengths.</span>
</span><span class="athl-line" data-athl-line="47"><span style="color: #8992a7;">var</span> <span style="color: #c5c9c5;">myvar</span><span style="color: #9e9b93;">:</span> <span style="color: #949fb5;">u10</span> <span style="color: #c4746e;">=</span> <span style="color: #a292a3;">5</span><span style="color: #9e9b93;">;</span> <span style="color: #737c73;">// 10-bit unsigned integer</span>
</span><span class="athl-line" data-athl-line="48"><span style="color: #737c73;">// Useful for example to read network packets, or complex binary formats.</span>
</span><span class="athl-line" data-athl-line="49">
</span><span class="athl-line" data-athl-line="50"><span style="color: #737c73;">// Number representation is greatly improved compared to C.</span>
</span><span class="athl-line" data-athl-line="51"><span style="color: #8992a7;">const</span> <span style="color: #c5c9c5;">one_billion</span> <span style="color: #c4746e;">=</span> <span style="color: #a292a3;">1_000_000_000</span><span style="color: #9e9b93;">;</span>         <span style="color: #737c73;">// Decimal.</span>
</span><span class="athl-line" data-athl-line="52"><span style="color: #8992a7;">const</span> <span style="color: #c5c9c5;">binary_mask</span> <span style="color: #c4746e;">=</span> <span style="color: #a292a3;">0b1_1111_1111</span><span style="color: #9e9b93;">;</span>         <span style="color: #737c73;">// Binary. Ex: network mask.</span>
</span><span class="athl-line" data-athl-line="53"><span style="color: #8992a7;">const</span> <span style="color: #c5c9c5;">permissions</span> <span style="color: #c4746e;">=</span> <span style="color: #a292a3;">0o7_5_5</span><span style="color: #9e9b93;">;</span>               <span style="color: #737c73;">// Octal.  Ex: Unix permissions.</span>
</span><span class="athl-line" data-athl-line="54"><span style="color: #8992a7;">const</span> <span style="color: #c5c9c5;">big_address</span> <span style="color: #c4746e;">=</span> <span style="color: #a292a3;">0xFF80_0000_0000_0000</span><span style="color: #9e9b93;">;</span> <span style="color: #737c73;">// Hexa.   Ex: IPv6 address.</span>
</span><span class="athl-line" data-athl-line="55">
</span><span class="athl-line" data-athl-line="56">
</span><span class="athl-line" data-athl-line="57"><span style="color: #737c73;">// Overflow operators: tell the compiler when it&#39;s okay to overflow.</span>
</span><span class="athl-line" data-athl-line="58"><span style="color: #8992a7;">var</span> <span style="color: #c5c9c5;">i</span><span style="color: #9e9b93;">:</span> <span style="color: #949fb5;">u8</span> <span style="color: #c4746e;">=</span> <span style="color: #a292a3;">0</span><span style="color: #9e9b93;">;</span>  <span style="color: #737c73;">// &quot;i&quot; is an unsigned 8-bit integer</span>
</span><span class="athl-line" data-athl-line="59"><span style="color: #c5c9c5;">i</span>  <span style="color: #c4746e;">-=</span> <span style="color: #a292a3;">1</span><span style="color: #9e9b93;">;</span>        <span style="color: #737c73;">// runtime overflow error (unsigned value always are positive)</span>
</span><span class="athl-line" data-athl-line="60"><span style="color: #c5c9c5;">i</span> <span style="color: #c4746e;">-%=</span> <span style="color: #a292a3;">1</span><span style="color: #9e9b93;">;</span>        <span style="color: #737c73;">// okay (wrapping operator), i == 255</span>
</span><span class="athl-line" data-athl-line="61">
</span><span class="athl-line" data-athl-line="62"><span style="color: #737c73;">// Saturation operators: values will stick to their lower and upper bounds.</span>
</span><span class="athl-line" data-athl-line="63"><span style="color: #8992a7;">var</span> <span style="color: #c5c9c5;">i</span><span style="color: #9e9b93;">:</span> <span style="color: #949fb5;">u8</span> <span style="color: #c4746e;">=</span> <span style="color: #a292a3;">200</span><span style="color: #9e9b93;">;</span>   <span style="color: #737c73;">// &quot;i&quot; is an unsigned 8-bit integer (values: from 0 to 255)</span>
</span><span class="athl-line" data-athl-line="64"><span style="color: #c5c9c5;">i</span>  <span style="color: #c4746e;">+|</span> <span style="color: #a292a3;">100</span> <span style="color: #c4746e;">==</span> <span style="color: #a292a3;">255</span>   <span style="color: #737c73;">// u8: won&#39;t go higher than 255</span>
</span><span class="athl-line" data-athl-line="65">i  <span style="color: #c4746e;">-|</span> <span style="color: #a292a3;">300</span> <span style="color: #c4746e;">==</span> <span style="color: #a292a3;">0</span>     <span style="color: #737c73;">// unsigned, won&#39;t go lower than 0</span>
</span><span class="athl-line" data-athl-line="66">i  <span style="color: #c4746e;">*|</span> <span style="color: #a292a3;">2</span>   <span style="color: #c4746e;">==</span> <span style="color: #a292a3;">255</span>   <span style="color: #737c73;">// u8: won&#39;t go higher than 255</span>
</span><span class="athl-line" data-athl-line="67">i <span style="color: #c4746e;">&lt;&lt;|</span> <span style="color: #a292a3;">8</span>   <span style="color: #c4746e;">==</span> <span style="color: #a292a3;">255</span>   <span style="color: #737c73;">// u8: won&#39;t go higher than 255</span>
</span><span class="athl-line" data-athl-line="68">```
</span><span class="athl-line" data-athl-line="69">
</span><span class="athl-line" data-athl-line="70">### Arrays<span style="color: #9e9b93;">.</span>
</span><span class="athl-line" data-athl-line="71">
</span><span class="athl-line" data-athl-line="72">```<span style="color: #c4b28a;">zig</span>
</span><span class="athl-line" data-athl-line="73"><span style="color: #737c73;">// An array is a well-defined structure with a length attribute (len).</span>
</span><span class="athl-line" data-athl-line="74">
</span><span class="athl-line" data-athl-line="75"><span style="color: #737c73;">// 5-byte array with undefined content (stack garbage).</span>
</span><span class="athl-line" data-athl-line="76">var array1<span style="color: #9e9b93;">:</span> <span style="color: #9e9b93;">[</span><span style="color: #a292a3;">5</span><span style="color: #9e9b93;">]</span>u8 <span style="color: #c4746e;">=</span> <span style="color: #949fb5;">undefined</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="77">
</span><span class="athl-line" data-athl-line="78"><span style="color: #737c73;">// 5-byte array with defined content.</span>
</span><span class="athl-line" data-athl-line="79"><span style="color: #8992a7;">var</span> array2 <span style="color: #c4746e;">=</span> <span style="color: #9e9b93;">[</span><span style="color: #c4746e;">_</span><span style="color: #9e9b93;">]</span><span style="color: #949fb5;">u8</span><span style="color: #9e9b93;">{</span> <span style="color: #a292a3;">1</span><span style="color: #9e9b93;">,</span> <span style="color: #a292a3;">2</span><span style="color: #9e9b93;">,</span> <span style="color: #a292a3;">3</span><span style="color: #9e9b93;">,</span> <span style="color: #a292a3;">4</span><span style="color: #9e9b93;">,</span> <span style="color: #a292a3;">5</span> <span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="80"><span style="color: #737c73;">// [_] means the compiler knows the length at compile-time.</span>
</span><span class="athl-line" data-athl-line="81">
</span><span class="athl-line" data-athl-line="82"><span style="color: #737c73;">// 1000-byte array with defined content (0).</span>
</span><span class="athl-line" data-athl-line="83"><span style="color: #8992a7;">var</span> array3 <span style="color: #c4746e;">=</span> <span style="color: #9e9b93;">[</span><span style="color: #c4746e;">_</span><span style="color: #9e9b93;">]</span><span style="color: #949fb5;">u8</span><span style="color: #9e9b93;">{</span><span style="color: #a292a3;">0</span><span style="color: #9e9b93;">}</span> <span style="color: #c4746e;">**</span> <span style="color: #a292a3;">1000</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="84">
</span><span class="athl-line" data-athl-line="85"><span style="color: #737c73;">// Another 1000-byte array with defined content.</span>
</span><span class="athl-line" data-athl-line="86"><span style="color: #737c73;">// The content is provided by the &quot;foo&quot; function, called at compile-time and</span>
</span><span class="athl-line" data-athl-line="87"><span style="color: #737c73;">// allows complex initializations.</span>
</span><span class="athl-line" data-athl-line="88"><span style="color: #8992a7;">var</span> array4 <span style="color: #c4746e;">=</span> <span style="color: #9e9b93;">[</span><span style="color: #c4746e;">_</span><span style="color: #9e9b93;">]</span><span style="color: #949fb5;">u8</span><span style="color: #9e9b93;">{</span><span style="color: #8ba4b0;">foo</span><span style="color: #9e9b93;">(</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">}</span> <span style="color: #c4746e;">**</span> <span style="color: #a292a3;">1000</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="89">
</span><span class="athl-line" data-athl-line="90"><span style="color: #737c73;">// In any case, array.len gives the length of the array,</span>
</span><span class="athl-line" data-athl-line="91"><span style="color: #737c73;">// array1.len and array2.len produce 5, array3.len and array4.len produce 1000.</span>
</span><span class="athl-line" data-athl-line="92">
</span><span class="athl-line" data-athl-line="93">
</span><span class="athl-line" data-athl-line="94"><span style="color: #737c73;">// Modifying and accessing arrays content.</span>
</span><span class="athl-line" data-athl-line="95">
</span><span class="athl-line" data-athl-line="96"><span style="color: #737c73;">// Array of 10 32-bit undefined integers.</span>
</span><span class="athl-line" data-athl-line="97"><span style="color: #8992a7;">var</span> some_integers<span style="color: #9e9b93;">:</span> <span style="color: #9e9b93;">[</span><span style="color: #a292a3;">10</span><span style="color: #9e9b93;">]</span>i32 <span style="color: #c4746e;">=</span> <span style="color: #949fb5;">undefined</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="98">
</span><span class="athl-line" data-athl-line="99">some_integers<span style="color: #9e9b93;">[</span><span style="color: #a292a3;">0</span><span style="color: #9e9b93;">]</span> <span style="color: #c4746e;">=</span> <span style="color: #a292a3;">30</span><span style="color: #9e9b93;">;</span> <span style="color: #737c73;">// first element of the array is now 30</span>
</span><span class="athl-line" data-athl-line="100">
</span><span class="athl-line" data-athl-line="101"><span style="color: #8992a7;">var</span> x <span style="color: #c4746e;">=</span> <span style="color: #c5c9c5;">some_integers</span><span style="color: #9e9b93;">[</span><span style="color: #a292a3;">0</span><span style="color: #9e9b93;">]</span><span style="color: #9e9b93;">;</span> <span style="color: #737c73;">// &quot;x&quot; now equals to 30, its type is inferred.</span>
</span><span class="athl-line" data-athl-line="102"><span style="color: #8992a7;">var</span> y <span style="color: #c4746e;">=</span> <span style="color: #c5c9c5;">some_integers</span><span style="color: #9e9b93;">[</span><span style="color: #a292a3;">1</span><span style="color: #9e9b93;">]</span><span style="color: #9e9b93;">;</span> <span style="color: #737c73;">// Second element of the array isn&#39;t defined.</span>
</span><span class="athl-line" data-athl-line="103">                          <span style="color: #737c73;">// &quot;y&quot; got a stack garbage value (no runtime error).</span>
</span><span class="athl-line" data-athl-line="104">
</span><span class="athl-line" data-athl-line="105"><span style="color: #737c73;">// Array of 10 32-bit undefined integers.</span>
</span><span class="athl-line" data-athl-line="106"><span style="color: #8992a7;">var</span> some_integers<span style="color: #9e9b93;">:</span> <span style="color: #9e9b93;">[</span><span style="color: #a292a3;">10</span><span style="color: #9e9b93;">]</span>i32 <span style="color: #c4746e;">=</span> <span style="color: #949fb5;">undefined</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="107">
</span><span class="athl-line" data-athl-line="108"><span style="color: #8992a7;">var</span> z <span style="color: #c4746e;">=</span> <span style="color: #c5c9c5;">some_integers</span><span style="color: #9e9b93;">[</span><span style="color: #a292a3;">20</span><span style="color: #9e9b93;">]</span><span style="color: #9e9b93;">;</span> <span style="color: #737c73;">// index &gt; array size, compilation error.</span>
</span><span class="athl-line" data-athl-line="109">
</span><span class="athl-line" data-athl-line="110"><span style="color: #737c73;">// At runtime, we loop over the elements of &quot;some_integers&quot; with an index.</span>
</span><span class="athl-line" data-athl-line="111"><span style="color: #737c73;">// Index i = 20, then we try:</span>
</span><span class="athl-line" data-athl-line="112"><span style="color: #c4746e; font-weight: bold;">try</span> <span style="color: #c5c9c5;">some_integers</span><span style="color: #9e9b93;">[</span><span style="color: #c5c9c5;">i</span><span style="color: #9e9b93;">]</span><span style="color: #9e9b93;">;</span> <span style="color: #737c73;">// Runtime error &#39;index out of bounds&#39;.</span>
</span><span class="athl-line" data-athl-line="113">                      <span style="color: #737c73;">// &quot;try&quot; keyword is necessary when accessing an array with</span>
</span><span class="athl-line" data-athl-line="114">                      <span style="color: #737c73;">// an index, since there is a potential runtime error.</span>
</span><span class="athl-line" data-athl-line="115">                      <span style="color: #737c73;">// More on that later.</span>
</span><span class="athl-line" data-athl-line="116">```
</span><span class="athl-line" data-athl-line="117">
</span><span class="athl-line" data-athl-line="118">### <span style="color: #8ea4a2;">Multidimensional</span> <span style="color: #c5c9c5;">arrays</span><span style="color: #9e9b93;">.</span>
</span><span class="athl-line" data-athl-line="119">
</span><span class="athl-line" data-athl-line="120">```<span style="color: #c4b28a;">zig</span>
</span><span class="athl-line" data-athl-line="121">const <span style="color: #c5c9c5;">mat4x4</span> <span style="color: #c4746e;">=</span> <span style="color: #9e9b93;">[</span><span style="color: #a292a3;">4</span><span style="color: #9e9b93;">]</span><span style="color: #9e9b93;">[</span><span style="color: #a292a3;">4</span><span style="color: #9e9b93;">]</span><span style="color: #949fb5;">f32</span><span style="color: #9e9b93;">{</span>
</span><span class="athl-line" data-athl-line="122">    <span style="color: #9e9b93;">[</span><span style="color: #c4746e;">_</span><span style="color: #9e9b93;">]</span><span style="color: #949fb5;">f32</span><span style="color: #9e9b93;">{</span> <span style="color: #a292a3;">1.0</span><span style="color: #9e9b93;">,</span> <span style="color: #a292a3;">0.0</span><span style="color: #9e9b93;">,</span> <span style="color: #a292a3;">0.0</span><span style="color: #9e9b93;">,</span> <span style="color: #a292a3;">0.0</span> <span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">,</span>
</span><span class="athl-line" data-athl-line="123">    <span style="color: #9e9b93;">[</span><span style="color: #c4746e;">_</span><span style="color: #9e9b93;">]</span><span style="color: #949fb5;">f32</span><span style="color: #9e9b93;">{</span> <span style="color: #a292a3;">0.0</span><span style="color: #9e9b93;">,</span> <span style="color: #a292a3;">1.0</span><span style="color: #9e9b93;">,</span> <span style="color: #a292a3;">0.0</span><span style="color: #9e9b93;">,</span> <span style="color: #a292a3;">1.0</span> <span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">,</span>
</span><span class="athl-line" data-athl-line="124">    <span style="color: #9e9b93;">[</span><span style="color: #c4746e;">_</span><span style="color: #9e9b93;">]</span><span style="color: #949fb5;">f32</span><span style="color: #9e9b93;">{</span> <span style="color: #a292a3;">0.0</span><span style="color: #9e9b93;">,</span> <span style="color: #a292a3;">0.0</span><span style="color: #9e9b93;">,</span> <span style="color: #a292a3;">1.0</span><span style="color: #9e9b93;">,</span> <span style="color: #a292a3;">0.0</span> <span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">,</span>
</span><span class="athl-line" data-athl-line="125">    <span style="color: #9e9b93;">[</span><span style="color: #c4746e;">_</span><span style="color: #9e9b93;">]</span><span style="color: #949fb5;">f32</span><span style="color: #9e9b93;">{</span> <span style="color: #a292a3;">0.0</span><span style="color: #9e9b93;">,</span> <span style="color: #a292a3;">0.0</span><span style="color: #9e9b93;">,</span> <span style="color: #a292a3;">0.0</span><span style="color: #9e9b93;">,</span> <span style="color: #a292a3;">1.0</span> <span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">,</span>
</span><span class="athl-line" data-athl-line="126"><span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="127">
</span><span class="athl-line" data-athl-line="128"><span style="color: #737c73;">// Access the 2D array then the inner array through indexes.</span>
</span><span class="athl-line" data-athl-line="129"><span style="color: #c4746e; font-weight: bold;">try</span> <span style="color: #8ba4b0;">expect</span><span style="color: #9e9b93;">(</span><span style="color: #c5c9c5;">mat4x4</span><span style="color: #9e9b93;">[</span><span style="color: #a292a3;">1</span><span style="color: #9e9b93;">]</span><span style="color: #9e9b93;">[</span><span style="color: #a292a3;">1</span><span style="color: #9e9b93;">]</span> <span style="color: #c4746e;">==</span> <span style="color: #a292a3;">1.0</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="130">
</span><span class="athl-line" data-athl-line="131"><span style="color: #737c73;">// Here we iterate with for loops.</span>
</span><span class="athl-line" data-athl-line="132"><span style="color: #8992a7;">for</span> <span style="color: #9e9b93;">(</span><span style="color: #c5c9c5;">mat4x4</span><span style="color: #9e9b93;">)</span> <span style="color: #9e9b93;">|</span><span style="color: #a6a69c;">row</span><span style="color: #9e9b93;">,</span> <span style="color: #a6a69c;">row_index</span><span style="color: #9e9b93;">|</span> <span style="color: #9e9b93;">{</span>
</span><span class="athl-line" data-athl-line="133">    <span style="color: #8992a7;">for</span> <span style="color: #9e9b93;">(</span><span style="color: #c5c9c5;">row</span><span style="color: #9e9b93;">)</span> <span style="color: #9e9b93;">|</span><span style="color: #a6a69c;">cell</span><span style="color: #9e9b93;">,</span> <span style="color: #a6a69c;">column_index</span><span style="color: #9e9b93;">|</span> <span style="color: #9e9b93;">{</span>
</span><span class="athl-line" data-athl-line="134">        <span style="color: #737c73;">// ...</span>
</span><span class="athl-line" data-athl-line="135">    <span style="color: #9e9b93;">}</span>
</span><span class="athl-line" data-athl-line="136"><span style="color: #9e9b93;">}</span>
</span><span class="athl-line" data-athl-line="137">```
</span><span class="athl-line" data-athl-line="138">
</span><span class="athl-line" data-athl-line="139">### Strings<span style="color: #9e9b93;">.</span>
</span><span class="athl-line" data-athl-line="140">
</span><span class="athl-line" data-athl-line="141">```<span style="color: #c4b28a;">zig</span>
</span><span class="athl-line" data-athl-line="142"><span style="color: #737c73;">// Simple string constant.</span><span style="color: #9e9b93;"></span>
</span><span class="athl-line" data-athl-line="143"><span style="color: #8992a7;">const</span> <span style="color: #c5c9c5;">greetings</span> <span style="color: #c4746e;">=</span> <span style="color: #8a9a7b;">&quot;hello&quot;</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="144"><span style="color: #737c73;">// ... which is equivalent to:</span>
</span><span class="athl-line" data-athl-line="145"><span style="color: #8992a7;">const</span> <span style="color: #c5c9c5;">greetings</span><span style="color: #9e9b93;">:</span> <span style="color: #c4746e;">*</span><span style="color: #8992a7;">const</span> <span style="color: #9e9b93;">[</span><span style="color: #a292a3;">5</span><span style="color: #9e9b93;">:</span><span style="color: #a292a3;">0</span><span style="color: #9e9b93;">]</span><span style="color: #949fb5;">u8</span> <span style="color: #c4746e;">=</span> <span style="color: #8a9a7b;">&quot;hello&quot;</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="146"><span style="color: #737c73;">// In words: &quot;greetings&quot; is a constant value, a pointer on a constant array of 5</span>
</span><span class="athl-line" data-athl-line="147"><span style="color: #737c73;">// elements (8-bit unsigned integers), with an extra &#39;0&#39; at the end.</span>
</span><span class="athl-line" data-athl-line="148"><span style="color: #737c73;">// The extra &quot;0&quot; is called a &quot;sentinel value&quot;.</span>
</span><span class="athl-line" data-athl-line="149">
</span><span class="athl-line" data-athl-line="150"><span style="color: #8ba4b0;">print</span><span style="color: #9e9b93;">(</span><span style="color: #8a9a7b;">&quot;string: {s}<span style="color: #c4746e; font-weight: bold;">\n</span>&quot;</span><span style="color: #9e9b93;">,</span> <span style="color: #9e9b93;">.</span><span style="color: #9e9b93;">{</span><span style="color: #c5c9c5;">greetings</span><span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="151">
</span><span class="athl-line" data-athl-line="152"><span style="color: #737c73;">// This represents rather faithfully C strings. Although, Zig strings are</span>
</span><span class="athl-line" data-athl-line="153"><span style="color: #737c73;">// structures, no need for &quot;strlen&quot; to compute their size.</span>
</span><span class="athl-line" data-athl-line="154"><span style="color: #737c73;">// greetings.len == 5</span>
</span><span class="athl-line" data-athl-line="155">```
</span><span class="athl-line" data-athl-line="156">
</span><span class="athl-line" data-athl-line="157">### <span style="color: #8ea4a2;">Slices</span><span style="color: #9e9b93;">.</span>
</span><span class="athl-line" data-athl-line="158">
</span><span class="athl-line" data-athl-line="159">```<span style="color: #c4b28a;">zig</span>
</span><span class="athl-line" data-athl-line="160"><span style="color: #737c73;">// A slice is a pointer and a size, an array without compile-time known size.</span>
</span><span class="athl-line" data-athl-line="161"><span style="color: #737c73;">// Slices have runtime out-of-band verifications.</span>
</span><span class="athl-line" data-athl-line="162">
</span><span class="athl-line" data-athl-line="163">const <span style="color: #c4b28a;">array</span> <span style="color: #c4746e;">=</span> <span style="color: #9e9b93;">[</span><span style="color: #c4746e;">_</span><span style="color: #9e9b93;">]</span><span style="color: #949fb5;">u8</span><span style="color: #9e9b93;">{</span><span style="color: #a292a3;">1</span><span style="color: #9e9b93;">,</span><span style="color: #a292a3;">2</span><span style="color: #9e9b93;">,</span><span style="color: #a292a3;">3</span><span style="color: #9e9b93;">,</span><span style="color: #a292a3;">4</span><span style="color: #9e9b93;">,</span><span style="color: #a292a3;">5</span><span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">;</span>     <span style="color: #737c73;">// [_] = array with compile-time known size.</span>
</span><span class="athl-line" data-athl-line="164"><span style="color: #8992a7;">const</span> <span style="color: #c5c9c5;">slice</span> <span style="color: #c4746e;">=</span> <span style="color: #c5c9c5;">array</span><span style="color: #9e9b93;">[</span><span style="color: #a292a3;">0</span><span style="color: #c4746e;">..</span><span style="color: #c5c9c5;">array</span><span style="color: #9e9b93;">.</span><span style="color: #c4b28a;">len</span><span style="color: #9e9b93;">]</span><span style="color: #9e9b93;">;</span>  <span style="color: #737c73;">// &quot;slice&quot; represents the whole array.</span>
</span><span class="athl-line" data-athl-line="165">                                    <span style="color: #737c73;">// slice[10] gives a runtime error.</span>
</span><span class="athl-line" data-athl-line="166">```
</span><span class="athl-line" data-athl-line="167">
</span><span class="athl-line" data-athl-line="168">### <span style="color: #8ea4a2;">Pointers</span><span style="color: #9e9b93;">.</span>
</span><span class="athl-line" data-athl-line="169">
</span><span class="athl-line" data-athl-line="170">```<span style="color: #c4b28a;">zig</span>
</span><span class="athl-line" data-athl-line="171"><span style="color: #737c73;">// Pointer on a value can be created with &quot;&amp;&quot;.</span>
</span><span class="athl-line" data-athl-line="172">const <span style="color: #c4b28a;">x</span><span style="color: #9e9b93;">:</span> <span style="color: #949fb5;">i32</span> <span style="color: #c4746e;">=</span> <span style="color: #a292a3;">1</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="173"><span style="color: #8992a7;">const</span> <span style="color: #c5c9c5;">pointer</span><span style="color: #9e9b93;">:</span> <span style="color: #c4746e;">*</span><span style="color: #949fb5;">i32</span> <span style="color: #c4746e;">=</span> <span style="color: #c4746e;">&amp;</span><span style="color: #c5c9c5;">x</span><span style="color: #9e9b93;">;</span>  <span style="color: #737c73;">// &quot;pointer&quot; is a pointer on the i32 var &quot;x&quot;.</span>
</span><span class="athl-line" data-athl-line="174"><span style="color: #8ba4b0;">print</span><span style="color: #9e9b93;">(</span><span style="color: #8a9a7b;">&quot;1 = {}, {}<span style="color: #c4746e; font-weight: bold;">\n</span>&quot;</span><span style="color: #9e9b93;">,</span> <span style="color: #9e9b93;">.</span><span style="color: #9e9b93;">{</span><span style="color: #c5c9c5;">x</span><span style="color: #9e9b93;">,</span> <span style="color: #c5c9c5;">pointer</span><span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="175">
</span><span class="athl-line" data-athl-line="176"><span style="color: #737c73;">// Pointer values are accessed and modified with &quot;.*&quot;.</span>
</span><span class="athl-line" data-athl-line="177"><span style="color: #8992a7;">if</span> <span style="color: #9e9b93;">(</span><span style="color: #c5c9c5;">pointer</span><span style="color: #c4746e;">.*</span> <span style="color: #c4746e;">==</span> <span style="color: #a292a3;">1</span><span style="color: #9e9b93;">)</span> <span style="color: #9e9b93;">{</span>
</span><span class="athl-line" data-athl-line="178">    <span style="color: #8ba4b0;">print</span><span style="color: #9e9b93;">(</span><span style="color: #8a9a7b;">&quot;x value == {}<span style="color: #c4746e; font-weight: bold;">\n</span>&quot;</span><span style="color: #9e9b93;">,</span> <span style="color: #9e9b93;">.</span><span style="color: #9e9b93;">{</span><span style="color: #c5c9c5;">pointer</span><span style="color: #c4746e;">.*</span><span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="179"><span style="color: #9e9b93;">}</span>
</span><span class="athl-line" data-athl-line="180">
</span><span class="athl-line" data-athl-line="181"><span style="color: #737c73;">// &quot;.?&quot; is a shortcut for &quot;orelse unreachable&quot;.</span>
</span><span class="athl-line" data-athl-line="182"><span style="color: #8992a7;">const</span> <span style="color: #c5c9c5;">foo</span> <span style="color: #c4746e;">=</span> <span style="color: #c5c9c5;">pointer</span><span style="color: #c4746e;">.?</span><span style="color: #9e9b93;">;</span> <span style="color: #737c73;">// Get the pointed value, otherwise crash.</span>
</span><span class="athl-line" data-athl-line="183">```
</span><span class="athl-line" data-athl-line="184">
</span><span class="athl-line" data-athl-line="185">### <span style="color: #8ba4b0;">Optional</span> values <span style="color: #9e9b93;">(</span><span style="color: #c4746e;">?</span><span style="color: #c4746e; font-weight: bold;">\&lt;</span><span style="color: #949fb5;">type</span><span style="color: #c4746e; font-weight: bold;">\&gt;</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">.</span>
</span><span class="athl-line" data-athl-line="186">
</span><span class="athl-line" data-athl-line="187">```<span style="color: #c4b28a;">zig</span>
</span><span class="athl-line" data-athl-line="188"><span style="color: #737c73;">// An optional is a value than can be of any type or null.</span>
</span><span class="athl-line" data-athl-line="189">
</span><span class="athl-line" data-athl-line="190"><span style="color: #737c73;">// Example: &quot;optional_value&quot; can either be &quot;null&quot; or an unsigned 32-bit integer.</span><span style="color: #9e9b93;"></span>
</span><span class="athl-line" data-athl-line="191"><span style="color: #8992a7;">var</span> <span style="color: #c5c9c5;">optional_value</span><span style="color: #9e9b93;">:</span> <span style="color: #c4746e;">?</span><span style="color: #949fb5;">u32</span> <span style="color: #c4746e;">=</span> <span style="color: #949fb5;">null</span><span style="color: #9e9b93;">;</span> <span style="color: #737c73;">// optional_value == null</span>
</span><span class="athl-line" data-athl-line="192"><span style="color: #c4b28a;">optional_value</span> <span style="color: #c4746e;">=</span> <span style="color: #a292a3;">42</span><span style="color: #9e9b93;">;</span>             <span style="color: #737c73;">// optional_value != null</span>
</span><span class="athl-line" data-athl-line="193">
</span><span class="athl-line" data-athl-line="194"><span style="color: #737c73;">// &quot;some_function&quot; returns ?u32</span>
</span><span class="athl-line" data-athl-line="195"><span style="color: #8992a7;">var</span> <span style="color: #c5c9c5;">x</span> <span style="color: #c4746e;">=</span> <span style="color: #8ba4b0;">some_function</span><span style="color: #9e9b93;">(</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="196"><span style="color: #8992a7;">if</span> <span style="color: #9e9b93;">(</span><span style="color: #c5c9c5;">x</span><span style="color: #9e9b93;">)</span> <span style="color: #9e9b93;">|</span><span style="color: #a6a69c;">value</span><span style="color: #9e9b93;">|</span> <span style="color: #9e9b93;">{</span>
</span><span class="athl-line" data-athl-line="197">    <span style="color: #737c73;">// In case &quot;some_function&quot; returned a value.</span>
</span><span class="athl-line" data-athl-line="198">    <span style="color: #737c73;">// Do something with &#39;value&#39;.</span>
</span><span class="athl-line" data-athl-line="199"><span style="color: #9e9b93;">}</span>
</span><span class="athl-line" data-athl-line="200">```
</span><span class="athl-line" data-athl-line="201">
</span><span class="athl-line" data-athl-line="202">### Errors<span style="color: #9e9b93;">.</span>
</span><span class="athl-line" data-athl-line="203">
</span><span class="athl-line" data-athl-line="204">```<span style="color: #c4b28a;">zig</span>
</span><span class="athl-line" data-athl-line="205"><span style="color: #737c73;">// Zig provides an unified way to express errors.</span>
</span><span class="athl-line" data-athl-line="206">
</span><span class="athl-line" data-athl-line="207"><span style="color: #737c73;">// Errors are defined in error enumerations, example:</span><span style="color: #9e9b93;"></span>
</span><span class="athl-line" data-athl-line="208"><span style="color: #8992a7;">const</span> <span style="color: #8ea4a2;">Error</span> <span style="color: #c4746e;">=</span> <span style="color: #8992a7;">error</span> <span style="color: #9e9b93;">{</span>
</span><span class="athl-line" data-athl-line="209">    <span style="color: #8ea4a2;">WatchingAnyNetflixTVShow</span><span style="color: #9e9b93;">,</span>
</span><span class="athl-line" data-athl-line="210">    <span style="color: #8ea4a2;">BeOnTwitter</span><span style="color: #9e9b93;">,</span>
</span><span class="athl-line" data-athl-line="211"><span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="212">
</span><span class="athl-line" data-athl-line="213"><span style="color: #737c73;">// Normal enumerations are expressed the same way, but with &quot;enum&quot; keyword.</span>
</span><span class="athl-line" data-athl-line="214"><span style="color: #8992a7;">const</span> <span style="color: #8ea4a2;">SuccessStory</span> <span style="color: #c4746e;">=</span> <span style="color: #8992a7;">enum</span> <span style="color: #9e9b93;">{</span>
</span><span class="athl-line" data-athl-line="215">    <span style="color: #c4b28a;">DoingSport</span><span style="color: #9e9b93;">,</span>
</span><span class="athl-line" data-athl-line="216">    <span style="color: #c4b28a;">ReadABook</span><span style="color: #9e9b93;">,</span>
</span><span class="athl-line" data-athl-line="217"><span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="218">
</span><span class="athl-line" data-athl-line="219">
</span><span class="athl-line" data-athl-line="220"><span style="color: #737c73;">// Error union (!).</span>
</span><span class="athl-line" data-athl-line="221"><span style="color: #737c73;">// Either the value &quot;mylife&quot; is an an error or a normal value.</span>
</span><span class="athl-line" data-athl-line="222"><span style="color: #8992a7;">var</span> <span style="color: #c5c9c5;">mylife</span><span style="color: #9e9b93;">:</span> <span style="color: #8ea4a2;">Error</span><span style="color: #c4746e;">!</span><span style="color: #8ea4a2;">SuccessStory</span> <span style="color: #c4746e;">=</span> <span style="color: #8ea4a2;">Error</span><span style="color: #9e9b93;">.</span><span style="color: #c4b28a;">BeOnTwitter</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="223"><span style="color: #737c73;">// mylife is an error. Sad.</span>
</span><span class="athl-line" data-athl-line="224">
</span><span class="athl-line" data-athl-line="225"><span style="color: #c4b28a;">mylife</span> <span style="color: #c4746e;">=</span> <span style="color: #8ea4a2;">SuccessStory</span><span style="color: #9e9b93;">.</span><span style="color: #c4b28a;">ReadABook</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="226"><span style="color: #737c73;">// Now mylife is an enum.</span>
</span><span class="athl-line" data-athl-line="227">
</span><span class="athl-line" data-athl-line="228">
</span><span class="athl-line" data-athl-line="229"><span style="color: #737c73;">// Zig ships with many pre-defined errors. Example:</span>
</span><span class="athl-line" data-athl-line="230"><span style="color: #8992a7;">const</span> <span style="color: #c5c9c5;">value</span><span style="color: #9e9b93;">:</span> <span style="color: #949fb5;">anyerror</span><span style="color: #c4746e;">!</span><span style="color: #949fb5;">u32</span> <span style="color: #c4746e;">=</span> <span style="color: #8992a7;">error</span><span style="color: #9e9b93;">.</span><span style="color: #8ea4a2;">Broken</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="231">
</span><span class="athl-line" data-athl-line="232">
</span><span class="athl-line" data-athl-line="233"><span style="color: #737c73;">// Handling errors.</span>
</span><span class="athl-line" data-athl-line="234">
</span><span class="athl-line" data-athl-line="235"><span style="color: #737c73;">// Some error examples.</span>
</span><span class="athl-line" data-athl-line="236"><span style="color: #8992a7;">const</span> <span style="color: #8ea4a2;">Error</span> <span style="color: #c4746e;">=</span> <span style="color: #8992a7;">error</span> <span style="color: #9e9b93;">{</span>
</span><span class="athl-line" data-athl-line="237">    <span style="color: #8ea4a2;">UnExpected</span><span style="color: #9e9b93;">,</span>
</span><span class="athl-line" data-athl-line="238">    <span style="color: #8ea4a2;">Authentication</span><span style="color: #9e9b93;">,</span>
</span><span class="athl-line" data-athl-line="239"><span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="240">
</span><span class="athl-line" data-athl-line="241"><span style="color: #737c73;">// &quot;some_function&quot; can either return an &quot;Error&quot; or an integer.</span>
</span><span class="athl-line" data-athl-line="242"><span style="color: #8992a7;">fn</span> <span style="color: #8ba4b0;">some_function</span><span style="color: #9e9b93;">(</span><span style="color: #9e9b93;">)</span> <span style="color: #8ea4a2;">Error</span><span style="color: #c4746e;">!</span><span style="color: #949fb5;">u8</span> <span style="color: #9e9b93;">{</span>
</span><span class="athl-line" data-athl-line="243">    <span style="color: #c4746e;">return</span> <span style="color: #8ea4a2;">Error</span><span style="color: #9e9b93;">.</span><span style="color: #c4b28a;">UnExpected</span><span style="color: #9e9b93;">;</span> <span style="color: #737c73;">// It returns an error.</span>
</span><span class="athl-line" data-athl-line="244"><span style="color: #9e9b93;">}</span>
</span><span class="athl-line" data-athl-line="245">
</span><span class="athl-line" data-athl-line="246"><span style="color: #737c73;">// Errors can be &quot;catch&quot; without intermediate variable.</span>
</span><span class="athl-line" data-athl-line="247"><span style="color: #8992a7;">var</span> <span style="color: #c5c9c5;">value</span> <span style="color: #c4746e;">=</span> <span style="color: #8ba4b0;">some_function</span><span style="color: #9e9b93;">(</span><span style="color: #9e9b93;">)</span> <span style="color: #c4746e; font-weight: bold;">catch</span> <span style="color: #9e9b93;">|</span><span style="color: #a6a69c;">err</span><span style="color: #9e9b93;">|</span> <span style="color: #8992a7;">switch</span><span style="color: #9e9b93;">(</span><span style="color: #c5c9c5;">err</span><span style="color: #9e9b93;">)</span> <span style="color: #9e9b93;">{</span>
</span><span class="athl-line" data-athl-line="248">    <span style="color: #8ea4a2;">Error</span><span style="color: #9e9b93;">.</span><span style="color: #c4b28a;">UnExpected</span>     <span style="color: #9e9b93;">=&gt;</span> <span style="color: #c4746e;">return</span> <span style="color: #c5c9c5;">err</span><span style="color: #9e9b93;">,</span>   <span style="color: #737c73;">// Returns the error.</span>
</span><span class="athl-line" data-athl-line="249">    <span style="color: #8ea4a2;">Error</span><span style="color: #9e9b93;">.</span><span style="color: #c4b28a;">Authentication</span> <span style="color: #9e9b93;">=&gt;</span> <span style="color: #949fb5;">unreachable</span><span style="color: #9e9b93;">,</span>  <span style="color: #737c73;">// Not expected. Crashes the program.</span>
</span><span class="athl-line" data-athl-line="250">    <span style="color: #8992a7;">else</span>                 <span style="color: #9e9b93;">=&gt;</span> <span style="color: #949fb5;">unreachable</span><span style="color: #9e9b93;">,</span>
</span><span class="athl-line" data-athl-line="251"><span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="252">
</span><span class="athl-line" data-athl-line="253"><span style="color: #737c73;">// An error can be &quot;catch&quot; without giving it a name.</span>
</span><span class="athl-line" data-athl-line="254"><span style="color: #8992a7;">const</span> <span style="color: #c5c9c5;">unwrapped</span> <span style="color: #c4746e;">=</span> <span style="color: #8ba4b0;">some_function</span><span style="color: #9e9b93;">(</span><span style="color: #9e9b93;">)</span> <span style="color: #c4746e; font-weight: bold;">catch</span> <span style="color: #a292a3;">1234</span><span style="color: #9e9b93;">;</span> <span style="color: #737c73;">// &quot;unwrapped&quot; = 1234</span>
</span><span class="athl-line" data-athl-line="255">
</span><span class="athl-line" data-athl-line="256"><span style="color: #737c73;">// &quot;try&quot; is a very handy shortcut for &quot;catch |err| return err&quot;.</span>
</span><span class="athl-line" data-athl-line="257"><span style="color: #8992a7;">var</span> <span style="color: #c5c9c5;">value</span> <span style="color: #c4746e;">=</span> <span style="color: #c4746e; font-weight: bold;">try</span> <span style="color: #8ba4b0;">some_function</span><span style="color: #9e9b93;">(</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="258"><span style="color: #737c73;">// If &quot;some_function&quot; fails, the current function stops and returns the error.</span>
</span><span class="athl-line" data-athl-line="259"><span style="color: #737c73;">// &quot;value&quot; can only have a valid value, the error already is handled with &quot;try&quot;.</span>
</span><span class="athl-line" data-athl-line="260">```
</span><span class="athl-line" data-athl-line="261">
</span><span class="athl-line" data-athl-line="262">### <span style="color: #8ea4a2;">Control</span> flow<span style="color: #9e9b93;">.</span>
</span><span class="athl-line" data-athl-line="263">
</span><span class="athl-line" data-athl-line="264">```<span style="color: #8ba4b0;">zig</span>
</span><span class="athl-line" data-athl-line="265"><span style="color: #737c73;">// Conditional branching.</span>
</span><span class="athl-line" data-athl-line="266">
</span><span class="athl-line" data-athl-line="267"><span style="color: #8992a7;">if</span> <span style="color: #9e9b93;">(</span><span style="color: #c5c9c5;">condition</span><span style="color: #9e9b93;">)</span> <span style="color: #9e9b93;">{</span>
</span><span class="athl-line" data-athl-line="268">    <span style="color: #c4746e;">...</span>
</span><span class="athl-line" data-athl-line="269"><span style="color: #9e9b93;">}</span>
</span><span class="athl-line" data-athl-line="270"><span style="color: #8992a7;">else</span> <span style="color: #9e9b93;">{</span>
</span><span class="athl-line" data-athl-line="271">    <span style="color: #c4746e;">...</span>
</span><span class="athl-line" data-athl-line="272"><span style="color: #9e9b93;">}</span>
</span><span class="athl-line" data-athl-line="273">
</span><span class="athl-line" data-athl-line="274"><span style="color: #737c73;">// Ternary.</span>
</span><span class="athl-line" data-athl-line="275"><span style="color: #8992a7;">var</span> <span style="color: #c5c9c5;">value</span> <span style="color: #c4746e;">=</span> <span style="color: #8992a7;">if</span> <span style="color: #9e9b93;">(</span><span style="color: #c5c9c5;">condition</span><span style="color: #9e9b93;">)</span> <span style="color: #c5c9c5;">x</span> <span style="color: #8992a7;">else</span> <span style="color: #c5c9c5;">y</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="276">
</span><span class="athl-line" data-athl-line="277"><span style="color: #737c73;">// Shortcut for &quot;if (x) x else 0&quot;</span>
</span><span class="athl-line" data-athl-line="278"><span style="color: #8992a7;">var</span> <span style="color: #c5c9c5;">value</span> <span style="color: #c4746e;">=</span> <span style="color: #c5c9c5;">x</span> <span style="color: #c4746e; font-weight: bold;">orelse</span> <span style="color: #a292a3;">0</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="279">
</span><span class="athl-line" data-athl-line="280"><span style="color: #737c73;">// If &quot;a&quot; is an optional, which may contain a value.</span>
</span><span class="athl-line" data-athl-line="281"><span style="color: #8992a7;">if</span> <span style="color: #9e9b93;">(</span><span style="color: #c5c9c5;">a</span><span style="color: #9e9b93;">)</span> <span style="color: #9e9b93;">|</span><span style="color: #a6a69c;">value</span><span style="color: #9e9b93;">|</span> <span style="color: #9e9b93;">{</span>
</span><span class="athl-line" data-athl-line="282">    <span style="color: #8ba4b0;">print</span><span style="color: #9e9b93;">(</span><span style="color: #8a9a7b;">&quot;value: {}<span style="color: #c4746e; font-weight: bold;">\n</span>&quot;</span><span style="color: #9e9b93;">,</span> <span style="color: #9e9b93;">.</span><span style="color: #9e9b93;">{</span><span style="color: #c5c9c5;">value</span><span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="283"><span style="color: #9e9b93;">}</span>
</span><span class="athl-line" data-athl-line="284"><span style="color: #8992a7;">else</span> <span style="color: #9e9b93;">{</span>
</span><span class="athl-line" data-athl-line="285">    <span style="color: #8ba4b0;">print</span><span style="color: #9e9b93;">(</span><span style="color: #8a9a7b;">&quot;&#39;a&#39; is null<span style="color: #c4746e; font-weight: bold;">\n</span>&quot;</span><span style="color: #9e9b93;">,</span> <span style="color: #9e9b93;">.</span><span style="color: #9e9b93;">{</span><span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="286"><span style="color: #9e9b93;">}</span>
</span><span class="athl-line" data-athl-line="287">
</span><span class="athl-line" data-athl-line="288"><span style="color: #737c73;">// Get a pointer on the value (if it exists).</span>
</span><span class="athl-line" data-athl-line="289"><span style="color: #8992a7;">if</span> <span style="color: #9e9b93;">(</span><span style="color: #c5c9c5;">a</span><span style="color: #9e9b93;">)</span> <span style="color: #c4746e;">|</span><span style="color: #c4746e;">*</span><span style="color: #c5c9c5;">value</span><span style="color: #c4746e;">|</span> <span style="color: #9e9b93;">{</span> <span style="color: #c5c9c5;">value</span><span style="color: #c4746e;">.*</span> <span style="color: #c4746e;">+=</span> <span style="color: #a292a3;">1</span><span style="color: #9e9b93;">;</span> <span style="color: #9e9b93;">}</span>
</span><span class="athl-line" data-athl-line="290">
</span><span class="athl-line" data-athl-line="291">
</span><span class="athl-line" data-athl-line="292"><span style="color: #737c73;">// Loops.</span>
</span><span class="athl-line" data-athl-line="293">
</span><span class="athl-line" data-athl-line="294"><span style="color: #737c73;">// Syntax examples:</span>
</span><span class="athl-line" data-athl-line="295"><span style="color: #737c73;">//   while (condition) statement</span>
</span><span class="athl-line" data-athl-line="296"><span style="color: #737c73;">//   while (condition) : (end-of-iteration-statement) statement</span>
</span><span class="athl-line" data-athl-line="297"><span style="color: #737c73;">//</span>
</span><span class="athl-line" data-athl-line="298"><span style="color: #737c73;">//   for (iterable) statement</span>
</span><span class="athl-line" data-athl-line="299"><span style="color: #737c73;">//   for (iterable) |capture| statement</span>
</span><span class="athl-line" data-athl-line="300"><span style="color: #737c73;">//   for (iterable) statement else statement</span>
</span><span class="athl-line" data-athl-line="301">
</span><span class="athl-line" data-athl-line="302"><span style="color: #737c73;">// Note: loops work the same way over arrays or slices.</span>
</span><span class="athl-line" data-athl-line="303">
</span><span class="athl-line" data-athl-line="304"><span style="color: #737c73;">// Simple &quot;while&quot; loop.</span>
</span><span class="athl-line" data-athl-line="305"><span style="color: #8992a7;">while</span> <span style="color: #9e9b93;">(</span><span style="color: #c5c9c5;">i</span> <span style="color: #c4746e;">&lt;</span> <span style="color: #a292a3;">10</span><span style="color: #9e9b93;">)</span> <span style="color: #9e9b93;">{</span> <span style="color: #c5c9c5;">i</span> <span style="color: #c4746e;">+=</span> <span style="color: #a292a3;">1</span><span style="color: #9e9b93;">;</span> <span style="color: #9e9b93;">}</span>
</span><span class="athl-line" data-athl-line="306">
</span><span class="athl-line" data-athl-line="307"><span style="color: #737c73;">// While loop with a &quot;continue expression&quot;</span>
</span><span class="athl-line" data-athl-line="308"><span style="color: #737c73;">// (expression executed as the last expression of the loop).</span>
</span><span class="athl-line" data-athl-line="309"><span style="color: #8992a7;">while</span> <span style="color: #9e9b93;">(</span><span style="color: #c5c9c5;">i</span> <span style="color: #c4746e;">&lt;</span> <span style="color: #a292a3;">10</span><span style="color: #9e9b93;">)</span> <span style="color: #9e9b93;">:</span> <span style="color: #9e9b93;">(</span><span style="color: #c5c9c5;">i</span> <span style="color: #c4746e;">+=</span> <span style="color: #a292a3;">1</span><span style="color: #9e9b93;">)</span> <span style="color: #9e9b93;">{</span> <span style="color: #c4746e;">...</span> <span style="color: #9e9b93;">}</span>
</span><span class="athl-line" data-athl-line="310"><span style="color: #737c73;">// Same, with a more complex continue expression (block of code).</span>
</span><span class="athl-line" data-athl-line="311"><span style="color: #8992a7;">while</span> <span style="color: #9e9b93;">(</span><span style="color: #c5c9c5;">i</span> <span style="color: #c4746e;">*</span> <span style="color: #c5c9c5;">j</span> <span style="color: #c4746e;">&lt;</span> <span style="color: #a292a3;">2000</span><span style="color: #9e9b93;">)</span> <span style="color: #9e9b93;">:</span> <span style="color: #9e9b93;">(</span><span style="color: #9e9b93;">{</span> <span style="color: #c5c9c5;">i</span> <span style="color: #c4746e;">*=</span> <span style="color: #a292a3;">2</span><span style="color: #9e9b93;">;</span> <span style="color: #c5c9c5;">j</span> <span style="color: #c4746e;">*=</span> <span style="color: #a292a3;">3</span><span style="color: #9e9b93;">;</span> <span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">)</span> <span style="color: #9e9b93;">{</span> <span style="color: #c4746e;">...</span> <span style="color: #9e9b93;">}</span>
</span><span class="athl-line" data-athl-line="312">
</span><span class="athl-line" data-athl-line="313"><span style="color: #737c73;">// To iterate over a portion of a slice, reslice.</span>
</span><span class="athl-line" data-athl-line="314"><span style="color: #8992a7;">for</span> <span style="color: #9e9b93;">(</span><span style="color: #c5c9c5;">items</span><span style="color: #9e9b93;">[</span><span style="color: #a292a3;">0</span><span style="color: #c4746e;">..</span><span style="color: #a292a3;">1</span><span style="color: #9e9b93;">]</span><span style="color: #9e9b93;">)</span> <span style="color: #c4746e;">|</span><span style="color: #c5c9c5;">value</span><span style="color: #c4746e;">|</span> <span style="color: #9e9b93;">{</span> <span style="color: #c5c9c5;">sum</span> <span style="color: #c4746e;">+=</span> <span style="color: #c5c9c5;">value</span><span style="color: #9e9b93;">;</span> <span style="color: #9e9b93;">}</span>
</span><span class="athl-line" data-athl-line="315">
</span><span class="athl-line" data-athl-line="316"><span style="color: #737c73;">// Loop over every item of an array (or slice).</span>
</span><span class="athl-line" data-athl-line="317"><span style="color: #8992a7;">for</span> <span style="color: #9e9b93;">(</span><span style="color: #c5c9c5;">items</span><span style="color: #9e9b93;">)</span> <span style="color: #c4746e;">|</span><span style="color: #c5c9c5;">value</span><span style="color: #c4746e;">|</span> <span style="color: #9e9b93;">{</span> <span style="color: #c5c9c5;">sum</span> <span style="color: #c4746e;">+=</span> <span style="color: #c5c9c5;">value</span><span style="color: #9e9b93;">;</span> <span style="color: #9e9b93;">}</span>
</span><span class="athl-line" data-athl-line="318">
</span><span class="athl-line" data-athl-line="319"><span style="color: #737c73;">// Iterate and get pointers on values instead of copies.</span>
</span><span class="athl-line" data-athl-line="320"><span style="color: #8992a7;">for</span> <span style="color: #9e9b93;">(</span><span style="color: #c5c9c5;">items</span><span style="color: #9e9b93;">)</span> <span style="color: #c4746e;">|</span><span style="color: #c4746e;">*</span><span style="color: #c5c9c5;">value</span><span style="color: #c4746e;">|</span> <span style="color: #9e9b93;">{</span> <span style="color: #c5c9c5;">value</span><span style="color: #c4746e;">.*</span> <span style="color: #c4746e;">+=</span> <span style="color: #a292a3;">1</span><span style="color: #9e9b93;">;</span> <span style="color: #9e9b93;">}</span>
</span><span class="athl-line" data-athl-line="321">
</span><span class="athl-line" data-athl-line="322"><span style="color: #737c73;">// Iterate with an index.</span>
</span><span class="athl-line" data-athl-line="323"><span style="color: #8992a7;">for</span> <span style="color: #9e9b93;">(</span><span style="color: #c5c9c5;">items</span><span style="color: #9e9b93;">)</span> <span style="color: #9e9b93;">|</span><span style="color: #a6a69c;">value</span><span style="color: #9e9b93;">,</span> <span style="color: #a6a69c;">i</span><span style="color: #9e9b93;">|</span> <span style="color: #9e9b93;">{</span> <span style="color: #8ba4b0;">print</span><span style="color: #9e9b93;">(</span><span style="color: #8a9a7b;">&quot;val[{}] = {}<span style="color: #c4746e; font-weight: bold;">\n</span>&quot;</span><span style="color: #9e9b93;">,</span> <span style="color: #9e9b93;">.</span><span style="color: #9e9b93;">{</span><span style="color: #c5c9c5;">i</span><span style="color: #9e9b93;">,</span> <span style="color: #c5c9c5;">value</span><span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">;</span> <span style="color: #9e9b93;">}</span>
</span><span class="athl-line" data-athl-line="324">
</span><span class="athl-line" data-athl-line="325"><span style="color: #737c73;">// Iterate with pointer and index.</span>
</span><span class="athl-line" data-athl-line="326"><span style="color: #8992a7;">for</span> <span style="color: #9e9b93;">(</span><span style="color: #c5c9c5;">items</span><span style="color: #9e9b93;">)</span> <span style="color: #9e9b93;">|</span><span style="color: #c4746e;">*</span><span style="color: #a6a69c;">value</span><span style="color: #9e9b93;">,</span> <span style="color: #a6a69c;">i</span><span style="color: #9e9b93;">|</span> <span style="color: #9e9b93;">{</span> <span style="color: #8ba4b0;">print</span><span style="color: #9e9b93;">(</span><span style="color: #8a9a7b;">&quot;val[{}] = {}<span style="color: #c4746e; font-weight: bold;">\n</span>&quot;</span><span style="color: #9e9b93;">,</span> <span style="color: #9e9b93;">.</span><span style="color: #9e9b93;">{</span><span style="color: #c5c9c5;">i</span><span style="color: #9e9b93;">,</span> <span style="color: #c5c9c5;">value</span><span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">;</span> <span style="color: #c5c9c5;">value</span><span style="color: #c4746e;">.*</span> <span style="color: #c4746e;">+=</span> <span style="color: #a292a3;">1</span><span style="color: #9e9b93;">;</span> <span style="color: #9e9b93;">}</span>
</span><span class="athl-line" data-athl-line="327">
</span><span class="athl-line" data-athl-line="328">
</span><span class="athl-line" data-athl-line="329"><span style="color: #737c73;">// Break and continue are supported.</span>
</span><span class="athl-line" data-athl-line="330"><span style="color: #8992a7;">for</span> <span style="color: #9e9b93;">(</span><span style="color: #c5c9c5;">items</span><span style="color: #9e9b93;">)</span> <span style="color: #c4746e;">|</span><span style="color: #c5c9c5;">value</span><span style="color: #c4746e;">|</span> <span style="color: #9e9b93;">{</span>
</span><span class="athl-line" data-athl-line="331">    <span style="color: #8992a7;">if</span> <span style="color: #9e9b93;">(</span><span style="color: #c5c9c5;">value</span> <span style="color: #c4746e;">==</span> <span style="color: #a292a3;">0</span><span style="color: #9e9b93;">)</span>  <span style="color: #9e9b93;">{</span> <span style="color: #8992a7;">continue</span><span style="color: #9e9b93;">;</span> <span style="color: #9e9b93;">}</span>
</span><span class="athl-line" data-athl-line="332">    <span style="color: #8992a7;">if</span> <span style="color: #9e9b93;">(</span><span style="color: #c5c9c5;">value</span> <span style="color: #c4746e;">&gt;=</span> <span style="color: #a292a3;">10</span><span style="color: #9e9b93;">)</span> <span style="color: #9e9b93;">{</span> <span style="color: #8992a7;">break</span><span style="color: #9e9b93;">;</span>    <span style="color: #9e9b93;">}</span>
</span><span class="athl-line" data-athl-line="333">    <span style="color: #737c73;">// ...</span>
</span><span class="athl-line" data-athl-line="334"><span style="color: #9e9b93;">}</span>
</span><span class="athl-line" data-athl-line="335">
</span><span class="athl-line" data-athl-line="336"><span style="color: #737c73;">// For loops can also be used as expressions.</span>
</span><span class="athl-line" data-athl-line="337"><span style="color: #737c73;">// Similar to while loops, when you break from a for loop,</span>
</span><span class="athl-line" data-athl-line="338"><span style="color: #737c73;">// the else branch is not evaluated.</span>
</span><span class="athl-line" data-athl-line="339"><span style="color: #8992a7;">var</span> sum<span style="color: #9e9b93;">:</span> i32 <span style="color: #c4746e;">=</span> <span style="color: #a292a3;">0</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="340"><span style="color: #737c73;">// The &quot;for&quot; loop has to provide a value, which will be the &quot;else&quot; value.</span>
</span><span class="athl-line" data-athl-line="341"><span style="color: #8992a7;">const</span> result <span style="color: #c4746e;">=</span> <span style="color: #8992a7;">for</span> <span style="color: #9e9b93;">(</span><span style="color: #c5c9c5;">items</span><span style="color: #9e9b93;">)</span> <span style="color: #9e9b93;">|</span><span style="color: #a6a69c;">value</span><span style="color: #9e9b93;">|</span> <span style="color: #9e9b93;">{</span>
</span><span class="athl-line" data-athl-line="342">    <span style="color: #8992a7;">if</span> <span style="color: #9e9b93;">(</span><span style="color: #c5c9c5;">value</span> <span style="color: #c4746e;">!=</span> <span style="color: #949fb5;">null</span><span style="color: #9e9b93;">)</span> <span style="color: #9e9b93;">{</span>
</span><span class="athl-line" data-athl-line="343">        <span style="color: #c5c9c5;">sum</span> <span style="color: #c4746e;">+=</span> <span style="color: #c5c9c5;">value</span><span style="color: #c4746e;">.?</span><span style="color: #9e9b93;">;</span> <span style="color: #737c73;">// &quot;result&quot; will be the last &quot;sum&quot; value.</span>
</span><span class="athl-line" data-athl-line="344">    <span style="color: #9e9b93;">}</span>
</span><span class="athl-line" data-athl-line="345"><span style="color: #9e9b93;">}</span> <span style="color: #8992a7;">else</span> <span style="color: #a292a3;">0</span><span style="color: #9e9b93;">;</span>                  <span style="color: #737c73;">// Last value.</span>
</span><span class="athl-line" data-athl-line="346">```
</span><span class="athl-line" data-athl-line="347">
</span><span class="athl-line" data-athl-line="348">### Labels<span style="color: #9e9b93;">.</span>
</span><span class="athl-line" data-athl-line="349">
</span><span class="athl-line" data-athl-line="350">```<span style="color: #8ba4b0;">zig</span>
</span><span class="athl-line" data-athl-line="351"><span style="color: #737c73;">// Labels are a way to name an instruction, a location in the code.</span>
</span><span class="athl-line" data-athl-line="352"><span style="color: #737c73;">// Labels can be used to &quot;continue&quot; or &quot;break&quot; in a nested loop.</span>
</span><span class="athl-line" data-athl-line="353">outer<span style="color: #9e9b93;">:</span> <span style="color: #8992a7;">for</span> <span style="color: #9e9b93;">(</span><span style="color: #9e9b93;">[</span><span style="color: #c4746e;">_</span><span style="color: #9e9b93;">]</span><span style="color: #949fb5;">i32</span><span style="color: #9e9b93;">{</span> <span style="color: #a292a3;">1</span><span style="color: #9e9b93;">,</span> <span style="color: #a292a3;">2</span><span style="color: #9e9b93;">,</span> <span style="color: #a292a3;">3</span><span style="color: #9e9b93;">,</span> <span style="color: #a292a3;">4</span><span style="color: #9e9b93;">,</span> <span style="color: #a292a3;">5</span><span style="color: #9e9b93;">,</span> <span style="color: #a292a3;">6</span><span style="color: #9e9b93;">,</span> <span style="color: #a292a3;">7</span><span style="color: #9e9b93;">,</span> <span style="color: #a292a3;">8</span> <span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">)</span> <span style="color: #c4746e;">|</span><span style="color: #c4746e;">_</span><span style="color: #c4746e;">|</span> <span style="color: #9e9b93;">{</span>
</span><span class="athl-line" data-athl-line="354">    <span style="color: #8992a7;">for</span> <span style="color: #9e9b93;">(</span><span style="color: #9e9b93;">[</span><span style="color: #c4746e;">_</span><span style="color: #9e9b93;">]</span><span style="color: #949fb5;">i32</span><span style="color: #9e9b93;">{</span> <span style="color: #a292a3;">1</span><span style="color: #9e9b93;">,</span> <span style="color: #a292a3;">2</span><span style="color: #9e9b93;">,</span> <span style="color: #a292a3;">3</span><span style="color: #9e9b93;">,</span> <span style="color: #a292a3;">4</span><span style="color: #9e9b93;">,</span> <span style="color: #a292a3;">5</span> <span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">)</span> <span style="color: #9e9b93;">|</span><span style="color: #c4746e;">_</span><span style="color: #9e9b93;">|</span> <span style="color: #9e9b93;">{</span>
</span><span class="athl-line" data-athl-line="355">        <span style="color: #c5c9c5;">count</span> <span style="color: #c4746e;">+=</span> <span style="color: #a292a3;">1</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="356">        <span style="color: #8992a7;">continue</span> <span style="color: #9e9b93;">:</span><span style="color: #8992a7; font-weight: bold;">outer</span><span style="color: #9e9b93;">;</span> <span style="color: #737c73;">// &quot;continue&quot; for the first loop.</span>
</span><span class="athl-line" data-athl-line="357">    <span style="color: #9e9b93;">}</span>
</span><span class="athl-line" data-athl-line="358"><span style="color: #9e9b93;">}</span> <span style="color: #737c73;">// count = 8</span>
</span><span class="athl-line" data-athl-line="359">outer<span style="color: #9e9b93;">:</span> <span style="color: #8992a7;">for</span> <span style="color: #9e9b93;">(</span><span style="color: #9e9b93;">[</span><span style="color: #c4746e;">_</span><span style="color: #9e9b93;">]</span><span style="color: #949fb5;">i32</span><span style="color: #9e9b93;">{</span> <span style="color: #a292a3;">1</span><span style="color: #9e9b93;">,</span> <span style="color: #a292a3;">2</span><span style="color: #9e9b93;">,</span> <span style="color: #a292a3;">3</span><span style="color: #9e9b93;">,</span> <span style="color: #a292a3;">4</span><span style="color: #9e9b93;">,</span> <span style="color: #a292a3;">5</span><span style="color: #9e9b93;">,</span> <span style="color: #a292a3;">6</span><span style="color: #9e9b93;">,</span> <span style="color: #a292a3;">7</span><span style="color: #9e9b93;">,</span> <span style="color: #a292a3;">8</span> <span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">)</span> <span style="color: #c4746e;">|</span><span style="color: #c4746e;">_</span><span style="color: #c4746e;">|</span> <span style="color: #9e9b93;">{</span>
</span><span class="athl-line" data-athl-line="360">    <span style="color: #8992a7;">for</span> <span style="color: #9e9b93;">(</span><span style="color: #9e9b93;">[</span><span style="color: #c4746e;">_</span><span style="color: #9e9b93;">]</span><span style="color: #949fb5;">i32</span><span style="color: #9e9b93;">{</span> <span style="color: #a292a3;">1</span><span style="color: #9e9b93;">,</span> <span style="color: #a292a3;">2</span><span style="color: #9e9b93;">,</span> <span style="color: #a292a3;">3</span><span style="color: #9e9b93;">,</span> <span style="color: #a292a3;">4</span><span style="color: #9e9b93;">,</span> <span style="color: #a292a3;">5</span> <span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">)</span> <span style="color: #9e9b93;">|</span><span style="color: #c4746e;">_</span><span style="color: #9e9b93;">|</span> <span style="color: #9e9b93;">{</span>
</span><span class="athl-line" data-athl-line="361">        <span style="color: #c5c9c5;">count</span> <span style="color: #c4746e;">+=</span> <span style="color: #a292a3;">1</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="362">        <span style="color: #8992a7;">break</span> <span style="color: #9e9b93;">:</span><span style="color: #8992a7; font-weight: bold;">outer</span><span style="color: #9e9b93;">;</span> <span style="color: #737c73;">// &quot;break&quot; for the first loop.</span>
</span><span class="athl-line" data-athl-line="363">    <span style="color: #9e9b93;">}</span>
</span><span class="athl-line" data-athl-line="364"><span style="color: #9e9b93;">}</span> <span style="color: #737c73;">// count = 1</span>
</span><span class="athl-line" data-athl-line="365">
</span><span class="athl-line" data-athl-line="366">
</span><span class="athl-line" data-athl-line="367"><span style="color: #737c73;">// Labels can also be used to return a value from a block.</span>
</span><span class="athl-line" data-athl-line="368"><span style="color: #8992a7;">var</span> y<span style="color: #9e9b93;">:</span> i32 <span style="color: #c4746e;">=</span> <span style="color: #a292a3;">5</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="369"><span style="color: #8992a7;">const</span> x <span style="color: #c4746e;">=</span> <span style="color: #8992a7; font-weight: bold;">blk</span><span style="color: #9e9b93;">:</span> <span style="color: #9e9b93;">{</span>
</span><span class="athl-line" data-athl-line="370">    <span style="color: #c5c9c5;">y</span> <span style="color: #c4746e;">+=</span> <span style="color: #a292a3;">1</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="371">    <span style="color: #8992a7;">break</span> <span style="color: #9e9b93;">:</span><span style="color: #8992a7; font-weight: bold;">blk</span> <span style="color: #c5c9c5;">y</span><span style="color: #9e9b93;">;</span> <span style="color: #737c73;">// Now &quot;x&quot; equals 6.</span>
</span><span class="athl-line" data-athl-line="372"><span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="373"><span style="color: #737c73;">// Relevant in cases like &quot;for else&quot; expression (explained in the following).</span>
</span><span class="athl-line" data-athl-line="374">
</span><span class="athl-line" data-athl-line="375"><span style="color: #737c73;">// For loops can be used as expressions.</span>
</span><span class="athl-line" data-athl-line="376"><span style="color: #737c73;">// When you break from a for loop, the else branch is not evaluated.</span>
</span><span class="athl-line" data-athl-line="377"><span style="color: #737c73;">// WARNING: counter-intuitive.</span>
</span><span class="athl-line" data-athl-line="378"><span style="color: #737c73;">//      The &quot;for&quot; loop will run, then the &quot;else&quot; block will run.</span>
</span><span class="athl-line" data-athl-line="379"><span style="color: #737c73;">//      The &quot;else&quot; keyword has to be followed by the value to give to &quot;result&quot;.</span>
</span><span class="athl-line" data-athl-line="380"><span style="color: #737c73;">//      See later for another form.</span>
</span><span class="athl-line" data-athl-line="381"><span style="color: #8992a7;">var</span> sum<span style="color: #9e9b93;">:</span> u8 <span style="color: #c4746e;">=</span> <span style="color: #a292a3;">0</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="382"><span style="color: #8992a7;">const</span> result <span style="color: #c4746e;">=</span> <span style="color: #8992a7;">for</span> <span style="color: #9e9b93;">(</span><span style="color: #c5c9c5;">items</span><span style="color: #9e9b93;">)</span> <span style="color: #9e9b93;">|</span><span style="color: #a6a69c;">value</span><span style="color: #9e9b93;">|</span> <span style="color: #9e9b93;">{</span>
</span><span class="athl-line" data-athl-line="383">    <span style="color: #c5c9c5;">sum</span> <span style="color: #c4746e;">+=</span> <span style="color: #c5c9c5;">value</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="384"><span style="color: #9e9b93;">}</span> <span style="color: #8992a7;">else</span> <span style="color: #a292a3;">8</span><span style="color: #9e9b93;">;</span> <span style="color: #737c73;">// result = 8</span>
</span><span class="athl-line" data-athl-line="385">
</span><span class="athl-line" data-athl-line="386"><span style="color: #737c73;">// In this case, the &quot;else&quot; keyword is followed by a value, too.</span>
</span><span class="athl-line" data-athl-line="387"><span style="color: #737c73;">// However, the syntax is different: it is labeled.</span>
</span><span class="athl-line" data-athl-line="388"><span style="color: #737c73;">// Instead of a value, there is a label followed by a block of code, which</span>
</span><span class="athl-line" data-athl-line="389"><span style="color: #737c73;">// allows to do stuff before returning the value (see the &quot;break&quot; invocation).</span>
</span><span class="athl-line" data-athl-line="390"><span style="color: #8992a7;">const</span> result <span style="color: #c4746e;">=</span> <span style="color: #8992a7;">for</span> <span style="color: #9e9b93;">(</span><span style="color: #c5c9c5;">items</span><span style="color: #9e9b93;">)</span> <span style="color: #9e9b93;">|</span><span style="color: #a6a69c;">value</span><span style="color: #9e9b93;">|</span> <span style="color: #9e9b93;">{</span> <span style="color: #737c73;">// First: loop.</span>
</span><span class="athl-line" data-athl-line="391">    <span style="color: #c5c9c5;">sum</span> <span style="color: #c4746e;">+=</span> <span style="color: #c5c9c5;">value</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="392"><span style="color: #9e9b93;">}</span> <span style="color: #8992a7;">else</span> <span style="color: #8992a7; font-weight: bold;">blk</span><span style="color: #9e9b93;">:</span> <span style="color: #9e9b93;">{</span>                        <span style="color: #737c73;">// Second: &quot;else&quot; block.</span>
</span><span class="athl-line" data-athl-line="393">    <span style="color: #c5c9c5;">std</span><span style="color: #9e9b93;">.</span><span style="color: #c4b28a;">log</span><span style="color: #9e9b93;">.</span><span style="color: #8ba4b0;">info</span><span style="color: #9e9b93;">(</span><span style="color: #8a9a7b;">&quot;executed AFTER the loop!&quot;</span><span style="color: #9e9b93;">,</span> <span style="color: #9e9b93;">.</span><span style="color: #9e9b93;">{</span><span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="394">    <span style="color: #8992a7;">break</span> <span style="color: #9e9b93;">:</span><span style="color: #8992a7; font-weight: bold;">blk</span> <span style="color: #c5c9c5;">sum</span><span style="color: #9e9b93;">;</span> <span style="color: #737c73;">// The &quot;sum&quot; value will replace the label &quot;blk&quot;.</span>
</span><span class="athl-line" data-athl-line="395"><span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="396">```
</span><span class="athl-line" data-athl-line="397">
</span><span class="athl-line" data-athl-line="398">### Switch<span style="color: #9e9b93;">.</span>
</span><span class="athl-line" data-athl-line="399">
</span><span class="athl-line" data-athl-line="400">```<span style="color: #c4b28a;">zig</span>
</span><span class="athl-line" data-athl-line="401"><span style="color: #737c73;">// As a switch in C, but slightly more advanced.</span>
</span><span class="athl-line" data-athl-line="402"><span style="color: #737c73;">// Syntax:</span>
</span><span class="athl-line" data-athl-line="403"><span style="color: #737c73;">//   switch (value) {</span>
</span><span class="athl-line" data-athl-line="404"><span style="color: #737c73;">//       pattern =&gt; expression,</span>
</span><span class="athl-line" data-athl-line="405"><span style="color: #737c73;">//       pattern =&gt; expression,</span>
</span><span class="athl-line" data-athl-line="406"><span style="color: #737c73;">//       else    =&gt; expression</span>
</span><span class="athl-line" data-athl-line="407"><span style="color: #737c73;">//   };</span>
</span><span class="athl-line" data-athl-line="408">
</span><span class="athl-line" data-athl-line="409"><span style="color: #737c73;">// A switch only checking for simple values.</span>
</span><span class="athl-line" data-athl-line="410">var x <span style="color: #c4746e;">=</span> <span style="color: #8992a7;">switch</span><span style="color: #9e9b93;">(</span><span style="color: #c5c9c5;">value</span><span style="color: #9e9b93;">)</span> <span style="color: #9e9b93;">{</span>
</span><span class="athl-line" data-athl-line="411">    <span style="color: #8ea4a2;">Error</span><span style="color: #9e9b93;">.</span><span style="color: #c4b28a;">UnExpected</span>     <span style="color: #9e9b93;">=&gt;</span> <span style="color: #c4746e;">return</span> <span style="color: #c5c9c5;">err</span><span style="color: #9e9b93;">,</span>
</span><span class="athl-line" data-athl-line="412">    <span style="color: #8ea4a2;">Error</span><span style="color: #9e9b93;">.</span><span style="color: #c4b28a;">Authentication</span> <span style="color: #9e9b93;">=&gt;</span> <span style="color: #949fb5;">unreachable</span><span style="color: #9e9b93;">,</span>
</span><span class="athl-line" data-athl-line="413">    <span style="color: #8992a7;">else</span>                 <span style="color: #9e9b93;">=&gt;</span> <span style="color: #949fb5;">unreachable</span><span style="color: #9e9b93;">,</span>
</span><span class="athl-line" data-athl-line="414"><span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="415">
</span><span class="athl-line" data-athl-line="416"><span style="color: #737c73;">// A slightly more advanced switch, accepting a range of values:</span>
</span><span class="athl-line" data-athl-line="417"><span style="color: #8992a7;">const</span> foo<span style="color: #9e9b93;">:</span> i32 <span style="color: #c4746e;">=</span> <span style="color: #a292a3;">0</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="418"><span style="color: #8992a7;">const</span> bar <span style="color: #c4746e;">=</span> <span style="color: #8992a7;">switch</span> <span style="color: #9e9b93;">(</span><span style="color: #c5c9c5;">foo</span><span style="color: #9e9b93;">)</span> <span style="color: #9e9b93;">{</span>
</span><span class="athl-line" data-athl-line="419">    <span style="color: #a292a3;">0</span>                        <span style="color: #9e9b93;">=&gt;</span> <span style="color: #8a9a7b;">&quot;zero&quot;</span><span style="color: #9e9b93;">,</span>
</span><span class="athl-line" data-athl-line="420">    <span style="color: #a292a3;">1</span><span style="color: #c4746e;">...</span><span style="color: #c5c9c5;">std</span><span style="color: #9e9b93;">.</span><span style="color: #c4b28a;">math</span><span style="color: #9e9b93;">.</span><span style="color: #8ba4b0;">maxInt</span><span style="color: #9e9b93;">(</span><span style="color: #949fb5;">i32</span><span style="color: #9e9b93;">)</span> <span style="color: #9e9b93;">=&gt;</span> <span style="color: #8a9a7b;">&quot;positive&quot;</span><span style="color: #9e9b93;">,</span>
</span><span class="athl-line" data-athl-line="421">    <span style="color: #8992a7;">else</span>                     <span style="color: #9e9b93;">=&gt;</span> <span style="color: #8a9a7b;">&quot;negative&quot;</span><span style="color: #9e9b93;">,</span>
</span><span class="athl-line" data-athl-line="422"><span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="423">```
</span><span class="athl-line" data-athl-line="424">
</span><span class="athl-line" data-athl-line="425">### Structures<span style="color: #9e9b93;">.</span>
</span><span class="athl-line" data-athl-line="426">
</span><span class="athl-line" data-athl-line="427">```<span style="color: #c4b28a;">zig</span>
</span><span class="athl-line" data-athl-line="428"><span style="color: #737c73;">// Structure containing a single value.</span><span style="color: #9e9b93;"></span>
</span><span class="athl-line" data-athl-line="429"><span style="color: #8992a7;">const</span> <span style="color: #8ea4a2;">Full</span> <span style="color: #c4746e;">=</span> <span style="color: #8992a7;">struct</span> <span style="color: #9e9b93;">{</span>
</span><span class="athl-line" data-athl-line="430">    <span style="color: #c4b28a;">number</span><span style="color: #9e9b93;">:</span> <span style="color: #949fb5;">u16</span><span style="color: #9e9b93;">,</span>
</span><span class="athl-line" data-athl-line="431"><span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="432">
</span><span class="athl-line" data-athl-line="433"><span style="color: #737c73;">// Packed structure, with guaranteed in-memory layout.</span>
</span><span class="athl-line" data-athl-line="434"><span style="color: #8992a7;">const</span> <span style="color: #8ea4a2;">Divided</span> <span style="color: #c4746e;">=</span> <span style="color: #8992a7;">packed</span> <span style="color: #8992a7;">struct</span> <span style="color: #9e9b93;">{</span>
</span><span class="athl-line" data-athl-line="435">    <span style="color: #c4b28a;">half1</span><span style="color: #9e9b93;">:</span> <span style="color: #949fb5;">u8</span><span style="color: #9e9b93;">,</span>
</span><span class="athl-line" data-athl-line="436">    <span style="color: #c4b28a;">quarter3</span><span style="color: #9e9b93;">:</span> <span style="color: #949fb5;">u4</span><span style="color: #9e9b93;">,</span>
</span><span class="athl-line" data-athl-line="437">    <span style="color: #c4b28a;">quarter4</span><span style="color: #9e9b93;">:</span> <span style="color: #949fb5;">u4</span><span style="color: #9e9b93;">,</span>
</span><span class="athl-line" data-athl-line="438"><span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="439">
</span><span class="athl-line" data-athl-line="440"><span style="color: #737c73;">// Point is a constant representing a structure containing two u32, &quot;x&quot; and &quot;y&quot;.</span>
</span><span class="athl-line" data-athl-line="441"><span style="color: #737c73;">// &quot;x&quot; has a default value, which wasn&#39;t possible in C.</span>
</span><span class="athl-line" data-athl-line="442"><span style="color: #8992a7;">const</span> <span style="color: #8ea4a2;">Point</span> <span style="color: #c4746e;">=</span> <span style="color: #8992a7;">struct</span> <span style="color: #9e9b93;">{</span>
</span><span class="athl-line" data-athl-line="443">    <span style="color: #c4b28a;">x</span><span style="color: #9e9b93;">:</span> <span style="color: #949fb5;">u32</span> <span style="color: #c4746e;">=</span> <span style="color: #a292a3;">1</span><span style="color: #9e9b93;">,</span> <span style="color: #737c73;">// default value</span>
</span><span class="athl-line" data-athl-line="444">    <span style="color: #c4b28a;">y</span><span style="color: #9e9b93;">:</span> <span style="color: #949fb5;">u32</span><span style="color: #9e9b93;">,</span>
</span><span class="athl-line" data-athl-line="445"><span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="446">
</span><span class="athl-line" data-athl-line="447"><span style="color: #737c73;">// Variable &quot;p&quot; is a new Point, with x = 1 (default value) and y = 2.</span>
</span><span class="athl-line" data-athl-line="448"><span style="color: #8992a7;">var</span> <span style="color: #c5c9c5;">p</span> <span style="color: #c4746e;">=</span> <span style="color: #8ea4a2;">Point</span><span style="color: #9e9b93;">{</span> <span style="color: #9e9b93;">.</span><span style="color: #c4b28a;">y</span> <span style="color: #c4746e;">=</span> <span style="color: #a292a3;">2</span> <span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="449">
</span><span class="athl-line" data-athl-line="450"><span style="color: #737c73;">// Fields are accessed as usual with the dot notation: variable.field.</span>
</span><span class="athl-line" data-athl-line="451"><span style="color: #8ba4b0;">print</span><span style="color: #9e9b93;">(</span><span style="color: #8a9a7b;">&quot;p.x: {}<span style="color: #c4746e; font-weight: bold;">\n</span>&quot;</span><span style="color: #9e9b93;">,</span> <span style="color: #9e9b93;">.</span><span style="color: #9e9b93;">{</span><span style="color: #c5c9c5;">p</span><span style="color: #9e9b93;">.</span><span style="color: #c4b28a;">x</span><span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">;</span> <span style="color: #737c73;">// 1</span>
</span><span class="athl-line" data-athl-line="452"><span style="color: #8ba4b0;">print</span><span style="color: #9e9b93;">(</span><span style="color: #8a9a7b;">&quot;p.y: {}<span style="color: #c4746e; font-weight: bold;">\n</span>&quot;</span><span style="color: #9e9b93;">,</span> <span style="color: #9e9b93;">.</span><span style="color: #9e9b93;">{</span><span style="color: #c5c9c5;">p</span><span style="color: #9e9b93;">.</span><span style="color: #c4b28a;">y</span><span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">;</span> <span style="color: #737c73;">// 2</span>
</span><span class="athl-line" data-athl-line="453">
</span><span class="athl-line" data-athl-line="454">
</span><span class="athl-line" data-athl-line="455"><span style="color: #737c73;">// A structure can also contain public constants and functions.</span>
</span><span class="athl-line" data-athl-line="456"><span style="color: #8992a7;">const</span> <span style="color: #8ea4a2;">Point</span> <span style="color: #c4746e;">=</span> <span style="color: #8992a7;">struct</span> <span style="color: #9e9b93;">{</span>
</span><span class="athl-line" data-athl-line="457">    <span style="color: #8992a7;">pub</span> <span style="color: #8992a7;">const</span> <span style="color: #c5c9c5;">some_constant</span> <span style="color: #c4746e;">=</span> <span style="color: #a292a3;">30</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="458">
</span><span class="athl-line" data-athl-line="459">    <span style="color: #c4b28a;">x</span><span style="color: #9e9b93;">:</span> <span style="color: #949fb5;">u32</span><span style="color: #9e9b93;">,</span>
</span><span class="athl-line" data-athl-line="460">    <span style="color: #c4b28a;">y</span><span style="color: #9e9b93;">:</span> <span style="color: #949fb5;">u32</span><span style="color: #9e9b93;">,</span>
</span><span class="athl-line" data-athl-line="461">
</span><span class="athl-line" data-athl-line="462">    <span style="color: #737c73;">// This function &quot;init&quot; creates a Point and returns it.</span>
</span><span class="athl-line" data-athl-line="463">    <span style="color: #8992a7;">pub</span> <span style="color: #8992a7;">fn</span> <span style="color: #8ba4b0;">init</span><span style="color: #9e9b93;">(</span><span style="color: #9e9b93;">)</span> <span style="color: #8ea4a2;">Point</span> <span style="color: #9e9b93;">{</span>
</span><span class="athl-line" data-athl-line="464">        <span style="color: #c4746e;">return</span> <span style="color: #8ea4a2;">Point</span><span style="color: #9e9b93;">{</span> <span style="color: #9e9b93;">.</span><span style="color: #c4b28a;">x</span> <span style="color: #c4746e;">=</span> <span style="color: #a292a3;">0</span><span style="color: #9e9b93;">,</span> <span style="color: #9e9b93;">.</span><span style="color: #c4b28a;">y</span> <span style="color: #c4746e;">=</span> <span style="color: #a292a3;">0</span> <span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="465">    <span style="color: #9e9b93;">}</span>
</span><span class="athl-line" data-athl-line="466"><span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="467">
</span><span class="athl-line" data-athl-line="468">
</span><span class="athl-line" data-athl-line="469"><span style="color: #737c73;">// How to access a structure public constant.</span>
</span><span class="athl-line" data-athl-line="470"><span style="color: #737c73;">// The value isn&#39;t accessed from an &quot;instance&quot; of the structure, but from the</span>
</span><span class="athl-line" data-athl-line="471"><span style="color: #737c73;">// constant representing the structure definition (Point).</span>
</span><span class="athl-line" data-athl-line="472"><span style="color: #8ba4b0;">print</span><span style="color: #9e9b93;">(</span><span style="color: #8a9a7b;">&quot;constant: {}<span style="color: #c4746e; font-weight: bold;">\n</span>&quot;</span><span style="color: #9e9b93;">,</span> <span style="color: #9e9b93;">.</span><span style="color: #9e9b93;">{</span><span style="color: #8ea4a2;">Point</span><span style="color: #9e9b93;">.</span><span style="color: #c4b28a;">some_constant</span><span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="473">
</span><span class="athl-line" data-athl-line="474"><span style="color: #737c73;">// Having an &quot;init&quot; function is rather idiomatic in the standard library.</span>
</span><span class="athl-line" data-athl-line="475"><span style="color: #737c73;">// More on that later.</span>
</span><span class="athl-line" data-athl-line="476"><span style="color: #8992a7;">var</span> <span style="color: #c5c9c5;">p</span> <span style="color: #c4746e;">=</span> <span style="color: #8ea4a2;">Point</span><span style="color: #9e9b93;">.</span><span style="color: #8ba4b0;">init</span><span style="color: #9e9b93;">(</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="477"><span style="color: #8ba4b0;">print</span><span style="color: #9e9b93;">(</span><span style="color: #8a9a7b;">&quot;p.x: {}<span style="color: #c4746e; font-weight: bold;">\n</span>&quot;</span><span style="color: #9e9b93;">,</span> <span style="color: #9e9b93;">.</span><span style="color: #9e9b93;">{</span><span style="color: #c5c9c5;">p</span><span style="color: #9e9b93;">.</span><span style="color: #c4b28a;">x</span><span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">;</span> <span style="color: #737c73;">// p.x = 0</span>
</span><span class="athl-line" data-athl-line="478"><span style="color: #8ba4b0;">print</span><span style="color: #9e9b93;">(</span><span style="color: #8a9a7b;">&quot;p.y: {}<span style="color: #c4746e; font-weight: bold;">\n</span>&quot;</span><span style="color: #9e9b93;">,</span> <span style="color: #9e9b93;">.</span><span style="color: #9e9b93;">{</span><span style="color: #c5c9c5;">p</span><span style="color: #9e9b93;">.</span><span style="color: #c4b28a;">y</span><span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">;</span> <span style="color: #737c73;">// p.y = 0</span>
</span><span class="athl-line" data-athl-line="479">
</span><span class="athl-line" data-athl-line="480">
</span><span class="athl-line" data-athl-line="481"><span style="color: #737c73;">// Structures often have functions to modify their state, similar to</span>
</span><span class="athl-line" data-athl-line="482"><span style="color: #737c73;">// object-oriented programming.</span>
</span><span class="athl-line" data-athl-line="483"><span style="color: #8992a7;">const</span> <span style="color: #8ea4a2;">Point</span> <span style="color: #c4746e;">=</span> <span style="color: #8992a7;">struct</span> <span style="color: #9e9b93;">{</span>
</span><span class="athl-line" data-athl-line="484">    <span style="color: #8992a7;">const</span> <span style="color: #8ea4a2;">Self</span> <span style="color: #c4746e;">=</span> <span style="color: #949fb5;">@This</span><span style="color: #9e9b93;">(</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">;</span> <span style="color: #737c73;">// Refers to its own type (later called &quot;Point&quot;).</span>
</span><span class="athl-line" data-athl-line="485">
</span><span class="athl-line" data-athl-line="486">    <span style="color: #c4b28a;">x</span><span style="color: #9e9b93;">:</span> <span style="color: #949fb5;">u32</span><span style="color: #9e9b93;">,</span>
</span><span class="athl-line" data-athl-line="487">    <span style="color: #c4b28a;">y</span><span style="color: #9e9b93;">:</span> <span style="color: #949fb5;">u32</span><span style="color: #9e9b93;">,</span>
</span><span class="athl-line" data-athl-line="488">
</span><span class="athl-line" data-athl-line="489">    <span style="color: #737c73;">// Take a look at the signature. First argument is of type *Self: &quot;self&quot; is</span>
</span><span class="athl-line" data-athl-line="490">    <span style="color: #737c73;">// a pointer on the instance of the structure.</span>
</span><span class="athl-line" data-athl-line="491">    <span style="color: #737c73;">// This allows the same &quot;dot&quot; notation as in OOP, like &quot;instance.set(x,y)&quot;.</span>
</span><span class="athl-line" data-athl-line="492">    <span style="color: #737c73;">// See the following example.</span>
</span><span class="athl-line" data-athl-line="493">    <span style="color: #8992a7;">pub</span> <span style="color: #8992a7;">fn</span> <span style="color: #8ba4b0;">set</span><span style="color: #9e9b93;">(</span><span style="color: #a6a69c;">self</span><span style="color: #9e9b93;">:</span> <span style="color: #c4746e;">*</span><span style="color: #8ea4a2;">Self</span><span style="color: #9e9b93;">,</span> <span style="color: #a6a69c;">x</span><span style="color: #9e9b93;">:</span> <span style="color: #949fb5;">u32</span><span style="color: #9e9b93;">,</span> <span style="color: #a6a69c;">y</span><span style="color: #9e9b93;">:</span> <span style="color: #949fb5;">u32</span><span style="color: #9e9b93;">)</span> <span style="color: #949fb5;">void</span> <span style="color: #9e9b93;">{</span>
</span><span class="athl-line" data-athl-line="494">        <span style="color: #c5c9c5;">self</span><span style="color: #9e9b93;">.</span><span style="color: #c4b28a;">x</span> <span style="color: #c4746e;">=</span> <span style="color: #c5c9c5;">x</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="495">        <span style="color: #c5c9c5;">self</span><span style="color: #9e9b93;">.</span><span style="color: #c4b28a;">y</span> <span style="color: #c4746e;">=</span> <span style="color: #c5c9c5;">y</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="496">    <span style="color: #9e9b93;">}</span>
</span><span class="athl-line" data-athl-line="497">
</span><span class="athl-line" data-athl-line="498">    <span style="color: #737c73;">// Again, look at the signature. First argument is of type Self (not *Self),</span>
</span><span class="athl-line" data-athl-line="499">    <span style="color: #737c73;">// this isn&#39;t a pointer. In this case, &quot;self&quot; refers to the instance of the</span>
</span><span class="athl-line" data-athl-line="500">    <span style="color: #737c73;">// structure, but can&#39;t be modified.</span>
</span><span class="athl-line" data-athl-line="501">    <span style="color: #8992a7;">pub</span> <span style="color: #8992a7;">fn</span> <span style="color: #8ba4b0;">getx</span><span style="color: #9e9b93;">(</span><span style="color: #a6a69c;">self</span><span style="color: #9e9b93;">:</span> <span style="color: #8ea4a2;">Self</span><span style="color: #9e9b93;">)</span> <span style="color: #949fb5;">u32</span> <span style="color: #9e9b93;">{</span>
</span><span class="athl-line" data-athl-line="502">        <span style="color: #c4746e;">return</span> <span style="color: #c5c9c5;">self</span><span style="color: #9e9b93;">.</span><span style="color: #c4b28a;">x</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="503">    <span style="color: #9e9b93;">}</span>
</span><span class="athl-line" data-athl-line="504">
</span><span class="athl-line" data-athl-line="505">    <span style="color: #737c73;">// PS: two previous functions may be somewhat useless.</span>
</span><span class="athl-line" data-athl-line="506">    <span style="color: #737c73;">//     Attributes can be changed directly, no need for accessor functions.</span>
</span><span class="athl-line" data-athl-line="507">    <span style="color: #737c73;">//     It was just an example.</span>
</span><span class="athl-line" data-athl-line="508"><span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="509">
</span><span class="athl-line" data-athl-line="510"><span style="color: #737c73;">// Let&#39;s use the previous structure.</span>
</span><span class="athl-line" data-athl-line="511"><span style="color: #8992a7;">var</span> <span style="color: #c5c9c5;">p</span> <span style="color: #c4746e;">=</span> <span style="color: #8ea4a2;">Point</span><span style="color: #9e9b93;">{</span> <span style="color: #9e9b93;">.</span><span style="color: #c4b28a;">x</span> <span style="color: #c4746e;">=</span> <span style="color: #a292a3;">0</span><span style="color: #9e9b93;">,</span> <span style="color: #9e9b93;">.</span><span style="color: #c4b28a;">y</span> <span style="color: #c4746e;">=</span> <span style="color: #a292a3;">0</span> <span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">;</span> <span style="color: #737c73;">// &quot;p&quot; variable is a Point.</span>
</span><span class="athl-line" data-athl-line="512">
</span><span class="athl-line" data-athl-line="513"><span style="color: #c5c9c5;">p</span><span style="color: #9e9b93;">.</span><span style="color: #8ba4b0;">set</span><span style="color: #9e9b93;">(</span><span style="color: #a292a3;">10</span><span style="color: #9e9b93;">,</span> <span style="color: #a292a3;">30</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">;</span> <span style="color: #737c73;">// x and y attributes of &quot;p&quot; are modified via the &quot;set&quot; function.</span>
</span><span class="athl-line" data-athl-line="514"><span style="color: #8ba4b0;">print</span><span style="color: #9e9b93;">(</span><span style="color: #8a9a7b;">&quot;p.x: {}<span style="color: #c4746e; font-weight: bold;">\n</span>&quot;</span><span style="color: #9e9b93;">,</span> <span style="color: #9e9b93;">.</span><span style="color: #9e9b93;">{</span><span style="color: #c5c9c5;">p</span><span style="color: #9e9b93;">.</span><span style="color: #c4b28a;">x</span><span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">;</span> <span style="color: #737c73;">// 10</span>
</span><span class="athl-line" data-athl-line="515"><span style="color: #8ba4b0;">print</span><span style="color: #9e9b93;">(</span><span style="color: #8a9a7b;">&quot;p.y: {}<span style="color: #c4746e; font-weight: bold;">\n</span>&quot;</span><span style="color: #9e9b93;">,</span> <span style="color: #9e9b93;">.</span><span style="color: #9e9b93;">{</span><span style="color: #c5c9c5;">p</span><span style="color: #9e9b93;">.</span><span style="color: #c4b28a;">y</span><span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">;</span> <span style="color: #737c73;">// 30</span>
</span><span class="athl-line" data-athl-line="516">
</span><span class="athl-line" data-athl-line="517"><span style="color: #737c73;">// In C:</span>
</span><span class="athl-line" data-athl-line="518"><span style="color: #737c73;">//   1. We would have written something like: point_set(p, 10, 30).</span>
</span><span class="athl-line" data-athl-line="519"><span style="color: #737c73;">//   2. Since all functions are in the same namespace, it would have been</span>
</span><span class="athl-line" data-athl-line="520"><span style="color: #737c73;">//      very cumbersome to create functions with different names for different</span>
</span><span class="athl-line" data-athl-line="521"><span style="color: #737c73;">//      structures. Many long names, painful to read.</span>
</span><span class="athl-line" data-athl-line="522"><span style="color: #737c73;">//</span>
</span><span class="athl-line" data-athl-line="523"><span style="color: #737c73;">// In Zig, structures provide namespaces for their own functions.</span>
</span><span class="athl-line" data-athl-line="524"><span style="color: #737c73;">// Different structures can have the same names for their functions,</span>
</span><span class="athl-line" data-athl-line="525"><span style="color: #737c73;">// which brings clarity.</span>
</span><span class="athl-line" data-athl-line="526">```
</span><span class="athl-line" data-athl-line="527">
</span><span class="athl-line" data-athl-line="528">### Tuples<span style="color: #9e9b93;">.</span>
</span><span class="athl-line" data-athl-line="529">
</span><span class="athl-line" data-athl-line="530">```<span style="color: #c5c9c5;">zig</span>
</span><span class="athl-line" data-athl-line="531"><span style="color: #737c73;">// A tuple is a list of elements, possibly of different types.</span>
</span><span class="athl-line" data-athl-line="532">
</span><span class="athl-line" data-athl-line="533">const <span style="color: #c4b28a;">foo</span> <span style="color: #c4746e;">=</span> <span style="color: #9e9b93;">.</span><span style="color: #9e9b93;">{</span> <span style="color: #8a9a7b;">&quot;hello&quot;</span><span style="color: #9e9b93;">,</span> <span style="color: #b6927b; font-weight: bold;">true</span><span style="color: #9e9b93;">,</span> <span style="color: #a292a3;">42</span> <span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="534"><span style="color: #737c73;">// foo.len == 3</span>
</span><span class="athl-line" data-athl-line="535">```
</span><span class="athl-line" data-athl-line="536">
</span><span class="athl-line" data-athl-line="537">### <span style="color: #8ea4a2;">Enumerations</span><span style="color: #9e9b93;">.</span>
</span><span class="athl-line" data-athl-line="538">
</span><span class="athl-line" data-athl-line="539">```<span style="color: #c4b28a;">zig</span>
</span><span class="athl-line" data-athl-line="540">const <span style="color: #8ea4a2;">Type</span> <span style="color: #c4746e;">=</span> <span style="color: #8992a7;">enum</span> <span style="color: #9e9b93;">{</span> <span style="color: #c4b28a;">ok</span><span style="color: #9e9b93;">,</span> <span style="color: #c4b28a;">not_ok</span> <span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="541">
</span><span class="athl-line" data-athl-line="542"><span style="color: #8992a7;">const</span> <span style="color: #8ea4a2;">CardinalDirections</span> <span style="color: #c4746e;">=</span> <span style="color: #8992a7;">enum</span> <span style="color: #9e9b93;">{</span> <span style="color: #c4b28a;">North</span><span style="color: #9e9b93;">,</span> <span style="color: #c4b28a;">South</span><span style="color: #9e9b93;">,</span> <span style="color: #c4b28a;">East</span><span style="color: #9e9b93;">,</span> <span style="color: #c4b28a;">West</span> <span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="543"><span style="color: #8992a7;">const</span> <span style="color: #c5c9c5;">direction</span><span style="color: #9e9b93;">:</span> <span style="color: #8ea4a2;">CardinalDirections</span> <span style="color: #c4746e;">=</span> <span style="color: #9e9b93;">.</span><span style="color: #b6927b;">North</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="544"><span style="color: #8992a7;">const</span> <span style="color: #c5c9c5;">x</span> <span style="color: #c4746e;">=</span> <span style="color: #8992a7;">switch</span> <span style="color: #9e9b93;">(</span><span style="color: #c5c9c5;">direction</span><span style="color: #9e9b93;">)</span> <span style="color: #9e9b93;">{</span>
</span><span class="athl-line" data-athl-line="545">    <span style="color: #737c73;">// shorthand for CardinalDirections.North</span>
</span><span class="athl-line" data-athl-line="546">    <span style="color: #9e9b93;">.</span><span style="color: #b6927b;">North</span> <span style="color: #9e9b93;">=&gt;</span> <span style="color: #b6927b; font-weight: bold;">true</span><span style="color: #9e9b93;">,</span>
</span><span class="athl-line" data-athl-line="547">    <span style="color: #8992a7;">else</span> <span style="color: #9e9b93;">=&gt;</span> <span style="color: #b6927b; font-weight: bold;">false</span>
</span><span class="athl-line" data-athl-line="548"><span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="549">
</span><span class="athl-line" data-athl-line="550"><span style="color: #737c73;">// Switch statements need exhaustiveness.</span>
</span><span class="athl-line" data-athl-line="551"><span style="color: #737c73;">// WARNING: won&#39;t compile. East and West are missing.</span>
</span><span class="athl-line" data-athl-line="552"><span style="color: #8992a7;">const</span> <span style="color: #c5c9c5;">x</span> <span style="color: #c4746e;">=</span> <span style="color: #8992a7;">switch</span> <span style="color: #9e9b93;">(</span><span style="color: #c5c9c5;">direction</span><span style="color: #9e9b93;">)</span> <span style="color: #9e9b93;">{</span>
</span><span class="athl-line" data-athl-line="553">    <span style="color: #9e9b93;">.</span><span style="color: #b6927b;">North</span> <span style="color: #9e9b93;">=&gt;</span> <span style="color: #b6927b; font-weight: bold;">true</span><span style="color: #9e9b93;">,</span>
</span><span class="athl-line" data-athl-line="554">    <span style="color: #9e9b93;">.</span><span style="color: #b6927b;">South</span> <span style="color: #9e9b93;">=&gt;</span> <span style="color: #b6927b; font-weight: bold;">true</span><span style="color: #9e9b93;">,</span>
</span><span class="athl-line" data-athl-line="555"><span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="556">
</span><span class="athl-line" data-athl-line="557"><span style="color: #737c73;">// This compiles without errors, since it exhaustively lists all possible values</span>
</span><span class="athl-line" data-athl-line="558"><span style="color: #8992a7;">const</span> <span style="color: #c5c9c5;">x</span> <span style="color: #c4746e;">=</span> <span style="color: #8992a7;">switch</span> <span style="color: #9e9b93;">(</span><span style="color: #c5c9c5;">direction</span><span style="color: #9e9b93;">)</span> <span style="color: #9e9b93;">{</span>
</span><span class="athl-line" data-athl-line="559">    <span style="color: #9e9b93;">.</span><span style="color: #b6927b;">North</span> <span style="color: #9e9b93;">=&gt;</span> <span style="color: #b6927b; font-weight: bold;">true</span><span style="color: #9e9b93;">,</span>
</span><span class="athl-line" data-athl-line="560">    <span style="color: #9e9b93;">.</span><span style="color: #b6927b;">South</span> <span style="color: #9e9b93;">=&gt;</span> <span style="color: #b6927b; font-weight: bold;">true</span><span style="color: #9e9b93;">,</span>
</span><span class="athl-line" data-athl-line="561">    <span style="color: #9e9b93;">.</span><span style="color: #b6927b;">East</span><span style="color: #9e9b93;">,</span>          <span style="color: #737c73;">// Its value is the same as the following pattern: false.</span>
</span><span class="athl-line" data-athl-line="562">    <span style="color: #9e9b93;">.</span><span style="color: #b6927b;">West</span> <span style="color: #9e9b93;">=&gt;</span> <span style="color: #b6927b; font-weight: bold;">false</span><span style="color: #9e9b93;">,</span>
</span><span class="athl-line" data-athl-line="563"><span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="564">
</span><span class="athl-line" data-athl-line="565">
</span><span class="athl-line" data-athl-line="566"><span style="color: #737c73;">// Enumerations are like structures: they can have functions.</span>
</span><span class="athl-line" data-athl-line="567">```
</span><span class="athl-line" data-athl-line="568">
</span><span class="athl-line" data-athl-line="569">### <span style="color: #8ea4a2;">Unions</span><span style="color: #9e9b93;">.</span>
</span><span class="athl-line" data-athl-line="570">
</span><span class="athl-line" data-athl-line="571">```<span style="color: #c4b28a;">zig</span>
</span><span class="athl-line" data-athl-line="572">const <span style="color: #c4b28a;">Bar</span> <span style="color: #c4746e;">=</span> <span style="color: #8992a7;">union</span> <span style="color: #9e9b93;">{</span>
</span><span class="athl-line" data-athl-line="573">    <span style="color: #c4b28a;">boolean</span><span style="color: #9e9b93;">:</span> <span style="color: #949fb5;">bool</span><span style="color: #9e9b93;">,</span>
</span><span class="athl-line" data-athl-line="574">    <span style="color: #c4b28a;">int</span><span style="color: #9e9b93;">:</span> <span style="color: #949fb5;">i16</span><span style="color: #9e9b93;">,</span>
</span><span class="athl-line" data-athl-line="575">    <span style="color: #c4b28a;">float</span><span style="color: #9e9b93;">:</span> <span style="color: #949fb5;">f32</span><span style="color: #9e9b93;">,</span>
</span><span class="athl-line" data-athl-line="576"><span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="577">
</span><span class="athl-line" data-athl-line="578"><span style="color: #737c73;">// Both syntaxes are equivalent.</span>
</span><span class="athl-line" data-athl-line="579"><span style="color: #8992a7;">const</span> <span style="color: #c5c9c5;">foo</span> <span style="color: #c4746e;">=</span> <span style="color: #8ea4a2;">Bar</span><span style="color: #9e9b93;">{</span> <span style="color: #9e9b93;">.</span><span style="color: #c4b28a;">int</span> <span style="color: #c4746e;">=</span> <span style="color: #a292a3;">42</span> <span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="580"><span style="color: #8992a7;">const</span> <span style="color: #c5c9c5;">foo</span><span style="color: #9e9b93;">:</span> <span style="color: #8ea4a2;">Bar</span> <span style="color: #c4746e;">=</span> <span style="color: #9e9b93;">.</span><span style="color: #9e9b93;">{</span> <span style="color: #9e9b93;">.</span><span style="color: #c4b28a;">int</span> <span style="color: #c4746e;">=</span> <span style="color: #a292a3;">42</span> <span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="581">
</span><span class="athl-line" data-athl-line="582"><span style="color: #737c73;">// Unions, like enumerations and structures, can have functions.</span>
</span><span class="athl-line" data-athl-line="583">```
</span><span class="athl-line" data-athl-line="584">
</span><span class="athl-line" data-athl-line="585">### <span style="color: #8ea4a2;">Tagged</span> unions<span style="color: #9e9b93;">.</span>
</span><span class="athl-line" data-athl-line="586">
</span><span class="athl-line" data-athl-line="587">```<span style="color: #c4b28a;">zig</span>
</span><span class="athl-line" data-athl-line="588"><span style="color: #737c73;">// Unions can be declared with an enum tag type, allowing them to be used in</span>
</span><span class="athl-line" data-athl-line="589"><span style="color: #737c73;">// switch expressions.</span>
</span><span class="athl-line" data-athl-line="590">
</span><span class="athl-line" data-athl-line="591">const <span style="color: #c4b28a;">MaybeEnum</span> <span style="color: #c4746e;">=</span> <span style="color: #8992a7;">enum</span> <span style="color: #9e9b93;">{</span>
</span><span class="athl-line" data-athl-line="592">    <span style="color: #c4b28a;">success</span><span style="color: #9e9b93;">,</span>
</span><span class="athl-line" data-athl-line="593">    <span style="color: #c4b28a;">failure</span><span style="color: #9e9b93;">,</span>
</span><span class="athl-line" data-athl-line="594"><span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="595">
</span><span class="athl-line" data-athl-line="596"><span style="color: #8992a7;">const</span> <span style="color: #8ea4a2;">Maybe</span> <span style="color: #c4746e;">=</span> <span style="color: #8992a7;">union</span><span style="color: #9e9b93;">(</span><span style="color: #8ea4a2;">MaybeEnum</span><span style="color: #9e9b93;">)</span> <span style="color: #9e9b93;">{</span>
</span><span class="athl-line" data-athl-line="597">    <span style="color: #c4b28a;">success</span><span style="color: #9e9b93;">:</span> <span style="color: #949fb5;">u8</span><span style="color: #9e9b93;">,</span>
</span><span class="athl-line" data-athl-line="598">    <span style="color: #c4b28a;">failure</span><span style="color: #9e9b93;">:</span> <span style="color: #9e9b93;">[</span><span style="color: #9e9b93;">]</span><span style="color: #8992a7;">const</span> <span style="color: #949fb5;">u8</span><span style="color: #9e9b93;">,</span>
</span><span class="athl-line" data-athl-line="599"><span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="600">
</span><span class="athl-line" data-athl-line="601"><span style="color: #737c73;">// First value: success!</span>
</span><span class="athl-line" data-athl-line="602"><span style="color: #8992a7;">const</span> <span style="color: #c5c9c5;">yay</span> <span style="color: #c4746e;">=</span> <span style="color: #8ea4a2;">Maybe</span><span style="color: #9e9b93;">{</span> <span style="color: #9e9b93;">.</span><span style="color: #c4b28a;">success</span> <span style="color: #c4746e;">=</span> <span style="color: #a292a3;">42</span> <span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="603"><span style="color: #8992a7;">switch</span> <span style="color: #9e9b93;">(</span><span style="color: #c5c9c5;">yay</span><span style="color: #9e9b93;">)</span> <span style="color: #9e9b93;">{</span>
</span><span class="athl-line" data-athl-line="604">    <span style="color: #9e9b93;">.</span><span style="color: #b6927b;">success</span> <span style="color: #9e9b93;">=&gt;</span> <span style="color: #9e9b93;">|</span><span style="color: #a6a69c;">value</span><span style="color: #9e9b93;">|</span>     <span style="color: #c5c9c5;">std</span><span style="color: #9e9b93;">.</span><span style="color: #c4b28a;">log</span><span style="color: #9e9b93;">.</span><span style="color: #8ba4b0;">info</span><span style="color: #9e9b93;">(</span><span style="color: #8a9a7b;">&quot;success: {}&quot;</span><span style="color: #9e9b93;">,</span> <span style="color: #9e9b93;">.</span><span style="color: #9e9b93;">{</span><span style="color: #c5c9c5;">value</span><span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">,</span>
</span><span class="athl-line" data-athl-line="605">    <span style="color: #9e9b93;">.</span><span style="color: #b6927b;">failure</span> <span style="color: #9e9b93;">=&gt;</span> <span style="color: #9e9b93;">|</span><span style="color: #a6a69c;">err_msg</span><span style="color: #9e9b93;">|</span>   <span style="color: #c5c9c5;">std</span><span style="color: #9e9b93;">.</span><span style="color: #c4b28a;">log</span><span style="color: #9e9b93;">.</span><span style="color: #8ba4b0;">info</span><span style="color: #9e9b93;">(</span><span style="color: #8a9a7b;">&quot;failure: {}&quot;</span><span style="color: #9e9b93;">,</span> <span style="color: #9e9b93;">.</span><span style="color: #9e9b93;">{</span><span style="color: #c5c9c5;">err_msg</span><span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">,</span>
</span><span class="athl-line" data-athl-line="606"><span style="color: #9e9b93;">}</span>
</span><span class="athl-line" data-athl-line="607">
</span><span class="athl-line" data-athl-line="608"><span style="color: #737c73;">// Second value: failure! :(</span><span style="color: #9e9b93;"></span>
</span><span class="athl-line" data-athl-line="609"><span style="color: #8992a7;">const</span> <span style="color: #c5c9c5;">nay</span> <span style="color: #c4746e;">=</span> <span style="color: #8ea4a2;">Maybe</span><span style="color: #9e9b93;">{</span> <span style="color: #9e9b93;">.</span><span style="color: #c4b28a;">failure</span> <span style="color: #c4746e;">=</span> <span style="color: #8a9a7b;">&quot;I was too lazy&quot;</span> <span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="610"><span style="color: #8992a7;">switch</span> <span style="color: #9e9b93;">(</span><span style="color: #c5c9c5;">nay</span><span style="color: #9e9b93;">)</span> <span style="color: #9e9b93;">{</span>
</span><span class="athl-line" data-athl-line="611">    <span style="color: #9e9b93;">.</span><span style="color: #b6927b;">success</span> <span style="color: #9e9b93;">=&gt;</span> <span style="color: #9e9b93;">|</span><span style="color: #a6a69c;">value</span><span style="color: #9e9b93;">|</span>     <span style="color: #c5c9c5;">std</span><span style="color: #9e9b93;">.</span><span style="color: #c4b28a;">log</span><span style="color: #9e9b93;">.</span><span style="color: #8ba4b0;">info</span><span style="color: #9e9b93;">(</span><span style="color: #8a9a7b;">&quot;success: {}&quot;</span><span style="color: #9e9b93;">,</span> <span style="color: #9e9b93;">.</span><span style="color: #9e9b93;">{</span><span style="color: #c5c9c5;">value</span><span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">,</span>
</span><span class="athl-line" data-athl-line="612">    <span style="color: #9e9b93;">.</span><span style="color: #b6927b;">failure</span> <span style="color: #9e9b93;">=&gt;</span> <span style="color: #9e9b93;">|</span><span style="color: #a6a69c;">err_msg</span><span style="color: #9e9b93;">|</span>   <span style="color: #c5c9c5;">std</span><span style="color: #9e9b93;">.</span><span style="color: #c4b28a;">log</span><span style="color: #9e9b93;">.</span><span style="color: #8ba4b0;">info</span><span style="color: #9e9b93;">(</span><span style="color: #8a9a7b;">&quot;failure: {}&quot;</span><span style="color: #9e9b93;">,</span> <span style="color: #9e9b93;">.</span><span style="color: #9e9b93;">{</span><span style="color: #c5c9c5;">err_msg</span><span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">,</span>
</span><span class="athl-line" data-athl-line="613"><span style="color: #9e9b93;">}</span>
</span><span class="athl-line" data-athl-line="614">```
</span><span class="athl-line" data-athl-line="615">
</span><span class="athl-line" data-athl-line="616">### Defer <span style="color: #c4746e; font-weight: bold;">and</span> <span style="color: #c5c9c5;">errdefer</span><span style="color: #9e9b93;">.</span>
</span><span class="athl-line" data-athl-line="617">
</span><span class="athl-line" data-athl-line="618">```<span style="color: #8ba4b0;">zig</span>
</span><span class="athl-line" data-athl-line="619"><span style="color: #737c73;">// Make sure that an action (single instruction or block of code) is executed</span>
</span><span class="athl-line" data-athl-line="620"><span style="color: #737c73;">// before the end of the scope (function, block of code).</span>
</span><span class="athl-line" data-athl-line="621"><span style="color: #737c73;">// Even on error, that action will be executed.</span>
</span><span class="athl-line" data-athl-line="622"><span style="color: #737c73;">// Useful for memory allocations, and resource management in general.</span>
</span><span class="athl-line" data-athl-line="623">
</span><span class="athl-line" data-athl-line="624">pub <span style="color: #8992a7;">fn</span> main<span style="color: #9e9b93;">(</span><span style="color: #9e9b93;">)</span> void <span style="color: #9e9b93;">{</span>
</span><span class="athl-line" data-athl-line="625">    <span style="color: #737c73;">// Should be executed at the end of the function.</span>
</span><span class="athl-line" data-athl-line="626">    <span style="color: #8ba4b0;">defer</span> print<span style="color: #9e9b93;">(</span><span style="color: #8a9a7b;">&quot;third!<span style="color: #c4746e; font-weight: bold;">\n</span>&quot;</span><span style="color: #9e9b93;">,</span> <span style="color: #9e9b93;">.</span><span style="color: #9e9b93;">{</span><span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="627">
</span><span class="athl-line" data-athl-line="628">    <span style="color: #9e9b93;">{</span>
</span><span class="athl-line" data-athl-line="629">        <span style="color: #737c73;">// Last element of its scope: will be executed right away.</span>
</span><span class="athl-line" data-athl-line="630">        <span style="color: #8992a7;">defer</span> <span style="color: #8ba4b0;">print</span><span style="color: #9e9b93;">(</span><span style="color: #8a9a7b;">&quot;first!<span style="color: #c4746e; font-weight: bold;">\n</span>&quot;</span><span style="color: #9e9b93;">,</span> <span style="color: #9e9b93;">.</span><span style="color: #9e9b93;">{</span><span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="631">    <span style="color: #9e9b93;">}</span>
</span><span class="athl-line" data-athl-line="632">
</span><span class="athl-line" data-athl-line="633">    <span style="color: #8ba4b0;">print</span><span style="color: #9e9b93;">(</span><span style="color: #8a9a7b;">&quot;second!<span style="color: #c4746e; font-weight: bold;">\n</span>&quot;</span><span style="color: #9e9b93;">,</span> <span style="color: #9e9b93;">.</span><span style="color: #9e9b93;">{</span><span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="634"><span style="color: #9e9b93;">}</span>
</span><span class="athl-line" data-athl-line="635">
</span><span class="athl-line" data-athl-line="636">fn hello_world<span style="color: #9e9b93;">(</span><span style="color: #9e9b93;">)</span> void <span style="color: #9e9b93;">{</span>
</span><span class="athl-line" data-athl-line="637">    <span style="color: #8ba4b0;">defer</span> print<span style="color: #9e9b93;">(</span><span style="color: #8a9a7b;">&quot;end of function<span style="color: #c4746e; font-weight: bold;">\n</span>&quot;</span><span style="color: #9e9b93;">,</span> <span style="color: #9e9b93;">.</span><span style="color: #9e9b93;">{</span><span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">;</span> <span style="color: #737c73;">// after &quot;hello world!&quot;</span>
</span><span class="athl-line" data-athl-line="638">
</span><span class="athl-line" data-athl-line="639">    <span style="color: #8ba4b0;">print</span><span style="color: #9e9b93;">(</span><span style="color: #8a9a7b;">&quot;hello world!<span style="color: #c4746e; font-weight: bold;">\n</span>&quot;</span><span style="color: #9e9b93;">,</span> <span style="color: #9e9b93;">.</span><span style="color: #9e9b93;">{</span><span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="640"><span style="color: #9e9b93;">}</span>
</span><span class="athl-line" data-athl-line="641">
</span><span class="athl-line" data-athl-line="642"><span style="color: #737c73;">// errdefer executes the instruction (or block of code) only on error.</span>
</span><span class="athl-line" data-athl-line="643">fn second_hello_world<span style="color: #9e9b93;">(</span><span style="color: #9e9b93;">)</span> <span style="color: #c4746e;">!</span><span style="color: #949fb5;">void</span> <span style="color: #9e9b93;">{</span>
</span><span class="athl-line" data-athl-line="644">    <span style="color: #8ba4b0;">errdefer</span> print<span style="color: #9e9b93;">(</span><span style="color: #8a9a7b;">&quot;2. something went wrong!<span style="color: #c4746e; font-weight: bold;">\n</span>&quot;</span><span style="color: #9e9b93;">,</span> <span style="color: #9e9b93;">.</span><span style="color: #9e9b93;">{</span><span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">;</span> <span style="color: #737c73;">// if &quot;foo&quot; fails.</span>
</span><span class="athl-line" data-athl-line="645">    <span style="color: #8992a7;">defer</span>    print<span style="color: #9e9b93;">(</span><span style="color: #8a9a7b;">&quot;1. second hello world<span style="color: #c4746e; font-weight: bold;">\n</span>&quot;</span><span style="color: #9e9b93;">,</span> <span style="color: #9e9b93;">.</span><span style="color: #9e9b93;">{</span><span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">;</span>    <span style="color: #737c73;">// executed after &quot;foo&quot;</span>
</span><span class="athl-line" data-athl-line="646">
</span><span class="athl-line" data-athl-line="647">    <span style="color: #c4746e; font-weight: bold;">try</span> <span style="color: #8ba4b0;">foo</span><span style="color: #9e9b93;">(</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="648"><span style="color: #9e9b93;">}</span>
</span><span class="athl-line" data-athl-line="649"><span style="color: #737c73;">// Defer statements can be seen as stacked: first one is executed last.</span>
</span><span class="athl-line" data-athl-line="650">```
</span><span class="athl-line" data-athl-line="651">
</span><span class="athl-line" data-athl-line="652">### Memory allocators<span style="color: #9e9b93;">.</span>
</span><span class="athl-line" data-athl-line="653"><span style="color: #c4b28a;">Memory</span> isn&#39;t managed directly in the standard library<span style="color: #9e9b93;">,</span> instead an &quot;allocator&quot; is asked every time an operation on memory is required<span style="color: #9e9b93;">.</span>
</span><span class="athl-line" data-athl-line="654"><span style="color: #c4b28a;">Thus</span><span style="color: #9e9b93;">,</span> the standard library lets developers handle memory as they need<span style="color: #9e9b93;">,</span> through structures called &quot;allocators&quot;<span style="color: #9e9b93;">,</span> handling all memory operations<span style="color: #9e9b93;">.</span>
</span><span class="athl-line" data-athl-line="655">
</span><span class="athl-line" data-athl-line="656"><span style="color: #c4746e;">**</span><span style="color: #c4b28a;">NOTE</span><span style="color: #c4746e;">**</span><span style="color: #9e9b93;">:</span> <span style="color: #c5c9c5;">the</span> choice <span style="color: #c5c9c5;">of</span> the <span style="color: #c5c9c5;">allocator</span> isn&#39;t in <span style="color: #c5c9c5;">the</span> scope <span style="color: #c5c9c5;">of</span> this <span style="color: #c5c9c5;">document</span><span style="color: #9e9b93;">.</span>
</span><span class="athl-line" data-athl-line="657"><span style="color: #c4b28a;">A</span> whole <span style="color: #c5c9c5;">book</span> could <span style="color: #c5c9c5;">be</span> written <span style="color: #c5c9c5;">about</span> <span style="color: #c5c9c5;">it</span><span style="color: #9e9b93;">.</span>
</span><span class="athl-line" data-athl-line="658"><span style="color: #c4b28a;">However</span><span style="color: #9e9b93;">,</span> here are some examples<span style="color: #9e9b93;">,</span> to get an idea of what you can expect<span style="color: #9e9b93;">:</span>
</span><span class="athl-line" data-athl-line="659">
</span><span class="athl-line" data-athl-line="660"><span style="color: #c4746e;">-</span> `<span style="color: #c5c9c5;">page_allocator</span>`<span style="color: #9e9b93;">.</span>
</span><span class="athl-line" data-athl-line="661">  <span style="color: #c4b28a;">Allocate</span> a <span style="color: #c5c9c5;">whole</span> page <span style="color: #c5c9c5;">of</span> memory <span style="color: #c5c9c5;">each</span> time <span style="color: #c5c9c5;">we</span> ask <span style="color: #8992a7;">for</span> some <span style="color: #c5c9c5;">memory</span><span style="color: #9e9b93;">.</span>
</span><span class="athl-line" data-athl-line="662">  <span style="color: #c4b28a;">Very</span> simple<span style="color: #9e9b93;">,</span> <span style="color: #c5c9c5;">very</span> dumb<span style="color: #9e9b93;">,</span> <span style="color: #c5c9c5;">very</span> <span style="color: #c5c9c5;">wasteful</span><span style="color: #9e9b93;">.</span>
</span><span class="athl-line" data-athl-line="663"><span style="color: #c4746e;">-</span> `<span style="color: #8ea4a2;">GeneralPurposeAllocator</span>`<span style="color: #9e9b93;">.</span>
</span><span class="athl-line" data-athl-line="664">  <span style="color: #c4b28a;">Get</span> some <span style="color: #c5c9c5;">memory</span> <span style="color: #c5c9c5;">first</span> <span style="color: #c4746e; font-weight: bold;">and</span> <span style="color: #c5c9c5;">manage</span> some buckets of memory in order to
</span><span class="athl-line" data-athl-line="665">  reduce the number of allocations<span style="color: #9e9b93;">.</span>
</span><span class="athl-line" data-athl-line="666">  <span style="color: #c4b28a;">A</span> bit complex<span style="color: #9e9b93;">.</span> <span style="color: #c4b28a;">Can</span> be combined with other allocators<span style="color: #9e9b93;">.</span>
</span><span class="athl-line" data-athl-line="667">  <span style="color: #c4b28a;">Can</span> detect leaks <span style="color: #c4746e; font-weight: bold;">and</span> <span style="color: #c5c9c5;">provide</span> useful information to find them<span style="color: #9e9b93;">.</span><span style="color: #c4b28a;"></span>
</span><span class="athl-line" data-athl-line="668"><span style="color: #c4746e;">-</span> `<span style="color: #8ea4a2;">FixedBufferAllocator</span>`<span style="color: #9e9b93;">.</span>
</span><span class="athl-line" data-athl-line="669">  <span style="color: #c4b28a;">Use</span> a <span style="color: #c5c9c5;">fixed</span> buffer <span style="color: #c5c9c5;">to</span> get <span style="color: #c5c9c5;">its</span> memory<span style="color: #9e9b93;">,</span> <span style="color: #c5c9c5;">don</span>&#39;t ask <span style="color: #c5c9c5;">memory</span> to <span style="color: #c5c9c5;">the</span> <span style="color: #c5c9c5;">kernel</span><span style="color: #9e9b93;">.</span>
</span><span class="athl-line" data-athl-line="670">  <span style="color: #c4b28a;">Very</span> simple<span style="color: #9e9b93;">,</span> <span style="color: #c5c9c5;">limited</span> <span style="color: #c4746e; font-weight: bold;">and</span> <span style="color: #8ba4b0;">wasteful</span> <span style="color: #9e9b93;">(</span><span style="color: #c5c9c5;">can</span>&#39;t deallocate<span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">,</span> but very fast<span style="color: #9e9b93;">.</span><span style="color: #c4b28a;"></span>
</span><span class="athl-line" data-athl-line="671"><span style="color: #c4746e;">-</span> `<span style="color: #8ea4a2;">ArenaAllocator</span>`<span style="color: #9e9b93;">.</span>
</span><span class="athl-line" data-athl-line="672">  <span style="color: #c4b28a;">Allow</span> to <span style="color: #c5c9c5;">free</span> all <span style="color: #c5c9c5;">allocated</span> memory <span style="color: #c5c9c5;">at</span> <span style="color: #c5c9c5;">once</span><span style="color: #9e9b93;">.</span>
</span><span class="athl-line" data-athl-line="673">  <span style="color: #c4b28a;">To</span> use <span style="color: #c5c9c5;">in</span> combinations <span style="color: #c5c9c5;">with</span> another <span style="color: #c5c9c5;">allocator</span><span style="color: #9e9b93;">.</span>
</span><span class="athl-line" data-athl-line="674">  <span style="color: #c4b28a;">Very</span> simple <span style="color: #c5c9c5;">way</span> of <span style="color: #c5c9c5;">avoiding</span> <span style="color: #c5c9c5;">leaks</span><span style="color: #9e9b93;">.</span>
</span><span class="athl-line" data-athl-line="675">
</span><span class="athl-line" data-athl-line="676"><span style="color: #c4b28a;">A</span> first <span style="color: #c5c9c5;">example</span><span style="color: #9e9b93;">.</span>
</span><span class="athl-line" data-athl-line="677">
</span><span class="athl-line" data-athl-line="678">```<span style="color: #c4b28a;">zig</span>
</span><span class="athl-line" data-athl-line="679"><span style="color: #737c73;">// &quot;!void&quot; means the function doesn&#39;t return any value except for errors.</span>
</span><span class="athl-line" data-athl-line="680"><span style="color: #737c73;">// In this case we try to allocate memory, and this may fail.</span>
</span><span class="athl-line" data-athl-line="681"><span style="color: #8992a7;">fn</span> <span style="color: #c5c9c5;">foo</span><span style="color: #9e9b93;">(</span><span style="color: #9e9b93;">)</span> <span style="color: #c4746e;">!</span><span style="color: #949fb5;">void</span> <span style="color: #9e9b93;">{</span>
</span><span class="athl-line" data-athl-line="682">    <span style="color: #737c73;">// In this example we use a page allocator.</span>
</span><span class="athl-line" data-athl-line="683">    <span style="color: #c5c9c5;">var</span> allocator <span style="color: #c4746e;">=</span> <span style="color: #c5c9c5;">std</span><span style="color: #9e9b93;">.</span><span style="color: #c4b28a;">heap</span><span style="color: #9e9b93;">.</span><span style="color: #c4b28a;">page_allocator</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="684">
</span><span class="athl-line" data-athl-line="685">    <span style="color: #737c73;">// &quot;list&quot; is an ArrayList of 8-bit unsigned integers.</span>
</span><span class="athl-line" data-athl-line="686">    <span style="color: #737c73;">// An ArrayList is a contiguous, growable list of elements in memory.</span>
</span><span class="athl-line" data-athl-line="687">    <span style="color: #8992a7;">var</span> <span style="color: #c5c9c5;">list</span> <span style="color: #c4746e;">=</span> <span style="color: #c4746e; font-weight: bold;">try</span> <span style="color: #8ba4b0;">ArrayList</span><span style="color: #9e9b93;">(</span><span style="color: #949fb5;">u8</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">.</span><span style="color: #8ba4b0;">initAllocated</span><span style="color: #9e9b93;">(</span><span style="color: #c5c9c5;">allocator</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="688">    <span style="color: #8992a7;">defer</span> <span style="color: #c5c9c5;">list</span><span style="color: #9e9b93;">.</span><span style="color: #8ba4b0;">deinit</span><span style="color: #9e9b93;">(</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">;</span> <span style="color: #737c73;">// Free the memory at the end of the scope. Can&#39;t leak.</span>
</span><span class="athl-line" data-athl-line="689">    <span style="color: #737c73;">// &quot;defer&quot; allows to express memory release right after its allocation,</span>
</span><span class="athl-line" data-athl-line="690">    <span style="color: #737c73;">// regardless of the complexity of the function (loops, conditions, etc.).</span>
</span><span class="athl-line" data-athl-line="691">
</span><span class="athl-line" data-athl-line="692">    <span style="color: #c5c9c5;">list</span><span style="color: #9e9b93;">.</span><span style="color: #8ba4b0;">add</span><span style="color: #9e9b93;">(</span><span style="color: #a292a3;">5</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">;</span> <span style="color: #737c73;">// Some memory is allocated here, with the provided allocator.</span>
</span><span class="athl-line" data-athl-line="693">
</span><span class="athl-line" data-athl-line="694">    <span style="color: #8992a7;">for</span> <span style="color: #9e9b93;">(</span><span style="color: #c5c9c5;">list</span><span style="color: #9e9b93;">.</span><span style="color: #c4b28a;">items</span><span style="color: #9e9b93;">)</span> <span style="color: #9e9b93;">|</span><span style="color: #a6a69c;">item</span><span style="color: #9e9b93;">|</span> <span style="color: #9e9b93;">{</span>
</span><span class="athl-line" data-athl-line="695">        <span style="color: #c5c9c5;">std</span><span style="color: #9e9b93;">.</span><span style="color: #c4b28a;">debug</span><span style="color: #9e9b93;">.</span><span style="color: #8ba4b0;">print</span><span style="color: #9e9b93;">(</span><span style="color: #8a9a7b;">&quot;item: {}<span style="color: #c4746e; font-weight: bold;">\n</span>&quot;</span><span style="color: #9e9b93;">,</span> <span style="color: #9e9b93;">.</span><span style="color: #9e9b93;">{</span><span style="color: #c5c9c5;">item</span><span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="696">    <span style="color: #9e9b93;">}</span>
</span><span class="athl-line" data-athl-line="697"><span style="color: #9e9b93;">}</span>
</span><span class="athl-line" data-athl-line="698">```
</span><span class="athl-line" data-athl-line="699">
</span><span class="athl-line" data-athl-line="700">### Memory allocation combined with <span style="color: #8992a7;">error</span> management <span style="color: #c4746e; font-weight: bold;">and</span> <span style="color: #c5c9c5;">defer</span><span style="color: #9e9b93;">.</span>
</span><span class="athl-line" data-athl-line="701">
</span><span class="athl-line" data-athl-line="702">```<span style="color: #8ba4b0;">zig</span>
</span><span class="athl-line" data-athl-line="703"><span style="color: #8992a7;">fn</span> some_memory_allocation_example<span style="color: #9e9b93;">(</span><span style="color: #9e9b93;">)</span> <span style="color: #c4746e;">!</span><span style="color: #949fb5;">void</span> <span style="color: #9e9b93;">{</span>
</span><span class="athl-line" data-athl-line="704">    <span style="color: #737c73;">// Memory allocation may fail, so we &quot;try&quot; to allocate the memory and</span>
</span><span class="athl-line" data-athl-line="705">    <span style="color: #737c73;">// in case there is an error, the current function returns it.</span>
</span><span class="athl-line" data-athl-line="706">    <span style="color: #c5c9c5;">var</span> buf <span style="color: #c4746e;">=</span> <span style="color: #c4746e; font-weight: bold;">try</span> <span style="color: #c5c9c5;">page_allocator</span><span style="color: #9e9b93;">.</span><span style="color: #8ba4b0;">alloc</span><span style="color: #9e9b93;">(</span><span style="color: #949fb5;">u8</span><span style="color: #9e9b93;">,</span> <span style="color: #a292a3;">10</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="707">    <span style="color: #737c73;">// Defer memory release right after the allocation.</span>
</span><span class="athl-line" data-athl-line="708">    <span style="color: #737c73;">// Will happen even if an error occurs.</span>
</span><span class="athl-line" data-athl-line="709">    <span style="color: #8992a7;">defer</span> page_allocator<span style="color: #9e9b93;">.</span><span style="color: #8ba4b0;">free</span><span style="color: #9e9b93;">(</span><span style="color: #c5c9c5;">buf</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="710">
</span><span class="athl-line" data-athl-line="711">    <span style="color: #737c73;">// Second allocation.</span>
</span><span class="athl-line" data-athl-line="712">    <span style="color: #737c73;">// In case of a failure, the first allocation is correctly released.</span>
</span><span class="athl-line" data-athl-line="713">    <span style="color: #8992a7;">var</span> buf2 <span style="color: #c4746e;">=</span> <span style="color: #c4746e; font-weight: bold;">try</span> <span style="color: #c5c9c5;">page_allocator</span><span style="color: #9e9b93;">.</span><span style="color: #8ba4b0;">alloc</span><span style="color: #9e9b93;">(</span><span style="color: #949fb5;">u8</span><span style="color: #9e9b93;">,</span> <span style="color: #a292a3;">10</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="714">    <span style="color: #8992a7;">defer</span> page_allocator<span style="color: #9e9b93;">.</span><span style="color: #8ba4b0;">free</span><span style="color: #9e9b93;">(</span><span style="color: #c5c9c5;">buf2</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="715">
</span><span class="athl-line" data-athl-line="716">    <span style="color: #737c73;">// In case of failure, both previous allocations are correctly deallocated.</span>
</span><span class="athl-line" data-athl-line="717">    <span style="color: #c4746e; font-weight: bold;">try</span> foo<span style="color: #9e9b93;">(</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="718">    <span style="color: #c4746e; font-weight: bold;">try</span> bar<span style="color: #9e9b93;">(</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="719">
</span><span class="athl-line" data-athl-line="720">    <span style="color: #737c73;">// ...</span>
</span><span class="athl-line" data-athl-line="721"><span style="color: #9e9b93;">}</span>
</span><span class="athl-line" data-athl-line="722">```
</span><span class="athl-line" data-athl-line="723">
</span><span class="athl-line" data-athl-line="724">### Memory allocators<span style="color: #9e9b93;">:</span> a taste of the standard library<span style="color: #9e9b93;">.</span>
</span><span class="athl-line" data-athl-line="725">
</span><span class="athl-line" data-athl-line="726">```<span style="color: #8ba4b0;">zig</span>
</span><span class="athl-line" data-athl-line="727"><span style="color: #737c73;">// Allocators: 4 main functions to know</span>
</span><span class="athl-line" data-athl-line="728"><span style="color: #737c73;">//   single_value = create (type)</span>
</span><span class="athl-line" data-athl-line="729"><span style="color: #737c73;">//   destroy (single_value)</span>
</span><span class="athl-line" data-athl-line="730"><span style="color: #737c73;">//   slice = alloc (type, size)</span>
</span><span class="athl-line" data-athl-line="731"><span style="color: #737c73;">//   free (slice)</span>
</span><span class="athl-line" data-athl-line="732">
</span><span class="athl-line" data-athl-line="733"><span style="color: #737c73;">// Page Allocator</span>
</span><span class="athl-line" data-athl-line="734"><span style="color: #8992a7;">fn</span> page_allocator_fn<span style="color: #9e9b93;">(</span><span style="color: #9e9b93;">)</span> <span style="color: #c4746e;">!</span><span style="color: #949fb5;">void</span> <span style="color: #9e9b93;">{</span>
</span><span class="athl-line" data-athl-line="735">    <span style="color: #c5c9c5;">var</span> slice <span style="color: #c4746e;">=</span> <span style="color: #c4746e; font-weight: bold;">try</span> <span style="color: #c5c9c5;">std</span><span style="color: #9e9b93;">.</span><span style="color: #c4b28a;">heap</span><span style="color: #9e9b93;">.</span><span style="color: #c4b28a;">page_allocator</span><span style="color: #9e9b93;">.</span><span style="color: #8ba4b0;">alloc</span><span style="color: #9e9b93;">(</span><span style="color: #949fb5;">u8</span><span style="color: #9e9b93;">,</span> <span style="color: #a292a3;">3</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="736">    <span style="color: #8992a7;">defer</span> std<span style="color: #9e9b93;">.</span><span style="color: #c4b28a;">heap</span><span style="color: #9e9b93;">.</span><span style="color: #c4b28a;">page_allocator</span><span style="color: #9e9b93;">.</span><span style="color: #8ba4b0;">free</span><span style="color: #9e9b93;">(</span><span style="color: #c5c9c5;">slice</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="737">
</span><span class="athl-line" data-athl-line="738">    <span style="color: #737c73;">// playing_with_a_slice(slice);</span>
</span><span class="athl-line" data-athl-line="739"><span style="color: #9e9b93;">}</span>
</span><span class="athl-line" data-athl-line="740">
</span><span class="athl-line" data-athl-line="741"><span style="color: #737c73;">// GeneralPurposeAllocator</span>
</span><span class="athl-line" data-athl-line="742">fn general_purpose_allocator_fn<span style="color: #9e9b93;">(</span><span style="color: #9e9b93;">)</span> <span style="color: #c4746e;">!</span><span style="color: #949fb5;">void</span> <span style="color: #9e9b93;">{</span>
</span><span class="athl-line" data-athl-line="743">    <span style="color: #737c73;">// GeneralPurposeAllocator has to be configured.</span>
</span><span class="athl-line" data-athl-line="744">    <span style="color: #737c73;">// In this case, we want to track down memory leaks.</span>
</span><span class="athl-line" data-athl-line="745">    <span style="color: #c5c9c5;">const</span> config <span style="color: #c4746e;">=</span> <span style="color: #9e9b93;">.</span><span style="color: #9e9b93;">{</span><span style="color: #9e9b93;">.</span><span style="color: #c4b28a;">safety</span> <span style="color: #c4746e;">=</span> <span style="color: #b6927b; font-weight: bold;">true</span><span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="746">    <span style="color: #8992a7;">var</span> gpa <span style="color: #c4746e;">=</span> <span style="color: #c5c9c5;">std</span><span style="color: #9e9b93;">.</span><span style="color: #c4b28a;">heap</span><span style="color: #9e9b93;">.</span><span style="color: #8ba4b0;">GeneralPurposeAllocator</span><span style="color: #9e9b93;">(</span><span style="color: #c5c9c5;">config</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">{</span><span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="747">    <span style="color: #8992a7;">defer</span> _ <span style="color: #c4746e;">=</span> <span style="color: #c5c9c5;">gpa</span><span style="color: #9e9b93;">.</span><span style="color: #8ba4b0;">deinit</span><span style="color: #9e9b93;">(</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="748">
</span><span class="athl-line" data-athl-line="749">    <span style="color: #8992a7;">const</span> allocator <span style="color: #c4746e;">=</span> <span style="color: #c5c9c5;">gpa</span><span style="color: #9e9b93;">.</span><span style="color: #8ba4b0;">allocator</span><span style="color: #9e9b93;">(</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="750">
</span><span class="athl-line" data-athl-line="751">    <span style="color: #8992a7;">var</span> slice <span style="color: #c4746e;">=</span> <span style="color: #c4746e; font-weight: bold;">try</span> <span style="color: #c5c9c5;">allocator</span><span style="color: #9e9b93;">.</span><span style="color: #8ba4b0;">alloc</span><span style="color: #9e9b93;">(</span><span style="color: #949fb5;">u8</span><span style="color: #9e9b93;">,</span> <span style="color: #a292a3;">3</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="752">    <span style="color: #8992a7;">defer</span> allocator<span style="color: #9e9b93;">.</span><span style="color: #8ba4b0;">free</span><span style="color: #9e9b93;">(</span><span style="color: #c5c9c5;">slice</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="753">
</span><span class="athl-line" data-athl-line="754">    <span style="color: #737c73;">// playing_with_a_slice(slice);</span>
</span><span class="athl-line" data-athl-line="755"><span style="color: #9e9b93;">}</span>
</span><span class="athl-line" data-athl-line="756">
</span><span class="athl-line" data-athl-line="757"><span style="color: #737c73;">// FixedBufferAllocator</span>
</span><span class="athl-line" data-athl-line="758">fn fixed_buffer_allocator_fn<span style="color: #9e9b93;">(</span><span style="color: #9e9b93;">)</span> <span style="color: #c4746e;">!</span><span style="color: #949fb5;">void</span> <span style="color: #9e9b93;">{</span>
</span><span class="athl-line" data-athl-line="759">    <span style="color: #c5c9c5;">var</span> buffer <span style="color: #c4746e;">=</span> <span style="color: #9e9b93;">[</span><span style="color: #c4746e;">_</span><span style="color: #9e9b93;">]</span><span style="color: #949fb5;">u8</span><span style="color: #9e9b93;">{</span><span style="color: #a292a3;">0</span><span style="color: #9e9b93;">}</span> <span style="color: #c4746e;">**</span> <span style="color: #a292a3;">1000</span><span style="color: #9e9b93;">;</span> <span style="color: #737c73;">// array of 1000 u8, all initialized at zero.</span>
</span><span class="athl-line" data-athl-line="760">    <span style="color: #8992a7;">var</span> fba  <span style="color: #c4746e;">=</span> <span style="color: #c5c9c5;">std</span><span style="color: #9e9b93;">.</span><span style="color: #c4b28a;">heap</span><span style="color: #9e9b93;">.</span><span style="color: #c4b28a;">FixedBufferAllocator</span><span style="color: #9e9b93;">.</span><span style="color: #8ba4b0;">init</span><span style="color: #9e9b93;">(</span><span style="color: #c5c9c5;">buffer</span><span style="color: #9e9b93;">[</span><span style="color: #a292a3;">0</span><span style="color: #c4746e;">..</span><span style="color: #9e9b93;">]</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="761">    <span style="color: #737c73;">// Side note: buffer[0..] is a way to create a slice from an array.</span>
</span><span class="athl-line" data-athl-line="762">    <span style="color: #737c73;">//            Since the function takes a slice and not an array, this makes</span>
</span><span class="athl-line" data-athl-line="763">    <span style="color: #737c73;">//            the type system happy.</span>
</span><span class="athl-line" data-athl-line="764">
</span><span class="athl-line" data-athl-line="765">    <span style="color: #8992a7;">var</span> <span style="color: #c5c9c5;">allocator</span> <span style="color: #c4746e;">=</span> <span style="color: #c5c9c5;">fba</span><span style="color: #9e9b93;">.</span><span style="color: #8ba4b0;">allocator</span><span style="color: #9e9b93;">(</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="766">
</span><span class="athl-line" data-athl-line="767">    <span style="color: #8992a7;">var</span> <span style="color: #c5c9c5;">slice</span> <span style="color: #c4746e;">=</span> <span style="color: #c4746e; font-weight: bold;">try</span> <span style="color: #c5c9c5;">allocator</span><span style="color: #9e9b93;">.</span><span style="color: #8ba4b0;">alloc</span><span style="color: #9e9b93;">(</span><span style="color: #949fb5;">u8</span><span style="color: #9e9b93;">,</span> <span style="color: #a292a3;">3</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="768">    <span style="color: #737c73;">// No need for &quot;free&quot;, memory cannot be freed with a fixed buffer allocator.</span>
</span><span class="athl-line" data-athl-line="769">    <span style="color: #737c73;">// defer allocator.free(slice);</span>
</span><span class="athl-line" data-athl-line="770">
</span><span class="athl-line" data-athl-line="771">    <span style="color: #737c73;">// playing_with_a_slice(slice);</span>
</span><span class="athl-line" data-athl-line="772"><span style="color: #9e9b93;">}</span>
</span><span class="athl-line" data-athl-line="773">
</span><span class="athl-line" data-athl-line="774"><span style="color: #737c73;">// ArenaAllocator</span>
</span><span class="athl-line" data-athl-line="775">fn arena_allocator_fn<span style="color: #9e9b93;">(</span><span style="color: #9e9b93;">)</span> <span style="color: #c4746e;">!</span><span style="color: #949fb5;">void</span> <span style="color: #9e9b93;">{</span>
</span><span class="athl-line" data-athl-line="776">    <span style="color: #737c73;">// Reminder: arena doesn&#39;t allocate memory, it uses an inner allocator.</span>
</span><span class="athl-line" data-athl-line="777">    <span style="color: #737c73;">// In this case, we combine the arena allocator with the page allocator.</span>
</span><span class="athl-line" data-athl-line="778">    <span style="color: #c5c9c5;">var</span> arena <span style="color: #c4746e;">=</span> <span style="color: #c5c9c5;">std</span><span style="color: #9e9b93;">.</span><span style="color: #c4b28a;">heap</span><span style="color: #9e9b93;">.</span><span style="color: #c4b28a;">arena_allocator</span><span style="color: #9e9b93;">.</span><span style="color: #8ba4b0;">init</span><span style="color: #9e9b93;">(</span><span style="color: #c5c9c5;">std</span><span style="color: #9e9b93;">.</span><span style="color: #c4b28a;">heap</span><span style="color: #9e9b93;">.</span><span style="color: #c4b28a;">page_allocator</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="779">    <span style="color: #8992a7;">defer</span> arena<span style="color: #9e9b93;">.</span><span style="color: #8ba4b0;">deinit</span><span style="color: #9e9b93;">(</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">;</span> <span style="color: #737c73;">// end of function = all allocations are freed.</span>
</span><span class="athl-line" data-athl-line="780">
</span><span class="athl-line" data-athl-line="781">    <span style="color: #8992a7;">var</span> allocator <span style="color: #c4746e;">=</span> <span style="color: #c5c9c5;">arena</span><span style="color: #9e9b93;">.</span><span style="color: #8ba4b0;">allocator</span><span style="color: #9e9b93;">(</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="782">
</span><span class="athl-line" data-athl-line="783">    <span style="color: #8992a7;">const</span> slice <span style="color: #c4746e;">=</span> <span style="color: #c4746e; font-weight: bold;">try</span> <span style="color: #c5c9c5;">allocator</span><span style="color: #9e9b93;">.</span><span style="color: #8ba4b0;">alloc</span><span style="color: #9e9b93;">(</span><span style="color: #949fb5;">u8</span><span style="color: #9e9b93;">,</span> <span style="color: #a292a3;">3</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="784">    <span style="color: #737c73;">// No need for &quot;free&quot;, memory will be freed anyway.</span>
</span><span class="athl-line" data-athl-line="785">
</span><span class="athl-line" data-athl-line="786">    <span style="color: #737c73;">// playing_with_a_slice(slice);</span>
</span><span class="athl-line" data-athl-line="787"><span style="color: #9e9b93;">}</span>
</span><span class="athl-line" data-athl-line="788">
</span><span class="athl-line" data-athl-line="789">
</span><span class="athl-line" data-athl-line="790"><span style="color: #737c73;">// Combining the general purpose and arena allocators. Both are very useful,</span>
</span><span class="athl-line" data-athl-line="791"><span style="color: #737c73;">// and their combinations should be in everyone&#39;s favorite cookbook.</span>
</span><span class="athl-line" data-athl-line="792">fn gpa_arena_allocator_fn<span style="color: #9e9b93;">(</span><span style="color: #9e9b93;">)</span> <span style="color: #c4746e;">!</span><span style="color: #949fb5;">void</span> <span style="color: #9e9b93;">{</span>
</span><span class="athl-line" data-athl-line="793">    <span style="color: #c5c9c5;">const</span> config <span style="color: #c4746e;">=</span> <span style="color: #9e9b93;">.</span><span style="color: #9e9b93;">{</span><span style="color: #9e9b93;">.</span><span style="color: #c4b28a;">safety</span> <span style="color: #c4746e;">=</span> <span style="color: #b6927b; font-weight: bold;">true</span><span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="794">    <span style="color: #8992a7;">var</span> gpa <span style="color: #c4746e;">=</span> <span style="color: #c5c9c5;">std</span><span style="color: #9e9b93;">.</span><span style="color: #c4b28a;">heap</span><span style="color: #9e9b93;">.</span><span style="color: #8ba4b0;">GeneralPurposeAllocator</span><span style="color: #9e9b93;">(</span><span style="color: #c5c9c5;">config</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">{</span><span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="795">    <span style="color: #8992a7;">defer</span> _ <span style="color: #c4746e;">=</span> <span style="color: #c5c9c5;">gpa</span><span style="color: #9e9b93;">.</span><span style="color: #8ba4b0;">deinit</span><span style="color: #9e9b93;">(</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="796">
</span><span class="athl-line" data-athl-line="797">    <span style="color: #8992a7;">const</span> gpa_allocator <span style="color: #c4746e;">=</span> <span style="color: #c5c9c5;">gpa</span><span style="color: #9e9b93;">.</span><span style="color: #8ba4b0;">allocator</span><span style="color: #9e9b93;">(</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="798">
</span><span class="athl-line" data-athl-line="799">    <span style="color: #8992a7;">var</span> arena <span style="color: #c4746e;">=</span> <span style="color: #c5c9c5;">arena_allocator</span><span style="color: #9e9b93;">.</span><span style="color: #8ba4b0;">init</span><span style="color: #9e9b93;">(</span><span style="color: #c5c9c5;">gpa_allocator</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="800">    <span style="color: #8992a7;">defer</span> arena<span style="color: #9e9b93;">.</span><span style="color: #8ba4b0;">deinit</span><span style="color: #9e9b93;">(</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="801">
</span><span class="athl-line" data-athl-line="802">    <span style="color: #8992a7;">const</span> allocator <span style="color: #c4746e;">=</span> <span style="color: #c5c9c5;">arena</span><span style="color: #9e9b93;">.</span><span style="color: #8ba4b0;">allocator</span><span style="color: #9e9b93;">(</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="803">
</span><span class="athl-line" data-athl-line="804">    <span style="color: #8992a7;">var</span> slice <span style="color: #c4746e;">=</span> <span style="color: #c4746e; font-weight: bold;">try</span> <span style="color: #c5c9c5;">allocator</span><span style="color: #9e9b93;">.</span><span style="color: #8ba4b0;">alloc</span><span style="color: #9e9b93;">(</span><span style="color: #949fb5;">u8</span><span style="color: #9e9b93;">,</span> <span style="color: #a292a3;">3</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="805">    <span style="color: #8992a7;">defer</span> allocator<span style="color: #9e9b93;">.</span><span style="color: #8ba4b0;">free</span><span style="color: #9e9b93;">(</span><span style="color: #c5c9c5;">slice</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="806">
</span><span class="athl-line" data-athl-line="807">    <span style="color: #737c73;">// playing_with_a_slice(slice);</span>
</span><span class="athl-line" data-athl-line="808"><span style="color: #9e9b93;">}</span>
</span><span class="athl-line" data-athl-line="809">```
</span><span class="athl-line" data-athl-line="810">
</span><span class="athl-line" data-athl-line="811">### Comptime<span style="color: #9e9b93;">.</span>
</span><span class="athl-line" data-athl-line="812">
</span><span class="athl-line" data-athl-line="813">```<span style="color: #c4b28a;">zig</span>
</span><span class="athl-line" data-athl-line="814"><span style="color: #737c73;">// Comptime is a way to avoid the pre-processor.</span>
</span><span class="athl-line" data-athl-line="815"><span style="color: #737c73;">// The idea is simple: run code at compilation.</span>
</span><span class="athl-line" data-athl-line="816">
</span><span class="athl-line" data-athl-line="817"><span style="color: #8992a7;">inline</span> <span style="color: #8992a7;">fn</span> max<span style="color: #9e9b93;">(</span><span style="color: #8992a7;">comptime</span> <span style="color: #8992a7; font-weight: bold;">T</span><span style="color: #9e9b93;">:</span> <span style="color: #949fb5;">type</span><span style="color: #9e9b93;">,</span> <span style="color: #8992a7; font-weight: bold;">a</span><span style="color: #9e9b93;">:</span> <span style="color: #8992a7; font-weight: bold;">T</span><span style="color: #9e9b93;">,</span> <span style="color: #8992a7; font-weight: bold;">b</span><span style="color: #9e9b93;">:</span> T<span style="color: #9e9b93;">)</span> T <span style="color: #9e9b93;">{</span>
</span><span class="athl-line" data-athl-line="818">    <span style="color: #c4746e;">return</span> <span style="color: #8992a7;">if</span> <span style="color: #9e9b93;">(</span><span style="color: #8992a7; font-weight: bold;">a</span> <span style="color: #c4746e;">&gt;</span> <span style="color: #8992a7; font-weight: bold;">b</span><span style="color: #9e9b93;">)</span> <span style="color: #8992a7; font-weight: bold;">a</span> <span style="color: #8992a7;">else</span> <span style="color: #8992a7; font-weight: bold;">b</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="819"><span style="color: #9e9b93;">}</span>
</span><span class="athl-line" data-athl-line="820">
</span><span class="athl-line" data-athl-line="821"><span style="color: #8992a7;">var</span> res <span style="color: #c4746e;">=</span> <span style="color: #8ba4b0;">max</span><span style="color: #9e9b93;">(</span><span style="color: #949fb5;">u64</span><span style="color: #9e9b93;">,</span> <span style="color: #a292a3;">1</span><span style="color: #9e9b93;">,</span> <span style="color: #a292a3;">2</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="822"><span style="color: #8992a7;">var</span> res <span style="color: #c4746e;">=</span> <span style="color: #8ba4b0;">max</span><span style="color: #9e9b93;">(</span><span style="color: #949fb5;">f32</span><span style="color: #9e9b93;">,</span> <span style="color: #a292a3;">10.50</span><span style="color: #9e9b93;">,</span> <span style="color: #a292a3;">32.19</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="823">
</span><span class="athl-line" data-athl-line="824">
</span><span class="athl-line" data-athl-line="825"><span style="color: #737c73;">// Comptime: creating generic structures.</span>
</span><span class="athl-line" data-athl-line="826">
</span><span class="athl-line" data-athl-line="827"><span style="color: #8992a7;">fn</span> <span style="color: #8ea4a2;">List</span><span style="color: #9e9b93;">(</span><span style="color: #8992a7;">comptime</span> <span style="color: #8992a7; font-weight: bold;">T</span><span style="color: #9e9b93;">:</span> <span style="color: #949fb5;">type</span><span style="color: #9e9b93;">)</span> <span style="color: #949fb5;">type</span> <span style="color: #9e9b93;">{</span>
</span><span class="athl-line" data-athl-line="828">    <span style="color: #c4746e;">return</span> <span style="color: #8992a7;">struct</span> <span style="color: #9e9b93;">{</span>
</span><span class="athl-line" data-athl-line="829">        <span style="color: #c4b28a;">items</span><span style="color: #9e9b93;">:</span> <span style="color: #9e9b93;">[</span><span style="color: #9e9b93;">]</span><span style="color: #8992a7; font-weight: bold;">T</span><span style="color: #9e9b93;">,</span>
</span><span class="athl-line" data-athl-line="830">
</span><span class="athl-line" data-athl-line="831">        <span style="color: #8992a7;">fn</span> <span style="color: #c5c9c5;">init</span><span style="color: #9e9b93;">(</span><span style="color: #9e9b93;">)</span>   <span style="color: #c4746e;">...</span> <span style="color: #9e9b93;">{</span> <span style="color: #c4746e;">...</span> <span style="color: #9e9b93;">}</span>
</span><span class="athl-line" data-athl-line="832">        <span style="color: #8992a7;">fn</span> <span style="color: #c5c9c5;">deinit</span><span style="color: #9e9b93;">(</span><span style="color: #9e9b93;">)</span> <span style="color: #c4746e;">..</span><span style="color: #9e9b93;">.</span> <span style="color: #9e9b93;">{</span> <span style="color: #c4746e;">...</span> <span style="color: #9e9b93;">}</span>
</span><span class="athl-line" data-athl-line="833">        fn do<span style="color: #9e9b93;">(</span><span style="color: #9e9b93;">)</span>     <span style="color: #c4746e;">..</span><span style="color: #9e9b93;">.</span> <span style="color: #9e9b93;">{</span> <span style="color: #c4746e;">...</span> <span style="color: #9e9b93;">}</span>
</span><span class="athl-line" data-athl-line="834">    <span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="835"><span style="color: #9e9b93;">}</span>
</span><span class="athl-line" data-athl-line="836">
</span><span class="athl-line" data-athl-line="837">const MyList <span style="color: #c4746e;">=</span> <span style="color: #8ba4b0;">List</span><span style="color: #9e9b93;">(</span><span style="color: #949fb5;">u8</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="838">
</span><span class="athl-line" data-athl-line="839">
</span><span class="athl-line" data-athl-line="840"><span style="color: #737c73;">// use</span>
</span><span class="athl-line" data-athl-line="841"><span style="color: #8992a7;">var</span> list <span style="color: #c4746e;">=</span> <span style="color: #8ea4a2;">MyList</span><span style="color: #9e9b93;">{</span>
</span><span class="athl-line" data-athl-line="842">    <span style="color: #9e9b93;">.</span><span style="color: #b6927b;">items</span> <span style="color: #c4746e;">=</span> <span style="color: #c4746e;">...</span> <span style="color: #737c73;">// memory allocation</span>
</span><span class="athl-line" data-athl-line="843"><span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="844">
</span><span class="athl-line" data-athl-line="845">list<span style="color: #9e9b93;">.</span><span style="color: #c4b28a;">items</span><span style="color: #9e9b93;">[</span><span style="color: #a292a3;">0</span><span style="color: #9e9b93;">]</span> <span style="color: #c4746e;">=</span> <span style="color: #a292a3;">10</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="846">```
</span><span class="athl-line" data-athl-line="847">
</span><span class="athl-line" data-athl-line="848">### Conditional compilation<span style="color: #9e9b93;">.</span>
</span><span class="athl-line" data-athl-line="849">
</span><span class="athl-line" data-athl-line="850">```<span style="color: #c4b28a;">zig</span>
</span><span class="athl-line" data-athl-line="851">const available_os <span style="color: #c4746e;">=</span> <span style="color: #8992a7;">enum</span> <span style="color: #9e9b93;">{</span> <span style="color: #c4b28a;">OpenBSD</span><span style="color: #9e9b93;">,</span> <span style="color: #c4b28a;">Linux</span> <span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="852"><span style="color: #8992a7;">const</span> myos <span style="color: #c4746e;">=</span> <span style="color: #c5c9c5;">available_os</span><span style="color: #9e9b93;">.</span><span style="color: #c4b28a;">OpenBSD</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="853">
</span><span class="athl-line" data-athl-line="854">
</span><span class="athl-line" data-athl-line="855"><span style="color: #737c73;">// The following switch is based on a constant value.</span>
</span><span class="athl-line" data-athl-line="856"><span style="color: #737c73;">// This means that the only possible outcome is known at compile-time.</span>
</span><span class="athl-line" data-athl-line="857"><span style="color: #737c73;">// Thus, there is no need to build the rest of the possibilities.</span>
</span><span class="athl-line" data-athl-line="858"><span style="color: #737c73;">// Similar to the &quot;#ifdef&quot; in C, but without requiring a pre-processor.</span>
</span><span class="athl-line" data-athl-line="859"><span style="color: #8992a7;">const</span> string <span style="color: #c4746e;">=</span> <span style="color: #8992a7;">switch</span> <span style="color: #9e9b93;">(</span><span style="color: #c5c9c5;">myos</span><span style="color: #9e9b93;">)</span> <span style="color: #9e9b93;">{</span>
</span><span class="athl-line" data-athl-line="860">   <span style="color: #9e9b93;">.</span><span style="color: #b6927b;">OpenBSD</span> <span style="color: #9e9b93;">=&gt;</span> <span style="color: #8a9a7b;">&quot;OpenBSD is awesome!&quot;</span><span style="color: #9e9b93;">,</span>
</span><span class="athl-line" data-athl-line="861">   <span style="color: #9e9b93;">.</span><span style="color: #b6927b;">Linux</span> <span style="color: #9e9b93;">=&gt;</span> <span style="color: #8a9a7b;">&quot;Linux rocks!&quot;</span><span style="color: #9e9b93;">,</span>
</span><span class="athl-line" data-athl-line="862"><span style="color: #9e9b93;">}</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="863">
</span><span class="athl-line" data-athl-line="864"><span style="color: #737c73;">// Also works in this case.</span>
</span><span class="athl-line" data-athl-line="865"><span style="color: #8992a7;">const</span> myprint <span style="color: #c4746e;">=</span> <span style="color: #8992a7;">switch</span><span style="color: #9e9b93;">(</span><span style="color: #c5c9c5;">myos</span><span style="color: #9e9b93;">)</span> <span style="color: #9e9b93;">{</span>
</span><span class="athl-line" data-athl-line="866">    <span style="color: #9e9b93;">.</span><span style="color: #b6927b;">OpenBSD</span> <span style="color: #9e9b93;">=&gt;</span> <span style="color: #c5c9c5;">std</span><span style="color: #9e9b93;">.</span><span style="color: #c4b28a;">debug</span><span style="color: #9e9b93;">.</span><span style="color: #c4b28a;">print</span><span style="color: #9e9b93;">,</span>
</span><span class="athl-line" data-athl-line="867">    <span style="color: #9e9b93;">.</span><span style="color: #b6927b;">Linux</span> <span style="color: #9e9b93;">=&gt;</span> <span style="color: #c5c9c5;">std</span><span style="color: #9e9b93;">.</span><span style="color: #c4b28a;">log</span><span style="color: #9e9b93;">.</span><span style="color: #c4b28a;">info</span><span style="color: #9e9b93;">,</span>
</span><span class="athl-line" data-athl-line="868"><span style="color: #9e9b93;">}</span>
</span><span class="athl-line" data-athl-line="869">```
</span><span class="athl-line" data-athl-line="870">
</span><span class="athl-line" data-athl-line="871">### Testing our functions<span style="color: #9e9b93;">.</span>
</span><span class="athl-line" data-athl-line="872">
</span><span class="athl-line" data-athl-line="873">```<span style="color: #c4b28a;">zig</span>
</span><span class="athl-line" data-athl-line="874">const std <span style="color: #c4746e;">=</span> <span style="color: #949fb5;">@import</span><span style="color: #9e9b93;">(</span><span style="color: #8a9a7b;">&quot;std&quot;</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="875"><span style="color: #8992a7;">const</span> expect <span style="color: #c4746e;">=</span> <span style="color: #c5c9c5;">std</span><span style="color: #9e9b93;">.</span><span style="color: #c4b28a;">testing</span><span style="color: #9e9b93;">.</span><span style="color: #c4b28a;">expect</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="876">
</span><span class="athl-line" data-athl-line="877"><span style="color: #737c73;">// Function to test.</span>
</span><span class="athl-line" data-athl-line="878"><span style="color: #8992a7;">pub</span> <span style="color: #8992a7;">fn</span> some_function<span style="color: #9e9b93;">(</span><span style="color: #9e9b93;">)</span> bool <span style="color: #9e9b93;">{</span>
</span><span class="athl-line" data-athl-line="879">    <span style="color: #c4746e;">return</span> <span style="color: #b6927b; font-weight: bold;">true</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="880"><span style="color: #9e9b93;">}</span>
</span><span class="athl-line" data-athl-line="881">
</span><span class="athl-line" data-athl-line="882"><span style="color: #737c73;">// This &quot;test&quot; block can be run with &quot;zig test&quot;.</span>
</span><span class="athl-line" data-athl-line="883"><span style="color: #737c73;">// It will test the function at compile-time.</span>
</span><span class="athl-line" data-athl-line="884">test &quot;returns true&quot; <span style="color: #9e9b93;">{</span>
</span><span class="athl-line" data-athl-line="885">    expect<span style="color: #9e9b93;">(</span><span style="color: #b6927b; font-weight: bold;">false</span> <span style="color: #c4746e;">==</span> <span style="color: #8ba4b0;">some_function</span><span style="color: #9e9b93;">(</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">)</span><span style="color: #9e9b93;">;</span>
</span><span class="athl-line" data-athl-line="886"><span style="color: #9e9b93;">}</span><span style="color: #c4746e;"></span>
</span></code></pre>
</body>
</html>