<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>powershell - onedark_pro_dark - Autumnus</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,300;0,400;0,700;1,300;1,400;1,700&display=swap" rel="stylesheet">
    <style>
        * {
            font-family: 'JetBrains Mono', monospace;
            line-height: 1.5;
        }
        pre {
            font-size: 15px;
            margin: 20px;
            padding: 50px;
            border-radius: 10px;
        }
    </style>
</head>
<body>
<pre class="athl" style="color: #abb2bf; background-color: #000000;"><code class="language-powershell" translate="no" tabindex="0"><span class="athl-line" data-athl-line="1"><span style="color: #7f848e;"># Single line comments start with a number symbol.</span>
</span><span class="athl-line" data-athl-line="2">
</span><span class="athl-line" data-athl-line="3"><span style="color: #7f848e;">&lt;#</span>
</span><span class="athl-line" data-athl-line="4"><span style="color: #7f848e;">  Multi-line comments</span>
</span><span class="athl-line" data-athl-line="5"><span style="color: #7f848e;">  like so</span>
</span><span class="athl-line" data-athl-line="6"><span style="color: #7f848e;">#&gt;</span>
</span><span class="athl-line" data-athl-line="7">
</span><span class="athl-line" data-athl-line="8">
</span><span class="athl-line" data-athl-line="9"><span style="color: #7f848e;">####################################################</span>
</span><span class="athl-line" data-athl-line="10"><span style="color: #7f848e;">## 1. Primitive Datatypes and Operators</span>
</span><span class="athl-line" data-athl-line="11"><span style="color: #7f848e;">####################################################</span>
</span><span class="athl-line" data-athl-line="12">
</span><span class="athl-line" data-athl-line="13"><span style="color: #7f848e;"># Numbers</span>
</span><span class="athl-line" data-athl-line="14"><span style="color: #d19a66;">3</span> <span style="color: #7f848e;"># =&gt; 3</span>
</span><span class="athl-line" data-athl-line="15">
</span><span class="athl-line" data-athl-line="16"><span style="color: #7f848e;"># Math</span>
</span><span class="athl-line" data-athl-line="17"><span style="color: #d19a66;">1</span> <span style="color: #2bbac5;">+</span> <span style="color: #d19a66;">1</span>   <span style="color: #7f848e;"># =&gt; 2</span>
</span><span class="athl-line" data-athl-line="18"><span style="color: #d19a66;">8</span> <span style="color: #2bbac5;">-</span> <span style="color: #d19a66;">1</span>   <span style="color: #7f848e;"># =&gt; 7</span>
</span><span class="athl-line" data-athl-line="19"><span style="color: #d19a66;">10</span> <span style="color: #2bbac5;">*</span> <span style="color: #d19a66;">2</span>  <span style="color: #7f848e;"># =&gt; 20</span>
</span><span class="athl-line" data-athl-line="20"><span style="color: #d19a66;">35</span> <span style="color: #2bbac5;">/</span> <span style="color: #d19a66;">5</span>  <span style="color: #7f848e;"># =&gt; 7.0</span>
</span><span class="athl-line" data-athl-line="21">
</span><span class="athl-line" data-athl-line="22"><span style="color: #7f848e;"># Powershell uses banker&#39;s rounding,</span>
</span><span class="athl-line" data-athl-line="23"><span style="color: #7f848e;"># meaning [int]1.5 would round to 2 but so would [int]2.5</span>
</span><span class="athl-line" data-athl-line="24"><span style="color: #7f848e;"># Division always returns a float. </span>
</span><span class="athl-line" data-athl-line="25"><span style="color: #7f848e;"># You must cast result to [int] to round.</span>
</span><span class="athl-line" data-athl-line="26"><span style="color: #d55fde;">[</span><span style="color: #e5c07b;">int</span><span style="color: #d55fde;">]</span><span style="color: #d19a66;">5</span> <span style="color: #2bbac5;">/</span> <span style="color: #d55fde;">[</span><span style="color: #e5c07b;">int</span><span style="color: #d55fde;">]</span><span style="color: #d19a66;">3</span>       <span style="color: #7f848e;"># =&gt; 1.66666666666667</span>
</span><span class="athl-line" data-athl-line="27"><span style="color: #d55fde;">[</span><span style="color: #e5c07b;">int</span><span style="color: #d55fde;">]</span><span style="color: #2bbac5;">-</span><span style="color: #d19a66;">5</span> <span style="color: #2bbac5;">/</span> <span style="color: #d55fde;">[</span><span style="color: #e5c07b;">int</span><span style="color: #d55fde;">]</span><span style="color: #d19a66;">3</span>      <span style="color: #7f848e;"># =&gt; -1.66666666666667</span>
</span><span class="athl-line" data-athl-line="28"><span style="color: #d19a66;">5.0</span> <span style="color: #2bbac5;">/</span> <span style="color: #d19a66;">3.0</span>   <span style="color: #7f848e;"># =&gt; 1.66666666666667</span>
</span><span class="athl-line" data-athl-line="29"><span style="color: #2bbac5;">-</span><span style="color: #d19a66;">5.0</span> <span style="color: #2bbac5;">/</span> <span style="color: #d19a66;">3.0</span>  <span style="color: #7f848e;"># =&gt; -1.66666666666667</span>
</span><span class="athl-line" data-athl-line="30"><span style="color: #d55fde;">[</span><span style="color: #e5c07b;">int</span><span style="color: #d55fde;">]</span><span style="color: #ef596f;">$result</span> <span style="color: #2bbac5;"><span style="color: #2bbac5;">=</span></span> <span style="color: #d19a66;">5</span> <span style="color: #2bbac5;">/</span> <span style="color: #d19a66;">3</span> 
</span><span class="athl-line" data-athl-line="31"><span style="color: #ef596f;">$result</span> <span style="color: #7f848e;"># =&gt; 2</span>
</span><span class="athl-line" data-athl-line="32">
</span><span class="athl-line" data-athl-line="33"><span style="color: #7f848e;"># Modulo operation</span>
</span><span class="athl-line" data-athl-line="34"><span style="color: #d19a66;">7</span> <span style="color: #2bbac5;">%</span> <span style="color: #d19a66;">3</span>  <span style="color: #7f848e;"># =&gt; 1</span>
</span><span class="athl-line" data-athl-line="35">
</span><span class="athl-line" data-athl-line="36"><span style="color: #7f848e;"># Exponentiation requires longform or the built-in [Math] class.</span>
</span><span class="athl-line" data-athl-line="37"><span style="color: #d55fde;">[</span><span style="color: #e5c07b;">Math</span><span style="color: #d55fde;">]</span><span style="color: #abb2bf;">::</span><span style="color: #61afef;">Pow</span><span style="color: #d55fde;">(</span><span style="color: #d19a66;">2</span><span style="color: #abb2bf;">,</span><span style="color: #d19a66;">3</span><span style="color: #d55fde;">)</span>  <span style="color: #7f848e;"># =&gt; 8</span>
</span><span class="athl-line" data-athl-line="38">
</span><span class="athl-line" data-athl-line="39"><span style="color: #7f848e;"># Enforce order of operations with parentheses.</span>
</span><span class="athl-line" data-athl-line="40"><span style="color: #d19a66;">1</span> <span style="color: #2bbac5;">+</span> <span style="color: #d19a66;">3</span> <span style="color: #2bbac5;">*</span> <span style="color: #d19a66;">2</span>  <span style="color: #7f848e;"># =&gt; 7</span>
</span><span class="athl-line" data-athl-line="41"><span style="color: #d55fde;">(</span><span style="color: #d19a66;">1</span> <span style="color: #2bbac5;">+</span> <span style="color: #d19a66;">3</span><span style="color: #d55fde;">)</span> <span style="color: #2bbac5;">*</span> <span style="color: #d19a66;">2</span>  <span style="color: #7f848e;"># =&gt; 8</span>
</span><span class="athl-line" data-athl-line="42">
</span><span class="athl-line" data-athl-line="43"><span style="color: #7f848e;"># Boolean values are primitives (Note: the $)</span>
</span><span class="athl-line" data-athl-line="44"><span style="color: #ef596f;">$True</span>  <span style="color: #7f848e;"># =&gt; True</span>
</span><span class="athl-line" data-athl-line="45"><span style="color: #ef596f;">$False</span>  <span style="color: #7f848e;"># =&gt; False</span>
</span><span class="athl-line" data-athl-line="46">
</span><span class="athl-line" data-athl-line="47"><span style="color: #7f848e;"># negate with !</span>
</span><span class="athl-line" data-athl-line="48"><span style="color: #2bbac5;">!</span><span style="color: #ef596f;">$True</span>   <span style="color: #7f848e;"># =&gt; False</span>
</span><span class="athl-line" data-athl-line="49"><span style="color: #2bbac5;">!</span><span style="color: #ef596f;">$False</span>  <span style="color: #7f848e;"># =&gt; True</span>
</span><span class="athl-line" data-athl-line="50">
</span><span class="athl-line" data-athl-line="51"><span style="color: #7f848e;"># Boolean Operators</span>
</span><span class="athl-line" data-athl-line="52"><span style="color: #7f848e;"># Note &quot;-and&quot; and &quot;-or&quot; usage</span>
</span><span class="athl-line" data-athl-line="53"><span style="color: #ef596f;">$True</span> <span style="color: #2bbac5;">-and</span> <span style="color: #ef596f;">$False</span>  <span style="color: #7f848e;"># =&gt; False</span>
</span><span class="athl-line" data-athl-line="54"><span style="color: #ef596f;">$False</span> <span style="color: #2bbac5;">-or</span> <span style="color: #ef596f;">$True</span>   <span style="color: #7f848e;"># =&gt; True</span>
</span><span class="athl-line" data-athl-line="55">
</span><span class="athl-line" data-athl-line="56"><span style="color: #7f848e;"># True and False are actually 1 and 0 but only support limited arithmetic.</span>
</span><span class="athl-line" data-athl-line="57"><span style="color: #7f848e;"># However, casting the bool to int resolves this.</span>
</span><span class="athl-line" data-athl-line="58"><span style="color: #ef596f;">$True</span> <span style="color: #2bbac5;">+</span> <span style="color: #ef596f;">$True</span> <span style="color: #7f848e;"># =&gt; 2</span>
</span><span class="athl-line" data-athl-line="59"><span style="color: #ef596f;">$True</span> <span style="color: #2bbac5;">*</span> <span style="color: #d19a66;">8</span>    <span style="color: #7f848e;"># =&gt; &#39;[System.Boolean] * [System.Int32]&#39; is undefined</span>
</span><span class="athl-line" data-athl-line="60"><span style="color: #d55fde;">[</span><span style="color: #e5c07b;">int</span><span style="color: #d55fde;">]</span><span style="color: #ef596f;">$True</span> <span style="color: #2bbac5;">*</span> <span style="color: #d19a66;">8</span> <span style="color: #7f848e;"># =&gt; 8</span>
</span><span class="athl-line" data-athl-line="61"><span style="color: #ef596f;">$False</span> <span style="color: #2bbac5;">-</span> <span style="color: #d19a66;">5</span>   <span style="color: #7f848e;"># =&gt; -5</span>
</span><span class="athl-line" data-athl-line="62">
</span><span class="athl-line" data-athl-line="63"><span style="color: #7f848e;"># Comparison operators look at the numerical value of True and False.</span>
</span><span class="athl-line" data-athl-line="64"><span style="color: #d19a66;">0</span> <span style="color: #2bbac5;">-eq</span> <span style="color: #ef596f;">$False</span>  <span style="color: #7f848e;"># =&gt; True</span>
</span><span class="athl-line" data-athl-line="65"><span style="color: #d19a66;">1</span> <span style="color: #2bbac5;">-eq</span> <span style="color: #ef596f;">$True</span>   <span style="color: #7f848e;"># =&gt; True</span>
</span><span class="athl-line" data-athl-line="66"><span style="color: #d19a66;">2</span> <span style="color: #2bbac5;">-eq</span> <span style="color: #ef596f;">$True</span>   <span style="color: #7f848e;"># =&gt; False</span>
</span><span class="athl-line" data-athl-line="67"><span style="color: #2bbac5;">-</span><span style="color: #d19a66;">5</span> <span style="color: #2bbac5;">-ne</span> <span style="color: #ef596f;">$False</span> <span style="color: #7f848e;"># =&gt; True</span>
</span><span class="athl-line" data-athl-line="68">
</span><span class="athl-line" data-athl-line="69"><span style="color: #7f848e;"># Using boolean logical operators on ints casts to booleans for evaluation.</span>
</span><span class="athl-line" data-athl-line="70"><span style="color: #7f848e;"># but their non-cast value is returned</span>
</span><span class="athl-line" data-athl-line="71"><span style="color: #7f848e;"># Don&#39;t mix up with bool(ints) and bitwise -band/-bor</span>
</span><span class="athl-line" data-athl-line="72"><span style="color: #d55fde;">[</span><span style="color: #e5c07b;">bool</span><span style="color: #d55fde;">]</span><span style="color: #d55fde;">(</span><span style="color: #d19a66;">0</span><span style="color: #d55fde;">)</span>     <span style="color: #7f848e;"># =&gt; False</span>
</span><span class="athl-line" data-athl-line="73"><span style="color: #d55fde;">[</span><span style="color: #e5c07b;">bool</span><span style="color: #d55fde;">]</span><span style="color: #d55fde;">(</span><span style="color: #d19a66;">4</span><span style="color: #d55fde;">)</span>     <span style="color: #7f848e;"># =&gt; True</span>
</span><span class="athl-line" data-athl-line="74"><span style="color: #d55fde;">[</span><span style="color: #e5c07b;">bool</span><span style="color: #d55fde;">]</span><span style="color: #d55fde;">(</span><span style="color: #2bbac5;">-</span><span style="color: #d19a66;">6</span><span style="color: #d55fde;">)</span>    <span style="color: #7f848e;"># =&gt; True</span>
</span><span class="athl-line" data-athl-line="75"><span style="color: #d19a66;">0</span> <span style="color: #2bbac5;">-band</span> <span style="color: #d19a66;">2</span>     <span style="color: #7f848e;"># =&gt; 0</span>
</span><span class="athl-line" data-athl-line="76"><span style="color: #2bbac5;">-</span><span style="color: #d19a66;">5</span> <span style="color: #2bbac5;">-bor</span> <span style="color: #d19a66;">0</span>     <span style="color: #7f848e;"># =&gt; -5</span>
</span><span class="athl-line" data-athl-line="77">
</span><span class="athl-line" data-athl-line="78"><span style="color: #7f848e;"># Equality is -eq (equals)</span>
</span><span class="athl-line" data-athl-line="79"><span style="color: #d19a66;">1</span> <span style="color: #2bbac5;">-eq</span> <span style="color: #d19a66;">1</span>  <span style="color: #7f848e;"># =&gt; True</span>
</span><span class="athl-line" data-athl-line="80"><span style="color: #d19a66;">2</span> <span style="color: #2bbac5;">-eq</span> <span style="color: #d19a66;">1</span>  <span style="color: #7f848e;"># =&gt; False</span>
</span><span class="athl-line" data-athl-line="81">
</span><span class="athl-line" data-athl-line="82"><span style="color: #7f848e;"># Inequality is -ne (notequals)</span>
</span><span class="athl-line" data-athl-line="83"><span style="color: #d19a66;">1</span> <span style="color: #2bbac5;">-ne</span> <span style="color: #d19a66;">1</span>  <span style="color: #7f848e;"># =&gt; False</span>
</span><span class="athl-line" data-athl-line="84"><span style="color: #d19a66;">2</span> <span style="color: #2bbac5;">-ne</span> <span style="color: #d19a66;">1</span>  <span style="color: #7f848e;"># =&gt; True</span>
</span><span class="athl-line" data-athl-line="85">
</span><span class="athl-line" data-athl-line="86"><span style="color: #7f848e;"># More comparisons</span>
</span><span class="athl-line" data-athl-line="87"><span style="color: #d19a66;">1</span> <span style="color: #2bbac5;">-lt</span> <span style="color: #d19a66;">10</span>  <span style="color: #7f848e;"># =&gt; True</span>
</span><span class="athl-line" data-athl-line="88"><span style="color: #d19a66;">1</span> <span style="color: #2bbac5;">-gt</span> <span style="color: #d19a66;">10</span>  <span style="color: #7f848e;"># =&gt; False</span>
</span><span class="athl-line" data-athl-line="89"><span style="color: #d19a66;">2</span> <span style="color: #2bbac5;">-le</span> <span style="color: #d19a66;">2</span>  <span style="color: #7f848e;"># =&gt; True</span>
</span><span class="athl-line" data-athl-line="90"><span style="color: #d19a66;">2</span> <span style="color: #2bbac5;">-ge</span> <span style="color: #d19a66;">2</span>  <span style="color: #7f848e;"># =&gt; True</span>
</span><span class="athl-line" data-athl-line="91">
</span><span class="athl-line" data-athl-line="92"><span style="color: #7f848e;"># Seeing whether a value is in a range</span>
</span><span class="athl-line" data-athl-line="93"><span style="color: #d19a66;">1</span> <span style="color: #2bbac5;">-lt</span> <span style="color: #d19a66;">2</span> <span style="color: #2bbac5;">-and</span> <span style="color: #d19a66;">2</span> <span style="color: #2bbac5;">-lt</span> <span style="color: #d19a66;">3</span>  <span style="color: #7f848e;"># =&gt; True</span>
</span><span class="athl-line" data-athl-line="94"><span style="color: #d19a66;">2</span> <span style="color: #2bbac5;">-lt</span> <span style="color: #d19a66;">3</span> <span style="color: #2bbac5;">-and</span> <span style="color: #d19a66;">3</span> <span style="color: #2bbac5;">-lt</span> <span style="color: #d19a66;">2</span>  <span style="color: #7f848e;"># =&gt; False</span>
</span><span class="athl-line" data-athl-line="95">
</span><span class="athl-line" data-athl-line="96"><span style="color: #7f848e;"># (-is vs. -eq) -is checks if two objects are the same type.</span>
</span><span class="athl-line" data-athl-line="97"><span style="color: #7f848e;"># -eq checks if the objects have the same values, but sometimes doesn&#39;t work</span>
</span><span class="athl-line" data-athl-line="98"><span style="color: #7f848e;"># as expected.</span>
</span><span class="athl-line" data-athl-line="99"><span style="color: #7f848e;"># Note: we called &#39;[Math]&#39; from .NET previously without the preceeding</span>
</span><span class="athl-line" data-athl-line="100"><span style="color: #7f848e;"># namespaces. We can do the same with [Collections.ArrayList] if preferred.</span>
</span><span class="athl-line" data-athl-line="101"><span style="color: #d55fde;">[</span><span style="color: #e5c07b;">System<span style="color: #abb2bf;">.</span>Collections<span style="color: #abb2bf;">.</span>ArrayList</span><span style="color: #d55fde;">]</span><span style="color: #ef596f;">$a</span> <span style="color: #2bbac5;"><span style="color: #2bbac5;">=</span></span> <span style="color: #abb2bf;">@(</span><span style="color: #abb2bf;">)</span>  <span style="color: #7f848e;"># Point a at a new list</span>
</span><span class="athl-line" data-athl-line="102"><span style="color: #ef596f;">$a</span> <span style="color: #2bbac5;"><span style="color: #2bbac5;">=</span></span> <span style="color: #d55fde;">(</span><span style="color: #d19a66;">1</span><span style="color: #abb2bf;">,</span><span style="color: #d19a66;">2</span><span style="color: #abb2bf;">,</span><span style="color: #d19a66;">3</span><span style="color: #abb2bf;">,</span><span style="color: #d19a66;">4</span><span style="color: #d55fde;">)</span>
</span><span class="athl-line" data-athl-line="103"><span style="color: #ef596f;">$b</span> <span style="color: #2bbac5;"><span style="color: #2bbac5;">=</span></span> <span style="color: #ef596f;">$a</span>                                 <span style="color: #7f848e;"># =&gt; Point b at what a is pointing to</span>
</span><span class="athl-line" data-athl-line="104"><span style="color: #ef596f;">$b</span> <span style="color: #2bbac5;">-is</span> <span style="color: #ef596f;">$a</span><span style="color: #abb2bf;">.</span><span style="color: #61afef;">GetType</span><span style="color: #d55fde;">(</span><span style="color: #d55fde;">)</span>                     <span style="color: #7f848e;"># =&gt; True, a and b equal same type</span>
</span><span class="athl-line" data-athl-line="105"><span style="color: #ef596f;">$b</span> <span style="color: #2bbac5;">-eq</span> <span style="color: #ef596f;">$a</span>                               <span style="color: #7f848e;"># =&gt; None! See below</span>
</span><span class="athl-line" data-athl-line="106"><span style="color: #d55fde;">[</span><span style="color: #e5c07b;">System<span style="color: #abb2bf;">.</span>Collections<span style="color: #abb2bf;">.</span>Hashtable</span><span style="color: #d55fde;">]</span><span style="color: #ef596f;">$b</span> <span style="color: #2bbac5;"><span style="color: #2bbac5;">=</span></span> <span style="color: #abb2bf;">@{</span><span style="color: #abb2bf;">}</span>  <span style="color: #7f848e;"># =&gt; Point b at a new hash table</span>
</span><span class="athl-line" data-athl-line="107"><span style="color: #ef596f;">$b</span> <span style="color: #2bbac5;"><span style="color: #2bbac5;">=</span></span> <span style="color: #abb2bf;">@{</span><span style="color: #ef596f;"><span style="color: #89ca78;">&#39;one&#39;</span></span> <span style="color: #2bbac5;">=</span> <span style="color: #d19a66;">1</span> 
</span><span class="athl-line" data-athl-line="108">       <span style="color: #ef596f;"><span style="color: #89ca78;">&#39;two&#39;</span></span> <span style="color: #2bbac5;">=</span> <span style="color: #d19a66;">2</span><span style="color: #abb2bf;">}</span>
</span><span class="athl-line" data-athl-line="109"><span style="color: #ef596f;">$b</span> <span style="color: #2bbac5;">-is</span> <span style="color: #ef596f;">$a</span><span style="color: #abb2bf;">.</span><span style="color: #61afef;">GetType</span><span style="color: #d55fde;">(</span><span style="color: #d55fde;">)</span>                     <span style="color: #7f848e;"># =&gt; False, a and b types not equal</span>
</span><span class="athl-line" data-athl-line="110">
</span><span class="athl-line" data-athl-line="111"><span style="color: #7f848e;"># Strings are created with &quot; or &#39; but &quot; is required for string interpolation</span>
</span><span class="athl-line" data-athl-line="112"><span style="color: #89ca78;">&quot;This is a string.&quot;</span>
</span><span class="athl-line" data-athl-line="113"><span style="color: #89ca78;">&#39;This is also a string.&#39;</span>
</span><span class="athl-line" data-athl-line="114">
</span><span class="athl-line" data-athl-line="115"><span style="color: #7f848e;"># Strings can be added too! But try not to do this.</span>
</span><span class="athl-line" data-athl-line="116"><span style="color: #89ca78;">&quot;Hello &quot;</span> <span style="color: #2bbac5;">+</span> <span style="color: #89ca78;">&quot;world!&quot;</span>  <span style="color: #7f848e;"># =&gt; &quot;Hello world!&quot;</span>
</span><span class="athl-line" data-athl-line="117">
</span><span class="athl-line" data-athl-line="118"><span style="color: #7f848e;"># A string can be treated like a list of characters</span>
</span><span class="athl-line" data-athl-line="119"><span style="color: #89ca78;">&quot;Hello world!&quot;</span><span style="color: #d55fde;">[</span><span style="color: #d19a66;">0</span><span style="color: #d55fde;">]</span>  <span style="color: #7f848e;"># =&gt; &#39;H&#39;</span>
</span><span class="athl-line" data-athl-line="120">
</span><span class="athl-line" data-athl-line="121"><span style="color: #7f848e;"># You can find the length of a string</span>
</span><span class="athl-line" data-athl-line="122"><span style="color: #d55fde;">(</span><span style="color: #89ca78;">&quot;This is a string&quot;</span><span style="color: #d55fde;">)</span><span style="color: #abb2bf;">.</span><span style="color: #ef596f;">Length</span>  <span style="color: #7f848e;"># =&gt; 16</span>
</span><span class="athl-line" data-athl-line="123">
</span><span class="athl-line" data-athl-line="124"><span style="color: #7f848e;"># You can also format using f-strings or formatted string literals.</span>
</span><span class="athl-line" data-athl-line="125"><span style="color: #ef596f;">$name</span> <span style="color: #2bbac5;"><span style="color: #2bbac5;">=</span></span> <span style="color: #89ca78;">&quot;Steve&quot;</span>
</span><span class="athl-line" data-athl-line="126"><span style="color: #ef596f;">$age</span> <span style="color: #2bbac5;"><span style="color: #2bbac5;">=</span></span> <span style="color: #d19a66;">22</span>
</span><span class="athl-line" data-athl-line="127"><span style="color: #89ca78;">&quot;He said his name is <span style="color: #ef596f;">$name</span>.&quot;</span> 
</span><span class="athl-line" data-athl-line="128"><span style="color: #7f848e;"># =&gt; &quot;He said his name is Steve&quot;</span>
</span><span class="athl-line" data-athl-line="129"><span style="color: #89ca78;">&quot;{0} said he is {1} years old.&quot;</span> -f <span style="color: #ef596f;">$name</span><span style="color: #abb2bf;">,</span> <span style="color: #ef596f;">$age</span> 
</span><span class="athl-line" data-athl-line="130"><span style="color: #7f848e;"># =&gt; &quot;Steve said he is 22 years old&quot;</span>
</span><span class="athl-line" data-athl-line="131"><span style="color: #89ca78;">&quot;<span style="color: #ef596f;">$name</span>&#39;s name is $(<span style="color: #ef596f;">$name</span><span style="color: #abb2bf;">.</span><span style="color: #ef596f;">Length</span><span style="color: #d55fde;">)</span> characters long.&quot;</span> 
</span><span class="athl-line" data-athl-line="132"><span style="color: #7f848e;"># =&gt; &quot;Steve&#39;s name is 5 characters long.&quot;</span>
</span><span class="athl-line" data-athl-line="133">
</span><span class="athl-line" data-athl-line="134"><span style="color: #7f848e;"># Strings can be compared with -eq, but are case insensitive. We can</span>
</span><span class="athl-line" data-athl-line="135"><span style="color: #7f848e;"># force with -ceq or -ieq.</span>
</span><span class="athl-line" data-athl-line="136"><span style="color: #89ca78;">&quot;ab&quot;</span> <span style="color: #2bbac5;">-eq</span> <span style="color: #89ca78;">&quot;ab&quot;</span>  <span style="color: #7f848e;"># =&gt; True</span>
</span><span class="athl-line" data-athl-line="137"><span style="color: #89ca78;">&quot;ab&quot;</span> <span style="color: #2bbac5;">-eq</span> <span style="color: #89ca78;">&quot;AB&quot;</span>  <span style="color: #7f848e;"># =&gt; True!</span>
</span><span class="athl-line" data-athl-line="138"><span style="color: #89ca78;">&quot;ab&quot;</span> <span style="color: #2bbac5;">-ceq</span> <span style="color: #89ca78;">&quot;AB&quot;</span>  <span style="color: #7f848e;"># =&gt; False</span>
</span><span class="athl-line" data-athl-line="139"><span style="color: #89ca78;">&quot;ab&quot;</span> <span style="color: #2bbac5;">-ieq</span> <span style="color: #89ca78;">&quot;AB&quot;</span>  <span style="color: #7f848e;"># =&gt; True</span>
</span><span class="athl-line" data-athl-line="140">
</span><span class="athl-line" data-athl-line="141"><span style="color: #7f848e;"># Escape Characters in Powershell</span>
</span><span class="athl-line" data-athl-line="142"><span style="color: #7f848e;"># Many languages use the &#39;\&#39;, but Windows uses this character for </span>
</span><span class="athl-line" data-athl-line="143"><span style="color: #7f848e;"># file paths. Powershell thus uses &#39;`&#39; to escape characters</span>
</span><span class="athl-line" data-athl-line="144"><span style="color: #7f848e;"># Take caution when working with files, as &#39;`&#39; is a</span>
</span><span class="athl-line" data-athl-line="145"><span style="color: #7f848e;"># valid character in NTFS filenames.</span>
</span><span class="athl-line" data-athl-line="146"><span style="color: #89ca78;">&quot;Showing`nEscape Chars&quot;</span> <span style="color: #7f848e;"># =&gt; new line between Showing and Escape</span>
</span><span class="athl-line" data-athl-line="147"><span style="color: #89ca78;">&quot;Making`tTables`tWith`tTabs&quot;</span> <span style="color: #7f848e;"># =&gt; Format things with tabs</span>
</span><span class="athl-line" data-athl-line="148">
</span><span class="athl-line" data-athl-line="149"><span style="color: #7f848e;"># Negate pound sign to prevent comment</span>
</span><span class="athl-line" data-athl-line="150"><span style="color: #7f848e;"># Note that the function of &#39;#&#39; is removed, but &#39;#&#39; is still present</span>
</span><span class="athl-line" data-athl-line="151">`#Get<span style="color: #61afef;">-Process</span><span style="color: #7f848e;"> # =&gt; Fail: not a recognized cmdlet</span><span style="color: #7f848e;"></span>
</span><span class="athl-line" data-athl-line="152"><span style="color: #7f848e;"></span>
</span><span class="athl-line" data-athl-line="153"><span style="color: #7f848e;"># $null is not an object</span>
</span><span class="athl-line" data-athl-line="154"><span style="color: #e5c07b;">$null</span>  <span style="color: #7f848e;"># =&gt; None</span>
</span><span class="athl-line" data-athl-line="155">
</span><span class="athl-line" data-athl-line="156"><span style="color: #7f848e;"># $null, 0, and empty strings and arrays all evaluate to False.</span>
</span><span class="athl-line" data-athl-line="157"><span style="color: #7f848e;"># All other values are True</span>
</span><span class="athl-line" data-athl-line="158"><span style="color: #d55fde;">function</span> <span style="color: #61afef;">Test-Value</span> <span style="color: #d55fde;">(</span><span style="color: #ef596f;">$value</span><span style="color: #d55fde;">)</span> <span style="color: #d55fde;">{</span>
</span><span class="athl-line" data-athl-line="159">  <span style="color: #d55fde;">if</span> <span style="color: #d55fde;">(</span><span style="color: #ef596f;">$value</span><span style="color: #d55fde;">)</span> <span style="color: #d55fde;">{</span>
</span><span class="athl-line" data-athl-line="160">    <span style="color: #61afef;">Write-Output</span><span style="color: #abb2bf;"> </span><span style="color: #89ca78;">&#39;True&#39;</span>
</span><span class="athl-line" data-athl-line="161">  <span style="color: #d55fde;">}</span>
</span><span class="athl-line" data-athl-line="162">  <span style="color: #d55fde;">else</span> <span style="color: #d55fde;">{</span>
</span><span class="athl-line" data-athl-line="163">    <span style="color: #61afef;">Write-Output</span><span style="color: #abb2bf;"> </span><span style="color: #89ca78;">&#39;False&#39;</span>
</span><span class="athl-line" data-athl-line="164">  <span style="color: #d55fde;">}</span>
</span><span class="athl-line" data-athl-line="165"><span style="color: #d55fde;">}</span>
</span><span class="athl-line" data-athl-line="166">
</span><span class="athl-line" data-athl-line="167"><span style="color: #61afef;">Test-Value</span><span style="color: #abb2bf;"> </span><span style="color: #d55fde;">(</span><span style="color: #e5c07b;">$null</span><span style="color: #d55fde;">)</span><span style="color: #abb2bf;"> </span><span style="color: #7f848e;"># =&gt; False</span>
</span><span class="athl-line" data-athl-line="168"><span style="color: #61afef;">Test-Value</span><span style="color: #abb2bf;"> </span><span style="color: #d55fde;">(</span><span style="color: #d19a66;">0</span><span style="color: #d55fde;">)</span><span style="color: #abb2bf;">     </span><span style="color: #7f848e;"># =&gt; False</span>
</span><span class="athl-line" data-athl-line="169"><span style="color: #61afef;">Test-Value</span><span style="color: #abb2bf;"> </span><span style="color: #d55fde;">(</span><span style="color: #89ca78;">&quot;&quot;</span><span style="color: #d55fde;">)</span><span style="color: #abb2bf;">    </span><span style="color: #7f848e;"># =&gt; False</span>
</span><span class="athl-line" data-athl-line="170"><span style="color: #61afef;">Test-Value</span><span style="color: #abb2bf;"> </span><span style="color: #d55fde;">[</span><span style="color: #e5c07b;"></span><span style="color: #d55fde;">]</span><span style="color: #abb2bf;">      </span><span style="color: #7f848e;"># =&gt; True </span>
</span><span class="athl-line" data-athl-line="171"><span style="color: #7f848e;"># *[] calls .NET class; creates &#39;[]&#39; string when passed to function</span>
</span><span class="athl-line" data-athl-line="172"><span style="color: #61afef;">Test-Value</span><span style="color: #abb2bf;"> </span><span style="color: #d55fde;">(</span><span style="color: #d55fde;">{</span><span style="color: #abb2bf;"></span><span style="color: #abb2bf;"></span><span style="color: #d55fde;">}</span><span style="color: #d55fde;">)</span><span style="color: #abb2bf;">    </span><span style="color: #7f848e;"># =&gt; True</span>
</span><span class="athl-line" data-athl-line="173"><span style="color: #61afef;">Test-Value</span><span style="color: #abb2bf;"> </span><span style="color: #abb2bf;">@(</span><span style="color: #abb2bf;">)</span><span style="color: #abb2bf;">     </span><span style="color: #7f848e;"># =&gt; False</span>
</span><span class="athl-line" data-athl-line="174">
</span><span class="athl-line" data-athl-line="175">
</span><span class="athl-line" data-athl-line="176"><span style="color: #7f848e;">####################################################</span>
</span><span class="athl-line" data-athl-line="177"><span style="color: #7f848e;">## 2. Variables and Collections</span>
</span><span class="athl-line" data-athl-line="178"><span style="color: #7f848e;">####################################################</span>
</span><span class="athl-line" data-athl-line="179">
</span><span class="athl-line" data-athl-line="180"><span style="color: #7f848e;"># Powershell uses the &quot;Write-Output&quot; function to print</span>
</span><span class="athl-line" data-athl-line="181"><span style="color: #61afef;">Write-Output</span><span style="color: #abb2bf;"> </span><span style="color: #89ca78;">&quot;I&#39;m Posh. Nice to meet you!&quot;</span><span style="color: #abb2bf;">  </span><span style="color: #7f848e;"># =&gt; I&#39;m Posh. Nice to meet you!</span>
</span><span class="athl-line" data-athl-line="182">
</span><span class="athl-line" data-athl-line="183"><span style="color: #7f848e;"># Simple way to get input data from console</span>
</span><span class="athl-line" data-athl-line="184"><span style="color: #ef596f;">$userInput</span> <span style="color: #2bbac5;"><span style="color: #2bbac5;">=</span></span> <span style="color: #e5c07b;">Read-Host</span><span style="color: #abb2bf;"> </span><span style="color: #89ca78;">&quot;Enter some data: &quot;</span><span style="color: #abb2bf;"> </span><span style="color: #7f848e;"># Returns the data as a string</span>
</span><span class="athl-line" data-athl-line="185">
</span><span class="athl-line" data-athl-line="186"><span style="color: #7f848e;"># There are no declarations, only assignments.</span>
</span><span class="athl-line" data-athl-line="187"><span style="color: #7f848e;"># Convention is to use camelCase or PascalCase, whatever your team uses.</span>
</span><span class="athl-line" data-athl-line="188"><span style="color: #ef596f;">$someVariable</span> <span style="color: #2bbac5;"><span style="color: #2bbac5;">=</span></span> <span style="color: #d19a66;">5</span>
</span><span class="athl-line" data-athl-line="189"><span style="color: #ef596f;">$someVariable</span>  <span style="color: #7f848e;"># =&gt; 5</span>
</span><span class="athl-line" data-athl-line="190">
</span><span class="athl-line" data-athl-line="191"><span style="color: #7f848e;"># Accessing a previously unassigned variable does not throw exception.</span>
</span><span class="athl-line" data-athl-line="192"><span style="color: #7f848e;"># The value is $null by default</span>
</span><span class="athl-line" data-athl-line="193">
</span><span class="athl-line" data-athl-line="194"><span style="color: #7f848e;"># Ternary Operators exist in Powershell 7 and up</span>
</span><span class="athl-line" data-athl-line="195"><span style="color: #d19a66;">0</span> ? &#39;yes&#39; : &#39;no&#39;<span style="color: #7f848e;">  # =&gt; no</span><span style="color: #7f848e;"></span>
</span><span class="athl-line" data-athl-line="196"><span style="color: #7f848e;"></span>
</span><span class="athl-line" data-athl-line="197"><span style="color: #7f848e;"></span>
</span><span class="athl-line" data-athl-line="198"><span style="color: #7f848e;"># The default array object in Powershell is an fixed length array.</span>
</span><span class="athl-line" data-athl-line="199"><span style="color: #ef596f;">$defaultArray</span> <span style="color: #2bbac5;"><span style="color: #2bbac5;">=</span></span> <span style="color: #89ca78;">&quot;thing&quot;</span><span style="color: #abb2bf;">,</span><span style="color: #89ca78;">&quot;thing2&quot;</span><span style="color: #abb2bf;">,</span><span style="color: #89ca78;">&quot;thing3&quot;</span>
</span><span class="athl-line" data-athl-line="200"><span style="color: #7f848e;"># you can add objects with &#39;+=&#39;, but cannot remove objects.</span>
</span><span class="athl-line" data-athl-line="201"><span style="color: #ef596f;">$defaultArray</span><span style="color: #abb2bf;">.</span><span style="color: #61afef;">Add</span><span style="color: #d55fde;">(</span><span style="color: #89ca78;">&quot;thing4&quot;</span><span style="color: #d55fde;">)</span> <span style="color: #7f848e;"># =&gt; Exception &quot;Collection was of a fixed size.&quot;</span>
</span><span class="athl-line" data-athl-line="202"><span style="color: #7f848e;"># To have a more workable array, you&#39;ll want the .NET [ArrayList] class</span>
</span><span class="athl-line" data-athl-line="203"><span style="color: #7f848e;"># It is also worth noting that ArrayLists are significantly faster</span>
</span><span class="athl-line" data-athl-line="204">
</span><span class="athl-line" data-athl-line="205"><span style="color: #7f848e;"># ArrayLists store sequences</span>
</span><span class="athl-line" data-athl-line="206"><span style="color: #d55fde;">[</span><span style="color: #e5c07b;">System<span style="color: #abb2bf;">.</span>Collections<span style="color: #abb2bf;">.</span>ArrayList</span><span style="color: #d55fde;">]</span><span style="color: #ef596f;">$array</span> <span style="color: #2bbac5;"><span style="color: #2bbac5;">=</span></span> <span style="color: #abb2bf;">@(</span><span style="color: #abb2bf;">)</span>
</span><span class="athl-line" data-athl-line="207"><span style="color: #7f848e;"># You can start with a prefilled ArrayList</span>
</span><span class="athl-line" data-athl-line="208"><span style="color: #d55fde;">[</span><span style="color: #e5c07b;">System<span style="color: #abb2bf;">.</span>Collections<span style="color: #abb2bf;">.</span>ArrayList</span><span style="color: #d55fde;">]</span><span style="color: #ef596f;">$otherArray</span> <span style="color: #2bbac5;"><span style="color: #2bbac5;">=</span></span> <span style="color: #abb2bf;">@(</span><span style="color: #d19a66;">5</span><span style="color: #abb2bf;">,</span> <span style="color: #d19a66;">6</span><span style="color: #abb2bf;">,</span> <span style="color: #d19a66;">7</span><span style="color: #abb2bf;">,</span> <span style="color: #d19a66;">8</span><span style="color: #abb2bf;">)</span>
</span><span class="athl-line" data-athl-line="209">
</span><span class="athl-line" data-athl-line="210"><span style="color: #7f848e;"># Add to the end of a list with &#39;Add&#39; (Note: produces output, append to $null)</span>
</span><span class="athl-line" data-athl-line="211"><span style="color: #ef596f;">$array</span><span style="color: #abb2bf;">.</span><span style="color: #61afef;">Add</span><span style="color: #d55fde;">(</span><span style="color: #d19a66;">1</span><span style="color: #d55fde;">)</span> &gt;<span style="color: #abb2bf;"> </span><span style="color: #e5c07b;">$null</span>    <span style="color: #7f848e;"># $array is now [1]</span>
</span><span class="athl-line" data-athl-line="212"><span style="color: #ef596f;">$array</span><span style="color: #abb2bf;">.</span><span style="color: #61afef;">Add</span><span style="color: #d55fde;">(</span><span style="color: #d19a66;">2</span><span style="color: #d55fde;">)</span> &gt;<span style="color: #abb2bf;"> </span><span style="color: #e5c07b;">$null</span>    <span style="color: #7f848e;"># $array is now [1, 2]</span>
</span><span class="athl-line" data-athl-line="213"><span style="color: #ef596f;">$array</span><span style="color: #abb2bf;">.</span><span style="color: #61afef;">Add</span><span style="color: #d55fde;">(</span><span style="color: #d19a66;">4</span><span style="color: #d55fde;">)</span> &gt;<span style="color: #abb2bf;"> </span><span style="color: #e5c07b;">$null</span>    <span style="color: #7f848e;"># $array is now [1, 2, 4]</span>
</span><span class="athl-line" data-athl-line="214"><span style="color: #ef596f;">$array</span><span style="color: #abb2bf;">.</span><span style="color: #61afef;">Add</span><span style="color: #d55fde;">(</span><span style="color: #d19a66;">3</span><span style="color: #d55fde;">)</span> &gt;<span style="color: #abb2bf;"> </span><span style="color: #e5c07b;">$null</span>    <span style="color: #7f848e;"># $array is now [1, 2, 4, 3]</span>
</span><span class="athl-line" data-athl-line="215"><span style="color: #7f848e;"># Remove from end with index of count of objects-1; array index starts at 0</span>
</span><span class="athl-line" data-athl-line="216"><span style="color: #ef596f;">$array</span><span style="color: #abb2bf;">.</span><span style="color: #61afef;">RemoveAt</span><span style="color: #d55fde;">(</span><span style="color: #ef596f;">$array</span><span style="color: #abb2bf;">.</span><span style="color: #ef596f;">Count</span><span style="color: #2bbac5;">-</span><span style="color: #d19a66;">1</span><span style="color: #d55fde;">)</span> <span style="color: #7f848e;"># =&gt; 3 and array is now [1, 2, 4]</span>
</span><span class="athl-line" data-athl-line="217"><span style="color: #7f848e;"># Let&#39;s put it back</span>
</span><span class="athl-line" data-athl-line="218"><span style="color: #ef596f;">$array</span><span style="color: #abb2bf;">.</span><span style="color: #61afef;">Add</span><span style="color: #d55fde;">(</span><span style="color: #d19a66;">3</span><span style="color: #d55fde;">)</span> &gt;<span style="color: #abb2bf;"> </span><span style="color: #e5c07b;">$null</span>   <span style="color: #7f848e;"># array is now [1, 2, 4, 3] again.</span>
</span><span class="athl-line" data-athl-line="219">
</span><span class="athl-line" data-athl-line="220"><span style="color: #7f848e;"># Access a list like you would any array</span>
</span><span class="athl-line" data-athl-line="221"><span style="color: #ef596f;">$array</span><span style="color: #d55fde;">[</span><span style="color: #d19a66;">0</span><span style="color: #d55fde;">]</span>   <span style="color: #7f848e;"># =&gt; 1</span>
</span><span class="athl-line" data-athl-line="222"><span style="color: #7f848e;"># Look at the last element</span>
</span><span class="athl-line" data-athl-line="223"><span style="color: #ef596f;">$array</span><span style="color: #d55fde;">[</span><span style="color: #2bbac5;">-</span><span style="color: #d19a66;">1</span><span style="color: #d55fde;">]</span>  <span style="color: #7f848e;"># =&gt; 3</span>
</span><span class="athl-line" data-athl-line="224"><span style="color: #7f848e;"># Looking out of bounds returns nothing</span>
</span><span class="athl-line" data-athl-line="225"><span style="color: #ef596f;">$array</span><span style="color: #d55fde;">[</span><span style="color: #d19a66;">4</span><span style="color: #d55fde;">]</span>  <span style="color: #7f848e;"># blank line returned</span>
</span><span class="athl-line" data-athl-line="226">
</span><span class="athl-line" data-athl-line="227"><span style="color: #7f848e;"># Remove elements from a array</span>
</span><span class="athl-line" data-athl-line="228"><span style="color: #ef596f;">$array</span><span style="color: #abb2bf;">.</span><span style="color: #61afef;">Remove</span><span style="color: #d55fde;">(</span><span style="color: #ef596f;">$array</span><span style="color: #d55fde;">[</span><span style="color: #d19a66;">3</span><span style="color: #d55fde;">]</span><span style="color: #d55fde;">)</span>  <span style="color: #7f848e;"># $array is now [1, 2, 4]</span>
</span><span class="athl-line" data-athl-line="229">
</span><span class="athl-line" data-athl-line="230"><span style="color: #7f848e;"># Insert at index an element </span>
</span><span class="athl-line" data-athl-line="231"><span style="color: #ef596f;">$array</span><span style="color: #abb2bf;">.</span><span style="color: #61afef;">Insert</span><span style="color: #d55fde;">(</span><span style="color: #d19a66;">2</span><span style="color: #abb2bf;">,</span> <span style="color: #d19a66;">3</span><span style="color: #d55fde;">)</span>  <span style="color: #7f848e;"># $array is now [1, 2, 3, 4]</span>
</span><span class="athl-line" data-athl-line="232">
</span><span class="athl-line" data-athl-line="233"><span style="color: #7f848e;"># Get the index of the first item found matching the argument</span>
</span><span class="athl-line" data-athl-line="234"><span style="color: #ef596f;">$array</span><span style="color: #abb2bf;">.</span><span style="color: #61afef;">IndexOf</span><span style="color: #d55fde;">(</span><span style="color: #d19a66;">2</span><span style="color: #d55fde;">)</span>  <span style="color: #7f848e;"># =&gt; 1</span>
</span><span class="athl-line" data-athl-line="235"><span style="color: #ef596f;">$array</span><span style="color: #abb2bf;">.</span><span style="color: #61afef;">IndexOf</span><span style="color: #d55fde;">(</span><span style="color: #d19a66;">6</span><span style="color: #d55fde;">)</span>  <span style="color: #7f848e;"># Returns -1 as &quot;outside array&quot; </span>
</span><span class="athl-line" data-athl-line="236">
</span><span class="athl-line" data-athl-line="237"><span style="color: #7f848e;"># You can add arrays</span>
</span><span class="athl-line" data-athl-line="238"><span style="color: #7f848e;"># Note: values for $array and for $otherArray are not modified.</span>
</span><span class="athl-line" data-athl-line="239"><span style="color: #ef596f;">$array</span> <span style="color: #2bbac5;">+</span> <span style="color: #ef596f;">$otherArray</span>  <span style="color: #7f848e;"># =&gt; [1, 2, 3, 4, 5, 6, 7, 8]</span>
</span><span class="athl-line" data-athl-line="240">
</span><span class="athl-line" data-athl-line="241"><span style="color: #7f848e;"># Concatenate arrays with &quot;AddRange()&quot;</span>
</span><span class="athl-line" data-athl-line="242"><span style="color: #ef596f;">$array</span><span style="color: #abb2bf;">.</span><span style="color: #61afef;">AddRange</span><span style="color: #d55fde;">(</span><span style="color: #ef596f;">$otherArray</span><span style="color: #d55fde;">)</span>  <span style="color: #7f848e;"># Now $array is [1, 2, 3, 4, 5, 6, 7, 8]</span>
</span><span class="athl-line" data-athl-line="243">
</span><span class="athl-line" data-athl-line="244"><span style="color: #7f848e;"># Check for existence in a array with &quot;in&quot;</span>
</span><span class="athl-line" data-athl-line="245"><span style="color: #d19a66;">1</span> <span style="color: #2bbac5;">-in</span> <span style="color: #ef596f;">$array</span>  <span style="color: #7f848e;"># =&gt; True</span>
</span><span class="athl-line" data-athl-line="246">
</span><span class="athl-line" data-athl-line="247"><span style="color: #7f848e;"># Examine length with &quot;Count&quot; (Note: &quot;Length&quot; on arrayList = each items length)</span>
</span><span class="athl-line" data-athl-line="248"><span style="color: #ef596f;">$array</span><span style="color: #abb2bf;">.</span><span style="color: #ef596f;">Count</span>  <span style="color: #7f848e;"># =&gt; 8</span>
</span><span class="athl-line" data-athl-line="249">
</span><span class="athl-line" data-athl-line="250"><span style="color: #7f848e;"># You can look at ranges with slice syntax.</span>
</span><span class="athl-line" data-athl-line="251"><span style="color: #ef596f;">$array</span><span style="color: #d55fde;">[</span><span style="color: #d19a66;">1</span><span style="color: #abb2bf;">,</span><span style="color: #d19a66;">3</span><span style="color: #abb2bf;">,</span><span style="color: #d19a66;">5</span><span style="color: #d55fde;">]</span>     <span style="color: #7f848e;"># Return selected index  =&gt; [2, 4, 6]</span>
</span><span class="athl-line" data-athl-line="252"><span style="color: #ef596f;">$array</span><span style="color: #d55fde;">[</span><span style="color: #d19a66;">1</span><span style="color: #2bbac5;">..</span><span style="color: #d19a66;">3</span><span style="color: #d55fde;">]</span>      <span style="color: #7f848e;"># Return from index 1 to 3 =&gt; [2, 3, 4]</span>
</span><span class="athl-line" data-athl-line="253"><span style="color: #ef596f;">$array</span><span style="color: #d55fde;">[</span><span style="color: #2bbac5;">-</span><span style="color: #d19a66;">3</span><span style="color: #2bbac5;">..</span><span style="color: #2bbac5;">-</span><span style="color: #d19a66;">1</span><span style="color: #d55fde;">]</span>    <span style="color: #7f848e;"># Return from last 3 to last 1 =&gt; [6, 7, 8]</span>
</span><span class="athl-line" data-athl-line="254"><span style="color: #ef596f;">$array</span><span style="color: #d55fde;">[</span><span style="color: #2bbac5;">-</span><span style="color: #d19a66;">1</span><span style="color: #2bbac5;">..</span><span style="color: #2bbac5;">-</span><span style="color: #d19a66;">3</span><span style="color: #d55fde;">]</span>    <span style="color: #7f848e;"># Return from last 1 to last 3 =&gt; [8, 7, 6]</span>
</span><span class="athl-line" data-athl-line="255"><span style="color: #ef596f;">$array</span><span style="color: #d55fde;">[</span><span style="color: #d19a66;">2</span><span style="color: #2bbac5;">..</span><span style="color: #2bbac5;">-</span><span style="color: #d19a66;">1</span><span style="color: #d55fde;">]</span>     <span style="color: #7f848e;"># Return from index 2 to last (NOT as most expect) =&gt; [3, 2, 1, 8]</span>
</span><span class="athl-line" data-athl-line="256"><span style="color: #ef596f;">$array</span><span style="color: #d55fde;">[</span><span style="color: #d19a66;">0</span><span style="color: #abb2bf;">,</span><span style="color: #d19a66;">2</span><span style="color: #2bbac5;">+</span><span style="color: #d19a66;">4</span><span style="color: #2bbac5;">..</span><span style="color: #d19a66;">6</span><span style="color: #d55fde;">]</span>  <span style="color: #7f848e;"># Return multiple ranges with the + =&gt; [1, 3, 5, 6, 7]</span>
</span><span class="athl-line" data-athl-line="257">
</span><span class="athl-line" data-athl-line="258"><span style="color: #7f848e;"># -eq doesn&#39;t compare array but extract the matching elements</span>
</span><span class="athl-line" data-athl-line="259"><span style="color: #ef596f;">$array</span> <span style="color: #2bbac5;"><span style="color: #2bbac5;">=</span></span> <span style="color: #d19a66;">1</span><span style="color: #abb2bf;">,</span><span style="color: #d19a66;">2</span><span style="color: #abb2bf;">,</span><span style="color: #d19a66;">3</span><span style="color: #abb2bf;">,</span><span style="color: #d19a66;">1</span><span style="color: #abb2bf;">,</span><span style="color: #d19a66;">1</span>
</span><span class="athl-line" data-athl-line="260"><span style="color: #ef596f;">$array</span> <span style="color: #2bbac5;">-eq</span> <span style="color: #d19a66;">1</span>          <span style="color: #7f848e;"># =&gt; 1,1,1</span>
</span><span class="athl-line" data-athl-line="261"><span style="color: #d55fde;">(</span><span style="color: #ef596f;">$array</span> <span style="color: #2bbac5;">-eq</span> <span style="color: #d19a66;">1</span><span style="color: #d55fde;">)</span><span style="color: #abb2bf;">.</span><span style="color: #ef596f;">Count</span>  <span style="color: #7f848e;"># =&gt; 3</span>
</span><span class="athl-line" data-athl-line="262">
</span><span class="athl-line" data-athl-line="263"><span style="color: #7f848e;"># Tuples are like arrays but are immutable.</span>
</span><span class="athl-line" data-athl-line="264"><span style="color: #7f848e;"># To use Tuples in powershell, you must use the .NET tuple class.</span>
</span><span class="athl-line" data-athl-line="265"><span style="color: #ef596f;">$tuple</span> <span style="color: #2bbac5;"><span style="color: #2bbac5;">=</span></span> <span style="color: #d55fde;">[</span><span style="color: #e5c07b;">System<span style="color: #abb2bf;">.</span>Tuple</span><span style="color: #d55fde;">]</span><span style="color: #abb2bf;">::</span><span style="color: #61afef;">Create</span><span style="color: #d55fde;">(</span><span style="color: #d19a66;">1</span><span style="color: #abb2bf;">,</span> <span style="color: #d19a66;">2</span><span style="color: #abb2bf;">,</span> <span style="color: #d19a66;">3</span><span style="color: #d55fde;">)</span>
</span><span class="athl-line" data-athl-line="266"><span style="color: #ef596f;">$tuple</span><span style="color: #abb2bf;">.</span><span style="color: #61afef;">Item</span><span style="color: #d55fde;">(</span><span style="color: #d19a66;">0</span><span style="color: #d55fde;">)</span>      <span style="color: #7f848e;"># =&gt; 1</span>
</span><span class="athl-line" data-athl-line="267"><span style="color: #ef596f;">$tuple</span><span style="color: #abb2bf;">.</span><span style="color: #61afef;">Item</span><span style="color: #d55fde;">(</span><span style="color: #d19a66;">0</span><span style="color: #d55fde;">)</span> <span style="color: #2bbac5;"><span style="color: #2bbac5;">=</span></span> <span style="color: #d19a66;">3</span>  <span style="color: #7f848e;"># Raises a TypeError</span>
</span><span class="athl-line" data-athl-line="268">
</span><span class="athl-line" data-athl-line="269"><span style="color: #7f848e;"># You can do some of the array methods on tuples, but they are limited.</span>
</span><span class="athl-line" data-athl-line="270"><span style="color: #ef596f;">$tuple</span><span style="color: #abb2bf;">.</span><span style="color: #ef596f;">Length</span>       <span style="color: #7f848e;"># =&gt; 3</span>
</span><span class="athl-line" data-athl-line="271"><span style="color: #ef596f;">$tuple</span> <span style="color: #2bbac5;">+</span> <span style="color: #d55fde;">(</span><span style="color: #d19a66;">4</span><span style="color: #abb2bf;">,</span> <span style="color: #d19a66;">5</span><span style="color: #abb2bf;">,</span> <span style="color: #d19a66;">6</span><span style="color: #d55fde;">)</span>  <span style="color: #7f848e;"># =&gt; Exception</span>
</span><span class="athl-line" data-athl-line="272"><span style="color: #ef596f;">$tuple</span><span style="color: #d55fde;">[</span><span style="color: #d19a66;">0</span><span style="color: #2bbac5;">..</span><span style="color: #d19a66;">2</span><span style="color: #d55fde;">]</span>        <span style="color: #7f848e;"># =&gt; $null (in powershell 5)    =&gt; [1, 2, 3] (in powershell 7)</span>
</span><span class="athl-line" data-athl-line="273"><span style="color: #d19a66;">2</span> <span style="color: #2bbac5;">-in</span> <span style="color: #ef596f;">$tuple</span>        <span style="color: #7f848e;"># =&gt; False</span>
</span><span class="athl-line" data-athl-line="274">
</span><span class="athl-line" data-athl-line="275">
</span><span class="athl-line" data-athl-line="276"><span style="color: #7f848e;"># Hashtables store mappings from keys to values, similar to (but distinct from) Dictionaries.</span>
</span><span class="athl-line" data-athl-line="277"><span style="color: #7f848e;"># Hashtables do not hold entry order as arrays do. </span>
</span><span class="athl-line" data-athl-line="278"><span style="color: #ef596f;">$emptyHash</span> <span style="color: #2bbac5;"><span style="color: #2bbac5;">=</span></span> <span style="color: #abb2bf;">@{</span><span style="color: #abb2bf;">}</span>
</span><span class="athl-line" data-athl-line="279"><span style="color: #7f848e;"># Here is a prefilled hashtable</span>
</span><span class="athl-line" data-athl-line="280"><span style="color: #ef596f;">$filledHash</span> <span style="color: #2bbac5;"><span style="color: #2bbac5;">=</span></span> <span style="color: #abb2bf;">@{</span><span style="color: #ef596f;"><span style="color: #89ca78;">&quot;one&quot;</span></span><span style="color: #2bbac5;">=</span> <span style="color: #d19a66;">1</span> 
</span><span class="athl-line" data-athl-line="281">                <span style="color: #ef596f;"><span style="color: #89ca78;">&quot;two&quot;</span></span><span style="color: #2bbac5;">=</span> <span style="color: #d19a66;">2</span> 
</span><span class="athl-line" data-athl-line="282">                <span style="color: #ef596f;"><span style="color: #89ca78;">&quot;three&quot;</span></span><span style="color: #2bbac5;">=</span> <span style="color: #d19a66;">3</span><span style="color: #abb2bf;">}</span>
</span><span class="athl-line" data-athl-line="283">
</span><span class="athl-line" data-athl-line="284"><span style="color: #7f848e;"># Look up values with []</span>
</span><span class="athl-line" data-athl-line="285"><span style="color: #ef596f;">$filledHash</span><span style="color: #d55fde;">[</span><span style="color: #89ca78;">&quot;one&quot;</span><span style="color: #d55fde;">]</span>  <span style="color: #7f848e;"># =&gt; 1</span>
</span><span class="athl-line" data-athl-line="286">
</span><span class="athl-line" data-athl-line="287"><span style="color: #7f848e;"># Get all keys as an iterable with &quot;.Keys&quot;.</span>
</span><span class="athl-line" data-athl-line="288"><span style="color: #ef596f;">$filledHash</span><span style="color: #abb2bf;">.</span><span style="color: #ef596f;">Keys</span>  <span style="color: #7f848e;"># =&gt; [&quot;one&quot;, &quot;two&quot;, &quot;three&quot;]</span>
</span><span class="athl-line" data-athl-line="289">
</span><span class="athl-line" data-athl-line="290"><span style="color: #7f848e;"># Get all values as an iterable with &quot;.Values&quot;.</span>
</span><span class="athl-line" data-athl-line="291"><span style="color: #ef596f;">$filledHash</span><span style="color: #abb2bf;">.</span><span style="color: #ef596f;">Values</span>  <span style="color: #7f848e;"># =&gt; [1, 2, 3]</span>
</span><span class="athl-line" data-athl-line="292">
</span><span class="athl-line" data-athl-line="293"><span style="color: #7f848e;"># Check for existence of keys or values in a hash with &quot;-in&quot;</span>
</span><span class="athl-line" data-athl-line="294"><span style="color: #89ca78;">&quot;one&quot;</span> <span style="color: #2bbac5;">-in</span> <span style="color: #ef596f;">$filledHash</span><span style="color: #abb2bf;">.</span><span style="color: #ef596f;">Keys</span>  <span style="color: #7f848e;"># =&gt; True</span>
</span><span class="athl-line" data-athl-line="295"><span style="color: #d19a66;">1</span> <span style="color: #2bbac5;">-in</span> <span style="color: #ef596f;">$filledHash</span><span style="color: #abb2bf;">.</span><span style="color: #ef596f;">Values</span>    <span style="color: #7f848e;"># =&gt; False (in powershell 5)    =&gt; True (in powershell 7)</span>
</span><span class="athl-line" data-athl-line="296">
</span><span class="athl-line" data-athl-line="297"><span style="color: #7f848e;"># Looking up a non-existing key returns $null</span>
</span><span class="athl-line" data-athl-line="298"><span style="color: #ef596f;">$filledHash</span><span style="color: #d55fde;">[</span><span style="color: #89ca78;">&quot;four&quot;</span><span style="color: #d55fde;">]</span>  <span style="color: #7f848e;"># $null</span>
</span><span class="athl-line" data-athl-line="299">
</span><span class="athl-line" data-athl-line="300"><span style="color: #7f848e;"># Adding to a hashtable</span>
</span><span class="athl-line" data-athl-line="301"><span style="color: #ef596f;">$filledHash</span><span style="color: #abb2bf;">.</span><span style="color: #61afef;">Add</span><span style="color: #d55fde;">(</span><span style="color: #89ca78;">&quot;five&quot;</span><span style="color: #abb2bf;">,</span><span style="color: #d19a66;">5</span><span style="color: #d55fde;">)</span>  <span style="color: #7f848e;"># $filledHash[&quot;five&quot;] is set to 5</span>
</span><span class="athl-line" data-athl-line="302"><span style="color: #ef596f;">$filledHash</span><span style="color: #abb2bf;">.</span><span style="color: #61afef;">Add</span><span style="color: #d55fde;">(</span><span style="color: #89ca78;">&quot;five&quot;</span><span style="color: #abb2bf;">,</span><span style="color: #d19a66;">6</span><span style="color: #d55fde;">)</span>  <span style="color: #7f848e;"># exception &quot;Item with key &quot;five&quot; has already been added&quot;</span>
</span><span class="athl-line" data-athl-line="303"><span style="color: #ef596f;">$filledHash</span><span style="color: #d55fde;">[</span><span style="color: #89ca78;">&quot;four&quot;</span><span style="color: #d55fde;">]</span> <span style="color: #2bbac5;"><span style="color: #2bbac5;">=</span></span> <span style="color: #d19a66;">4</span>    <span style="color: #7f848e;"># $filledHash[&quot;four&quot;] is set to 4, running again does nothing</span>
</span><span class="athl-line" data-athl-line="304">
</span><span class="athl-line" data-athl-line="305"><span style="color: #7f848e;"># Remove keys from a hashtable</span>
</span><span class="athl-line" data-athl-line="306"><span style="color: #ef596f;">$filledHash</span><span style="color: #abb2bf;">.</span><span style="color: #61afef;">Remove</span><span style="color: #d55fde;">(</span><span style="color: #89ca78;">&quot;one&quot;</span><span style="color: #d55fde;">)</span> <span style="color: #7f848e;"># Removes the key &quot;one&quot; from filled hashtable</span>
</span><span class="athl-line" data-athl-line="307">
</span><span class="athl-line" data-athl-line="308">
</span><span class="athl-line" data-athl-line="309"><span style="color: #7f848e;">####################################################</span>
</span><span class="athl-line" data-athl-line="310"><span style="color: #7f848e;">## 3. Control Flow and Iterables</span>
</span><span class="athl-line" data-athl-line="311"><span style="color: #7f848e;">####################################################</span>
</span><span class="athl-line" data-athl-line="312">
</span><span class="athl-line" data-athl-line="313"><span style="color: #7f848e;"># Let&#39;s just make a variable</span>
</span><span class="athl-line" data-athl-line="314"><span style="color: #ef596f;">$someVar</span> <span style="color: #2bbac5;"><span style="color: #2bbac5;">=</span></span> <span style="color: #d19a66;">5</span>
</span><span class="athl-line" data-athl-line="315">
</span><span class="athl-line" data-athl-line="316"><span style="color: #7f848e;"># Here is an if statement.</span>
</span><span class="athl-line" data-athl-line="317"><span style="color: #7f848e;"># This prints &quot;$someVar is smaller than 10&quot;</span>
</span><span class="athl-line" data-athl-line="318"><span style="color: #d55fde;">if</span> <span style="color: #d55fde;">(</span><span style="color: #ef596f;">$someVar</span> <span style="color: #2bbac5;">-gt</span> <span style="color: #d19a66;">10</span><span style="color: #d55fde;">)</span> <span style="color: #d55fde;">{</span>
</span><span class="athl-line" data-athl-line="319">    <span style="color: #61afef;">Write-Output</span><span style="color: #abb2bf;"> </span><span style="color: #89ca78;">&quot;<span style="color: #ef596f;">$someVar</span> is bigger than 10.&quot;</span>
</span><span class="athl-line" data-athl-line="320"><span style="color: #d55fde;">}</span>
</span><span class="athl-line" data-athl-line="321"><span style="color: #d55fde;">elseif</span> <span style="color: #d55fde;">(</span><span style="color: #ef596f;">$someVar</span> <span style="color: #2bbac5;">-lt</span> <span style="color: #d19a66;">10</span><span style="color: #d55fde;">)</span> <span style="color: #d55fde;">{</span>    <span style="color: #7f848e;"># This elseif clause is optional.</span>
</span><span class="athl-line" data-athl-line="322">    <span style="color: #61afef;">Write-Output</span><span style="color: #abb2bf;"> </span><span style="color: #89ca78;">&quot;<span style="color: #ef596f;">$someVar</span> is smaller than 10.&quot;</span>
</span><span class="athl-line" data-athl-line="323"><span style="color: #d55fde;">}</span>
</span><span class="athl-line" data-athl-line="324"><span style="color: #d55fde;">else</span> <span style="color: #d55fde;">{</span>                        <span style="color: #7f848e;"># This is optional too.</span>
</span><span class="athl-line" data-athl-line="325">    <span style="color: #61afef;">Write-Output</span><span style="color: #abb2bf;"> </span><span style="color: #89ca78;">&quot;<span style="color: #ef596f;">$someVar</span> is indeed 10.&quot;</span>
</span><span class="athl-line" data-athl-line="326"><span style="color: #d55fde;">}</span>
</span><span class="athl-line" data-athl-line="327">
</span><span class="athl-line" data-athl-line="328">
</span><span class="athl-line" data-athl-line="329"><span style="color: #7f848e;">&lt;#</span>
</span><span class="athl-line" data-athl-line="330"><span style="color: #7f848e;">Foreach loops iterate over arrays</span>
</span><span class="athl-line" data-athl-line="331"><span style="color: #7f848e;">prints:</span>
</span><span class="athl-line" data-athl-line="332"><span style="color: #7f848e;">    dog is a mammal</span>
</span><span class="athl-line" data-athl-line="333"><span style="color: #7f848e;">    cat is a mammal</span>
</span><span class="athl-line" data-athl-line="334"><span style="color: #7f848e;">    mouse is a mammal</span>
</span><span class="athl-line" data-athl-line="335"><span style="color: #7f848e;">#&gt;</span>
</span><span class="athl-line" data-athl-line="336"><span style="color: #d55fde;">foreach</span> <span style="color: #d55fde;">(</span><span style="color: #ef596f;">$animal</span> <span style="color: #d55fde;">in</span> <span style="color: #d55fde;">(</span><span style="color: #89ca78;">&quot;dog&quot;</span><span style="color: #abb2bf;">,</span> <span style="color: #89ca78;">&quot;cat&quot;</span><span style="color: #abb2bf;">,</span> <span style="color: #89ca78;">&quot;mouse&quot;</span><span style="color: #d55fde;">)</span><span style="color: #d55fde;">)</span> <span style="color: #d55fde;">{</span>
</span><span class="athl-line" data-athl-line="337">    <span style="color: #7f848e;"># You can use -f to interpolate formatted strings</span>
</span><span class="athl-line" data-athl-line="338">    <span style="color: #89ca78;">&quot;{0} is a mammal&quot;</span> -f <span style="color: #ef596f;">$animal</span>
</span><span class="athl-line" data-athl-line="339"><span style="color: #d55fde;">}</span>
</span><span class="athl-line" data-athl-line="340">
</span><span class="athl-line" data-athl-line="341"><span style="color: #7f848e;">&lt;#</span>
</span><span class="athl-line" data-athl-line="342"><span style="color: #7f848e;">For loops iterate over arrays and you can specify indices</span>
</span><span class="athl-line" data-athl-line="343"><span style="color: #7f848e;">prints:</span>
</span><span class="athl-line" data-athl-line="344"><span style="color: #7f848e;">   0 a</span>
</span><span class="athl-line" data-athl-line="345"><span style="color: #7f848e;">   1 b</span>
</span><span class="athl-line" data-athl-line="346"><span style="color: #7f848e;">   2 c</span>
</span><span class="athl-line" data-athl-line="347"><span style="color: #7f848e;">   3 d</span>
</span><span class="athl-line" data-athl-line="348"><span style="color: #7f848e;">   4 e</span>
</span><span class="athl-line" data-athl-line="349"><span style="color: #7f848e;">   5 f</span>
</span><span class="athl-line" data-athl-line="350"><span style="color: #7f848e;">   6 g</span>
</span><span class="athl-line" data-athl-line="351"><span style="color: #7f848e;">   7 h</span>
</span><span class="athl-line" data-athl-line="352"><span style="color: #7f848e;">#&gt;</span>
</span><span class="athl-line" data-athl-line="353"><span style="color: #ef596f;">$letters</span> <span style="color: #2bbac5;"><span style="color: #2bbac5;">=</span></span> <span style="color: #d55fde;">(</span><span style="color: #89ca78;">&#39;a&#39;</span><span style="color: #abb2bf;">,</span><span style="color: #89ca78;">&#39;b&#39;</span><span style="color: #abb2bf;">,</span><span style="color: #89ca78;">&#39;c&#39;</span><span style="color: #abb2bf;">,</span><span style="color: #89ca78;">&#39;d&#39;</span><span style="color: #abb2bf;">,</span><span style="color: #89ca78;">&#39;e&#39;</span><span style="color: #abb2bf;">,</span><span style="color: #89ca78;">&#39;f&#39;</span><span style="color: #abb2bf;">,</span><span style="color: #89ca78;">&#39;g&#39;</span><span style="color: #abb2bf;">,</span><span style="color: #89ca78;">&#39;h&#39;</span><span style="color: #d55fde;">)</span>
</span><span class="athl-line" data-athl-line="354"><span style="color: #d55fde;">for</span><span style="color: #d55fde;">(</span><span style="color: #ef596f;">$i</span><span style="color: #2bbac5;"><span style="color: #2bbac5;">=</span></span><span style="color: #d19a66;">0</span><span style="color: #abb2bf;">;</span> <span style="color: #ef596f;">$i</span> <span style="color: #2bbac5;">-le</span> <span style="color: #ef596f;">$letters</span><span style="color: #abb2bf;">.</span><span style="color: #ef596f;">Count</span><span style="color: #2bbac5;">-</span><span style="color: #d19a66;">1</span><span style="color: #abb2bf;">;</span> <span style="color: #2bbac5;"><span style="color: #ef596f;">$i</span>++</span><span style="color: #d55fde;">)</span><span style="color: #d55fde;">{</span>
</span><span class="athl-line" data-athl-line="355">    <span style="color: #e5c07b;">Write-Host</span><span style="color: #abb2bf;"> </span><span style="color: #ef596f;">$i</span><span style="color: #abb2bf;">,</span> <span style="color: #ef596f;">$letters</span><span style="color: #d55fde;">[</span><span style="color: #ef596f;">$i</span><span style="color: #d55fde;">]</span>
</span><span class="athl-line" data-athl-line="356"><span style="color: #d55fde;">}</span>
</span><span class="athl-line" data-athl-line="357">
</span><span class="athl-line" data-athl-line="358"><span style="color: #7f848e;">&lt;#</span>
</span><span class="athl-line" data-athl-line="359"><span style="color: #7f848e;">While loops go until a condition is no longer met.</span>
</span><span class="athl-line" data-athl-line="360"><span style="color: #7f848e;">prints:</span>
</span><span class="athl-line" data-athl-line="361"><span style="color: #7f848e;">    0</span>
</span><span class="athl-line" data-athl-line="362"><span style="color: #7f848e;">    1</span>
</span><span class="athl-line" data-athl-line="363"><span style="color: #7f848e;">    2</span>
</span><span class="athl-line" data-athl-line="364"><span style="color: #7f848e;">    3</span>
</span><span class="athl-line" data-athl-line="365"><span style="color: #7f848e;">#&gt;</span>
</span><span class="athl-line" data-athl-line="366"><span style="color: #ef596f;">$x</span> <span style="color: #2bbac5;"><span style="color: #2bbac5;">=</span></span> <span style="color: #d19a66;">0</span>
</span><span class="athl-line" data-athl-line="367"><span style="color: #d55fde;">while</span> <span style="color: #d55fde;">(</span><span style="color: #ef596f;">$x</span> <span style="color: #2bbac5;">-lt</span> <span style="color: #d19a66;">4</span><span style="color: #d55fde;">)</span> <span style="color: #d55fde;">{</span>
</span><span class="athl-line" data-athl-line="368">    <span style="color: #61afef;">Write-Output</span><span style="color: #abb2bf;"> </span><span style="color: #ef596f;">$x</span>
</span><span class="athl-line" data-athl-line="369">    <span style="color: #ef596f;">$x</span> <span style="color: #2bbac5;">+=</span> <span style="color: #d19a66;">1</span>  <span style="color: #7f848e;"># Shorthand for x = x + 1</span>
</span><span class="athl-line" data-athl-line="370"><span style="color: #d55fde;">}</span>
</span><span class="athl-line" data-athl-line="371">
</span><span class="athl-line" data-athl-line="372"><span style="color: #7f848e;"># Switch statements are more powerful compared to most languages</span>
</span><span class="athl-line" data-athl-line="373"><span style="color: #ef596f;">$val</span> <span style="color: #2bbac5;"><span style="color: #2bbac5;">=</span></span> <span style="color: #89ca78;">&quot;20&quot;</span>
</span><span class="athl-line" data-athl-line="374"><span style="color: #d55fde;">switch</span><span style="color: #d55fde;">(</span><span style="color: #ef596f;">$val</span><span style="color: #d55fde;">)</span> <span style="color: #d55fde;">{</span>
</span><span class="athl-line" data-athl-line="375">  <span style="color: #d55fde;">{</span> <span style="color: #e5c07b;">$_</span> <span style="color: #2bbac5;">-eq</span> <span style="color: #d19a66;">42</span> <span style="color: #d55fde;">}</span>           <span style="color: #d55fde;">{</span> <span style="color: #89ca78;">&quot;The answer equals 42&quot;</span><span style="color: #abb2bf;"><span style="color: #abb2bf;">;</span></span> <span style="color: #d55fde;">break</span> <span style="color: #d55fde;">}</span>
</span><span class="athl-line" data-athl-line="376">  <span style="color: #89ca78;">&#39;20&#39;</span>                    <span style="color: #d55fde;">{</span> <span style="color: #89ca78;">&quot;Exactly 20&quot;</span><span style="color: #abb2bf;"><span style="color: #abb2bf;">;</span></span> <span style="color: #d55fde;">break</span> <span style="color: #d55fde;">}</span>
</span><span class="athl-line" data-athl-line="377">  <span style="color: #d55fde;">{</span> <span style="color: #e5c07b;">$_</span> <span style="color: #2bbac5;">-like</span> <span style="color: #89ca78;">&#39;s*&#39;</span> <span style="color: #d55fde;">}</span>       <span style="color: #d55fde;">{</span> <span style="color: #89ca78;">&quot;Case insensitive&quot;</span><span style="color: #abb2bf;"><span style="color: #abb2bf;">;</span></span> <span style="color: #d55fde;">break</span> <span style="color: #d55fde;">}</span>
</span><span class="athl-line" data-athl-line="378">  <span style="color: #d55fde;">{</span> <span style="color: #e5c07b;">$_</span> <span style="color: #2bbac5;">-clike</span> <span style="color: #89ca78;">&#39;s*&#39;</span><span style="color: #d55fde;">}</span>       <span style="color: #d55fde;">{</span> <span style="color: #89ca78;">&quot;clike, ceq, cne for case sensitive&quot;</span><span style="color: #abb2bf;"><span style="color: #abb2bf;">;</span></span> <span style="color: #d55fde;">break</span> <span style="color: #d55fde;">}</span>
</span><span class="athl-line" data-athl-line="379">  <span style="color: #d55fde;">{</span> <span style="color: #e5c07b;">$_</span> <span style="color: #2bbac5;">-notmatch</span> <span style="color: #89ca78;">&#39;^.*$&#39;</span><span style="color: #d55fde;">}</span>  <span style="color: #d55fde;">{</span> <span style="color: #89ca78;">&quot;Regex matching. cnotmatch, cnotlike, ...&quot;</span><span style="color: #abb2bf;"><span style="color: #abb2bf;">;</span></span> <span style="color: #d55fde;">break</span> <span style="color: #d55fde;">}</span>
</span><span class="athl-line" data-athl-line="380">  default                 <span style="color: #d55fde;">{</span> <span style="color: #89ca78;">&quot;Others&quot;</span> <span style="color: #d55fde;">}</span>
</span><span class="athl-line" data-athl-line="381"><span style="color: #d55fde;">}</span>
</span><span class="athl-line" data-athl-line="382">
</span><span class="athl-line" data-athl-line="383"><span style="color: #7f848e;"># Handle exceptions with a try/catch block</span>
</span><span class="athl-line" data-athl-line="384"><span style="color: #d55fde;">try</span> <span style="color: #d55fde;">{</span>
</span><span class="athl-line" data-athl-line="385">    <span style="color: #7f848e;"># Use &quot;throw&quot; to raise an error</span>
</span><span class="athl-line" data-athl-line="386">    <span style="color: #d55fde;">throw</span> <span style="color: #89ca78;">&quot;This is an error&quot;</span>
</span><span class="athl-line" data-athl-line="387"><span style="color: #d55fde;">}</span>
</span><span class="athl-line" data-athl-line="388"><span style="color: #d55fde;">catch</span> <span style="color: #d55fde;">{</span>
</span><span class="athl-line" data-athl-line="389">    <span style="color: #61afef;">Write-Output</span><span style="color: #abb2bf;"> </span><span style="color: #e5c07b;">$Error</span><span style="color: #abb2bf;">.</span><span style="color: #ef596f;">ExceptionMessage</span>
</span><span class="athl-line" data-athl-line="390"><span style="color: #d55fde;">}</span>
</span><span class="athl-line" data-athl-line="391"><span style="color: #d55fde;">finally</span> <span style="color: #d55fde;">{</span>
</span><span class="athl-line" data-athl-line="392">    <span style="color: #61afef;">Write-Output</span><span style="color: #abb2bf;"> </span><span style="color: #89ca78;">&quot;We can clean up resources here&quot;</span>
</span><span class="athl-line" data-athl-line="393"><span style="color: #d55fde;">}</span>
</span><span class="athl-line" data-athl-line="394">
</span><span class="athl-line" data-athl-line="395">
</span><span class="athl-line" data-athl-line="396"><span style="color: #7f848e;"># Writing to a file</span>
</span><span class="athl-line" data-athl-line="397"><span style="color: #ef596f;">$contents</span> <span style="color: #2bbac5;"><span style="color: #2bbac5;">=</span></span> <span style="color: #abb2bf;">@{</span><span style="color: #ef596f;"><span style="color: #89ca78;">&quot;aa&quot;</span></span><span style="color: #2bbac5;">=</span> <span style="color: #d19a66;">12</span> 
</span><span class="athl-line" data-athl-line="398">             <span style="color: #ef596f;"><span style="color: #89ca78;">&quot;bb&quot;</span></span><span style="color: #2bbac5;">=</span> <span style="color: #d19a66;">21</span><span style="color: #abb2bf;">}</span>
</span><span class="athl-line" data-athl-line="399"><span style="color: #ef596f;">$contents</span> <span style="color: #2bbac5;">|</span> <span style="color: #61afef;">Export-CSV</span><span style="color: #abb2bf;"> </span><span style="color: #89ca78;">&quot;<span style="color: #e5c07b;">$env:HOMEDRIVE</span>\file.csv&quot;</span><span style="color: #abb2bf;"> </span><span style="color: #7f848e;"># writes to a file</span>
</span><span class="athl-line" data-athl-line="400">
</span><span class="athl-line" data-athl-line="401"><span style="color: #ef596f;">$contents</span> <span style="color: #2bbac5;"><span style="color: #2bbac5;">=</span></span> <span style="color: #89ca78;">&quot;test string here&quot;</span>
</span><span class="athl-line" data-athl-line="402"><span style="color: #ef596f;">$contents</span> <span style="color: #2bbac5;">|</span> <span style="color: #61afef;">Out-File</span><span style="color: #abb2bf;"> </span><span style="color: #89ca78;">&quot;<span style="color: #e5c07b;">$env:HOMEDRIVE</span>\file.txt&quot;</span><span style="color: #abb2bf;"> </span><span style="color: #7f848e;"># writes to another file</span>
</span><span class="athl-line" data-athl-line="403">
</span><span class="athl-line" data-athl-line="404"><span style="color: #7f848e;"># Read file contents and convert to json</span>
</span><span class="athl-line" data-athl-line="405"><span style="color: #61afef;">Get-Content</span><span style="color: #abb2bf;"> </span><span style="color: #89ca78;">&quot;<span style="color: #e5c07b;">$env:HOMEDRIVE</span>\file.csv&quot;</span><span style="color: #abb2bf;"> </span><span style="color: #2bbac5;">|</span> <span style="color: #61afef;">ConvertTo-Json</span>
</span><span class="athl-line" data-athl-line="406">
</span><span class="athl-line" data-athl-line="407">
</span><span class="athl-line" data-athl-line="408"><span style="color: #7f848e;">####################################################</span>
</span><span class="athl-line" data-athl-line="409"><span style="color: #7f848e;">## 4. Functions</span>
</span><span class="athl-line" data-athl-line="410"><span style="color: #7f848e;">####################################################</span>
</span><span class="athl-line" data-athl-line="411">
</span><span class="athl-line" data-athl-line="412"><span style="color: #7f848e;"># Use &quot;function&quot; to create new functions</span>
</span><span class="athl-line" data-athl-line="413"><span style="color: #7f848e;"># Keep the Verb-Noun naming convention for functions</span>
</span><span class="athl-line" data-athl-line="414"><span style="color: #d55fde;">function</span> <span style="color: #61afef;">Add-Numbers</span> <span style="color: #d55fde;">{</span>
</span><span class="athl-line" data-athl-line="415"> <span style="color: #e5c07b;">$args</span><span style="color: #d55fde;">[</span><span style="color: #d19a66;">0</span><span style="color: #d55fde;">]</span> <span style="color: #2bbac5;">+</span> <span style="color: #e5c07b;">$args</span><span style="color: #d55fde;">[</span><span style="color: #d19a66;">1</span><span style="color: #d55fde;">]</span>
</span><span class="athl-line" data-athl-line="416"><span style="color: #d55fde;">}</span>
</span><span class="athl-line" data-athl-line="417">
</span><span class="athl-line" data-athl-line="418"><span style="color: #61afef;">Add-Numbers</span><span style="color: #abb2bf;"> </span><span style="color: #d19a66;">1</span><span style="color: #abb2bf;"> </span><span style="color: #d19a66;">2</span><span style="color: #abb2bf;"> </span><span style="color: #7f848e;"># =&gt; 3</span>
</span><span class="athl-line" data-athl-line="419">
</span><span class="athl-line" data-athl-line="420"><span style="color: #7f848e;"># Calling functions with parameters</span>
</span><span class="athl-line" data-athl-line="421"><span style="color: #d55fde;">function</span> <span style="color: #61afef;">Add-ParamNumbers</span> <span style="color: #d55fde;">{</span>
</span><span class="athl-line" data-athl-line="422"> <span style="color: #d55fde;">param</span><span style="color: #d55fde;">(</span> <span style="color: #d55fde;">[</span><span style="color: #e5c07b;">int</span><span style="color: #d55fde;">]</span><span style="color: #ef596f;">$firstNumber</span><span style="color: #abb2bf;">,</span> <span style="color: #d55fde;">[</span><span style="color: #e5c07b;">int</span><span style="color: #d55fde;">]</span><span style="color: #ef596f;">$secondNumber</span> <span style="color: #d55fde;">)</span>
</span><span class="athl-line" data-athl-line="423"> <span style="color: #ef596f;">$firstNumber</span> <span style="color: #2bbac5;">+</span> <span style="color: #ef596f;">$secondNumber</span>
</span><span class="athl-line" data-athl-line="424"><span style="color: #d55fde;">}</span>
</span><span class="athl-line" data-athl-line="425">
</span><span class="athl-line" data-athl-line="426"><span style="color: #61afef;">Add-ParamNumbers</span><span style="color: #abb2bf;"> </span><span style="color: #61afef;">-FirstNumber</span><span style="color: #abb2bf;"> </span><span style="color: #d19a66;">1</span><span style="color: #abb2bf;"> </span><span style="color: #61afef;">-SecondNumber</span><span style="color: #abb2bf;"> </span><span style="color: #d19a66;">2</span><span style="color: #abb2bf;"> </span><span style="color: #7f848e;"># =&gt; 3 </span>
</span><span class="athl-line" data-athl-line="427">
</span><span class="athl-line" data-athl-line="428"><span style="color: #7f848e;"># Functions with named parameters, parameter attributes, parsable documentation</span>
</span><span class="athl-line" data-athl-line="429"><span style="color: #7f848e;">&lt;#</span>
</span><span class="athl-line" data-athl-line="430"><span style="color: #7f848e;">.SYNOPSIS</span>
</span><span class="athl-line" data-athl-line="431"><span style="color: #7f848e;">Setup a new website</span>
</span><span class="athl-line" data-athl-line="432"><span style="color: #7f848e;">.DESCRIPTION</span>
</span><span class="athl-line" data-athl-line="433"><span style="color: #7f848e;">Creates everything your new website needs for much win</span>
</span><span class="athl-line" data-athl-line="434"><span style="color: #7f848e;">.PARAMETER siteName</span>
</span><span class="athl-line" data-athl-line="435"><span style="color: #7f848e;">The name for the new website</span>
</span><span class="athl-line" data-athl-line="436"><span style="color: #7f848e;">.EXAMPLE</span>
</span><span class="athl-line" data-athl-line="437"><span style="color: #7f848e;">New-Website -Name FancySite -Po 5000</span>
</span><span class="athl-line" data-athl-line="438"><span style="color: #7f848e;">New-Website SiteWithDefaultPort</span>
</span><span class="athl-line" data-athl-line="439"><span style="color: #7f848e;">New-Website siteName 2000 # <span style="color: #7f848e;">ERROR</span>! Port argument could not be validated</span>
</span><span class="athl-line" data-athl-line="440"><span style="color: #7f848e;">(&#39;name1&#39;,&#39;name2&#39;) | New-Website -Verbose</span>
</span><span class="athl-line" data-athl-line="441"><span style="color: #7f848e;">#&gt;</span>
</span><span class="athl-line" data-athl-line="442"><span style="color: #d55fde;">function</span> <span style="color: #61afef;">New-Website</span><span style="color: #d55fde;">(</span><span style="color: #d55fde;">)</span> <span style="color: #d55fde;">{</span>
</span><span class="athl-line" data-athl-line="443">    <span style="color: #d55fde;">[</span><span style="color: #e5c07b;">CmdletBinding</span><span style="color: #d55fde;">(</span><span style="color: #d55fde;">)</span><span style="color: #d55fde;">]</span>
</span><span class="athl-line" data-athl-line="444">    <span style="color: #d55fde;">param</span> <span style="color: #d55fde;">(</span>
</span><span class="athl-line" data-athl-line="445">        <span style="color: #d55fde;">[</span><span style="color: #e5c07b;">Parameter</span><span style="color: #d55fde;">(</span>ValueFromPipeline<span style="color: #2bbac5;">=</span><span style="color: #d19a66;">$true</span><span style="color: #abb2bf;">,</span> Mandatory<span style="color: #2bbac5;">=</span><span style="color: #d19a66;">$true</span><span style="color: #d55fde;">)</span><span style="color: #d55fde;">]</span>
</span><span class="athl-line" data-athl-line="446">        <span style="color: #d55fde;">[</span><span style="color: #e5c07b;">Alias</span><span style="color: #d55fde;">(</span><span style="color: #89ca78;">&#39;name&#39;</span><span style="color: #d55fde;">)</span><span style="color: #d55fde;">]</span>
</span><span class="athl-line" data-athl-line="447">        <span style="color: #d55fde;">[</span><span style="color: #e5c07b;">string</span><span style="color: #d55fde;">]</span><span style="color: #ef596f;">$siteName</span><span style="color: #abb2bf;">,</span>
</span><span class="athl-line" data-athl-line="448">        <span style="color: #d55fde;">[</span><span style="color: #e5c07b;">ValidateSet</span><span style="color: #d55fde;">(</span><span style="color: #d19a66;">3000</span><span style="color: #abb2bf;">,</span><span style="color: #d19a66;">5000</span><span style="color: #abb2bf;">,</span><span style="color: #d19a66;">8000</span><span style="color: #d55fde;">)</span><span style="color: #d55fde;">]</span>
</span><span class="athl-line" data-athl-line="449">        <span style="color: #d55fde;">[</span><span style="color: #e5c07b;">int</span><span style="color: #d55fde;">]</span><span style="color: #ef596f;">$port</span> <span style="color: #2bbac5;">=</span> <span style="color: #d19a66;">3000</span>
</span><span class="athl-line" data-athl-line="450">    <span style="color: #d55fde;">)</span>
</span><span class="athl-line" data-athl-line="451">    <span style="color: #d55fde;">BEGIN</span> <span style="color: #d55fde;">{</span> <span style="color: #61afef;">Write-Output</span><span style="color: #abb2bf;"> </span><span style="color: #89ca78;">&#39;Creating new website(s)&#39;</span> <span style="color: #d55fde;">}</span>
</span><span class="athl-line" data-athl-line="452">    <span style="color: #d55fde;">PROCESS</span> <span style="color: #d55fde;">{</span> <span style="color: #61afef;">Write-Output</span><span style="color: #abb2bf;"> </span><span style="color: #89ca78;">&quot;name: <span style="color: #ef596f;">$siteName</span>, port: <span style="color: #ef596f;">$port</span>&quot;</span> <span style="color: #d55fde;">}</span>
</span><span class="athl-line" data-athl-line="453">    <span style="color: #d55fde;">END</span> <span style="color: #d55fde;">{</span> <span style="color: #61afef;">Write-Output</span><span style="color: #abb2bf;"> </span><span style="color: #89ca78;">&#39;Website(s) created&#39;</span> <span style="color: #d55fde;">}</span>
</span><span class="athl-line" data-athl-line="454"><span style="color: #d55fde;">}</span>
</span><span class="athl-line" data-athl-line="455">
</span><span class="athl-line" data-athl-line="456">
</span><span class="athl-line" data-athl-line="457"><span style="color: #7f848e;">####################################################</span>
</span><span class="athl-line" data-athl-line="458"><span style="color: #7f848e;">## 5. Modules</span>
</span><span class="athl-line" data-athl-line="459"><span style="color: #7f848e;">####################################################</span>
</span><span class="athl-line" data-athl-line="460">
</span><span class="athl-line" data-athl-line="461"><span style="color: #7f848e;"># You can import modules and install modules</span>
</span><span class="athl-line" data-athl-line="462"><span style="color: #7f848e;"># The Install-Module is similar to pip or npm, pulls from Powershell Gallery</span>
</span><span class="athl-line" data-athl-line="463"><span style="color: #e5c07b;">Install-Module</span><span style="color: #abb2bf;"> </span><span style="color: #ef596f;">dbaTools</span>
</span><span class="athl-line" data-athl-line="464"><span style="color: #e5c07b;">Import-Module</span><span style="color: #abb2bf;"> </span><span style="color: #ef596f;">dbaTools</span>
</span><span class="athl-line" data-athl-line="465">
</span><span class="athl-line" data-athl-line="466"><span style="color: #ef596f;">$query</span> <span style="color: #2bbac5;"><span style="color: #2bbac5;">=</span></span> <span style="color: #89ca78;">&quot;SELECT * FROM dbo.sometable&quot;</span>
</span><span class="athl-line" data-athl-line="467"><span style="color: #ef596f;">$queryParams</span> <span style="color: #2bbac5;"><span style="color: #2bbac5;">=</span></span> <span style="color: #abb2bf;">@{</span>
</span><span class="athl-line" data-athl-line="468">    <span style="color: #ef596f;">SqlInstance</span> <span style="color: #2bbac5;">=</span> <span style="color: #89ca78;">&#39;testInstance&#39;</span>
</span><span class="athl-line" data-athl-line="469">    <span style="color: #ef596f;">Database</span>    <span style="color: #2bbac5;">=</span> <span style="color: #89ca78;">&#39;testDatabase&#39;</span>
</span><span class="athl-line" data-athl-line="470">    <span style="color: #ef596f;">Query</span>       <span style="color: #2bbac5;">=</span> <span style="color: #ef596f;">$query</span>
</span><span class="athl-line" data-athl-line="471"><span style="color: #abb2bf;">}</span>
</span><span class="athl-line" data-athl-line="472"><span style="color: #61afef;">Invoke-DbaQuery</span><span style="color: #abb2bf;"> </span><span style="color: #ef596f;">@queryParams</span>
</span><span class="athl-line" data-athl-line="473">
</span><span class="athl-line" data-athl-line="474"><span style="color: #7f848e;"># You can get specific functions from a module</span>
</span><span class="athl-line" data-athl-line="475"><span style="color: #e5c07b;">Import-Module</span><span style="color: #abb2bf;"> </span><span style="color: #61afef;">-Function</span><span style="color: #abb2bf;"> </span><span style="color: #ef596f;">Invoke-DbaQuery</span>
</span><span class="athl-line" data-athl-line="476">
</span><span class="athl-line" data-athl-line="477">
</span><span class="athl-line" data-athl-line="478"><span style="color: #7f848e;"># Powershell modules are just ordinary Posh files. You</span>
</span><span class="athl-line" data-athl-line="479"><span style="color: #7f848e;"># can write your own, and import them. The name of the</span>
</span><span class="athl-line" data-athl-line="480"><span style="color: #7f848e;"># module is the same as the name of the file.</span>
</span><span class="athl-line" data-athl-line="481">
</span><span class="athl-line" data-athl-line="482"><span style="color: #7f848e;"># You can find out which functions and attributes</span>
</span><span class="athl-line" data-athl-line="483"><span style="color: #7f848e;"># are defined in a module.</span>
</span><span class="athl-line" data-athl-line="484"><span style="color: #61afef;">Get-Command</span><span style="color: #abb2bf;"> </span><span style="color: #61afef;">-module</span><span style="color: #abb2bf;"> </span><span style="color: #ef596f;">dbaTools</span>
</span><span class="athl-line" data-athl-line="485"><span style="color: #61afef;">Get-Help</span><span style="color: #abb2bf;"> </span><span style="color: #ef596f;">dbaTools</span><span style="color: #abb2bf;"> </span><span style="color: #61afef;">-Full</span>
</span><span class="athl-line" data-athl-line="486">
</span><span class="athl-line" data-athl-line="487">
</span><span class="athl-line" data-athl-line="488"><span style="color: #7f848e;">####################################################</span>
</span><span class="athl-line" data-athl-line="489"><span style="color: #7f848e;">## 6. Classes</span>
</span><span class="athl-line" data-athl-line="490"><span style="color: #7f848e;">####################################################</span>
</span><span class="athl-line" data-athl-line="491">
</span><span class="athl-line" data-athl-line="492"><span style="color: #7f848e;"># We use the &quot;class&quot; statement to create a class</span>
</span><span class="athl-line" data-athl-line="493"><span style="color: #d55fde;">class</span> <span style="color: #e5c07b;">Instrument</span> <span style="color: #d55fde;">{</span>
</span><span class="athl-line" data-athl-line="494">    <span style="color: #d55fde;">[</span><span style="color: #e5c07b;">string</span><span style="color: #d55fde;">]</span><span style="color: #ef596f;">$Type</span>
</span><span class="athl-line" data-athl-line="495">    <span style="color: #d55fde;">[</span><span style="color: #e5c07b;">string</span><span style="color: #d55fde;">]</span><span style="color: #ef596f;">$Family</span>
</span><span class="athl-line" data-athl-line="496"><span style="color: #d55fde;">}</span>
</span><span class="athl-line" data-athl-line="497">
</span><span class="athl-line" data-athl-line="498"><span style="color: #ef596f;">$instrument</span> <span style="color: #2bbac5;"><span style="color: #2bbac5;">=</span></span> <span style="color: #d55fde;">[</span><span style="color: #e5c07b;">Instrument</span><span style="color: #d55fde;">]</span><span style="color: #abb2bf;">::</span><span style="color: #e5c07b;">new</span><span style="color: #d55fde;">(</span><span style="color: #d55fde;">)</span>
</span><span class="athl-line" data-athl-line="499"><span style="color: #ef596f;">$instrument</span><span style="color: #abb2bf;">.</span><span style="color: #ef596f;">Type</span> <span style="color: #2bbac5;"><span style="color: #2bbac5;">=</span></span> <span style="color: #89ca78;">&quot;String Instrument&quot;</span>
</span><span class="athl-line" data-athl-line="500"><span style="color: #ef596f;">$instrument</span><span style="color: #abb2bf;">.</span><span style="color: #ef596f;">Family</span> <span style="color: #2bbac5;"><span style="color: #2bbac5;">=</span></span> <span style="color: #89ca78;">&quot;Plucked String&quot;</span>
</span><span class="athl-line" data-athl-line="501">
</span><span class="athl-line" data-athl-line="502"><span style="color: #ef596f;">$instrument</span>
</span><span class="athl-line" data-athl-line="503">
</span><span class="athl-line" data-athl-line="504"><span style="color: #7f848e;">&lt;# Output:</span>
</span><span class="athl-line" data-athl-line="505"><span style="color: #7f848e;">Type              Family        </span>
</span><span class="athl-line" data-athl-line="506"><span style="color: #7f848e;">----              ------        </span>
</span><span class="athl-line" data-athl-line="507"><span style="color: #7f848e;">String Instrument Plucked String</span>
</span><span class="athl-line" data-athl-line="508"><span style="color: #7f848e;">#&gt;</span>
</span><span class="athl-line" data-athl-line="509">
</span><span class="athl-line" data-athl-line="510">
</span><span class="athl-line" data-athl-line="511"><span style="color: #7f848e;">####################################################</span>
</span><span class="athl-line" data-athl-line="512"><span style="color: #7f848e;">## 6.1 Inheritance</span>
</span><span class="athl-line" data-athl-line="513"><span style="color: #7f848e;">####################################################</span>
</span><span class="athl-line" data-athl-line="514">
</span><span class="athl-line" data-athl-line="515"><span style="color: #7f848e;"># Inheritance allows new child classes to be defined that inherit </span>
</span><span class="athl-line" data-athl-line="516"><span style="color: #7f848e;"># methods and variables from their parent class.</span>
</span><span class="athl-line" data-athl-line="517">
</span><span class="athl-line" data-athl-line="518"><span style="color: #d55fde;">class</span> <span style="color: #e5c07b;">Guitar</span> : <span style="color: #e5c07b;">Instrument</span>
</span><span class="athl-line" data-athl-line="519"><span style="color: #d55fde;">{</span>
</span><span class="athl-line" data-athl-line="520">    <span style="color: #d55fde;">[</span><span style="color: #e5c07b;">string</span><span style="color: #d55fde;">]</span><span style="color: #ef596f;">$Brand</span>
</span><span class="athl-line" data-athl-line="521">    <span style="color: #d55fde;">[</span><span style="color: #e5c07b;">string</span><span style="color: #d55fde;">]</span><span style="color: #ef596f;">$SubType</span>
</span><span class="athl-line" data-athl-line="522">    <span style="color: #d55fde;">[</span><span style="color: #e5c07b;">string</span><span style="color: #d55fde;">]</span><span style="color: #ef596f;">$ModelType</span>
</span><span class="athl-line" data-athl-line="523">    <span style="color: #d55fde;">[</span><span style="color: #e5c07b;">string</span><span style="color: #d55fde;">]</span><span style="color: #ef596f;">$ModelNumber</span>
</span><span class="athl-line" data-athl-line="524"><span style="color: #d55fde;">}</span>
</span><span class="athl-line" data-athl-line="525">
</span><span class="athl-line" data-athl-line="526"><span style="color: #ef596f;">$myGuitar</span> <span style="color: #2bbac5;"><span style="color: #2bbac5;">=</span></span> <span style="color: #d55fde;">[</span><span style="color: #e5c07b;">Guitar</span><span style="color: #d55fde;">]</span><span style="color: #abb2bf;">::</span><span style="color: #e5c07b;">new</span><span style="color: #d55fde;">(</span><span style="color: #d55fde;">)</span>
</span><span class="athl-line" data-athl-line="527"><span style="color: #ef596f;">$myGuitar</span><span style="color: #abb2bf;">.</span><span style="color: #ef596f;">Brand</span>       <span style="color: #2bbac5;"><span style="color: #2bbac5;">=</span></span> <span style="color: #89ca78;">&quot;Taylor&quot;</span>
</span><span class="athl-line" data-athl-line="528"><span style="color: #ef596f;">$myGuitar</span><span style="color: #abb2bf;">.</span><span style="color: #ef596f;">SubType</span>     <span style="color: #2bbac5;"><span style="color: #2bbac5;">=</span></span> <span style="color: #89ca78;">&quot;Acoustic&quot;</span>
</span><span class="athl-line" data-athl-line="529"><span style="color: #ef596f;">$myGuitar</span><span style="color: #abb2bf;">.</span><span style="color: #ef596f;">ModelType</span>   <span style="color: #2bbac5;"><span style="color: #2bbac5;">=</span></span> <span style="color: #89ca78;">&quot;Presentation&quot;</span>
</span><span class="athl-line" data-athl-line="530"><span style="color: #ef596f;">$myGuitar</span><span style="color: #abb2bf;">.</span><span style="color: #ef596f;">ModelNumber</span> <span style="color: #2bbac5;"><span style="color: #2bbac5;">=</span></span> <span style="color: #89ca78;">&quot;PS14ce Blackwood&quot;</span>
</span><span class="athl-line" data-athl-line="531">
</span><span class="athl-line" data-athl-line="532"><span style="color: #ef596f;">$myGuitar</span><span style="color: #abb2bf;">.</span><span style="color: #61afef;">GetType</span><span style="color: #d55fde;">(</span><span style="color: #d55fde;">)</span>
</span><span class="athl-line" data-athl-line="533">
</span><span class="athl-line" data-athl-line="534"><span style="color: #7f848e;">&lt;#</span>
</span><span class="athl-line" data-athl-line="535"><span style="color: #7f848e;">IsPublic IsSerial Name                                     BaseType                                               </span>
</span><span class="athl-line" data-athl-line="536"><span style="color: #7f848e;">-------- -------- ----                                     --------                                               </span>
</span><span class="athl-line" data-athl-line="537"><span style="color: #7f848e;">True     False    Guitar                                   Instrument  </span>
</span><span class="athl-line" data-athl-line="538"><span style="color: #7f848e;">#&gt;</span>
</span><span class="athl-line" data-athl-line="539">
</span><span class="athl-line" data-athl-line="540">
</span><span class="athl-line" data-athl-line="541"><span style="color: #7f848e;">####################################################</span>
</span><span class="athl-line" data-athl-line="542"><span style="color: #7f848e;">## 7. Advanced</span>
</span><span class="athl-line" data-athl-line="543"><span style="color: #7f848e;">####################################################</span>
</span><span class="athl-line" data-athl-line="544">
</span><span class="athl-line" data-athl-line="545"><span style="color: #7f848e;"># The powershell pipeline allows things like High-Order Functions.</span>
</span><span class="athl-line" data-athl-line="546">
</span><span class="athl-line" data-athl-line="547"><span style="color: #7f848e;"># Group-Object is a handy cmdlet that does incredible things.</span>
</span><span class="athl-line" data-athl-line="548"><span style="color: #7f848e;"># It works much like a GROUP BY in SQL.</span>
</span><span class="athl-line" data-athl-line="549">
</span><span class="athl-line" data-athl-line="550"><span style="color: #7f848e;">&lt;#</span>
</span><span class="athl-line" data-athl-line="551"><span style="color: #7f848e;"> The following will get all the running processes,</span>
</span><span class="athl-line" data-athl-line="552"><span style="color: #7f848e;"> group them by Name,</span>
</span><span class="athl-line" data-athl-line="553"><span style="color: #7f848e;"> and tell us how many instances of each process we have running.</span>
</span><span class="athl-line" data-athl-line="554"><span style="color: #7f848e;"> Tip: Chrome and svcHost are usually big numbers in this regard.</span>
</span><span class="athl-line" data-athl-line="555"><span style="color: #7f848e;">#&gt;</span>
</span><span class="athl-line" data-athl-line="556"><span style="color: #61afef;">Get-Process</span><span style="color: #abb2bf;"> </span><span style="color: #2bbac5;">|</span> Foreach-Object <span style="color: #d55fde;">Process</span>Name <span style="color: #2bbac5;">|</span> <span style="color: #e5c07b;">Group-Object</span>
</span><span class="athl-line" data-athl-line="557">
</span><span class="athl-line" data-athl-line="558"><span style="color: #7f848e;"># Useful pipeline examples are iteration and filtering.</span>
</span><span class="athl-line" data-athl-line="559"><span style="color: #61afef;">1..10</span><span style="color: #abb2bf;"> </span><span style="color: #2bbac5;">|</span> ForEach-Object <span style="color: #d55fde;">{</span> <span style="color: #89ca78;">&quot;Loop number <span style="color: #ef596f;">$PSITEM</span>&quot;</span> <span style="color: #d55fde;">}</span>
</span><span class="athl-line" data-athl-line="560"><span style="color: #61afef;">1..10</span><span style="color: #abb2bf;"> </span><span style="color: #2bbac5;">|</span> <span style="color: #e5c07b;">Where-Object</span><span style="color: #abb2bf;"> </span><span style="color: #d55fde;">{</span> <span style="color: #ef596f;">$PSITEM</span> <span style="color: #2bbac5;">-gt</span> <span style="color: #d19a66;">5</span> <span style="color: #d55fde;">}</span><span style="color: #abb2bf;"> </span><span style="color: #2bbac5;">|</span> <span style="color: #61afef;">ConvertTo-Json</span>
</span><span class="athl-line" data-athl-line="561">
</span><span class="athl-line" data-athl-line="562"><span style="color: #7f848e;"># A notable pitfall of the pipeline is its performance when</span>
</span><span class="athl-line" data-athl-line="563"><span style="color: #7f848e;"># compared with other options.</span>
</span><span class="athl-line" data-athl-line="564"><span style="color: #7f848e;"># Additionally, raw bytes are not passed through the pipeline,</span>
</span><span class="athl-line" data-athl-line="565"><span style="color: #7f848e;"># so passing an image causes some issues.</span>
</span><span class="athl-line" data-athl-line="566"><span style="color: #7f848e;"># See more on that in the link at the bottom.</span>
</span><span class="athl-line" data-athl-line="567">
</span><span class="athl-line" data-athl-line="568"><span style="color: #7f848e;">&lt;#</span>
</span><span class="athl-line" data-athl-line="569"><span style="color: #7f848e;"> Asynchronous functions exist in the form of jobs.</span>
</span><span class="athl-line" data-athl-line="570"><span style="color: #7f848e;"> Typically a procedural language,</span>
</span><span class="athl-line" data-athl-line="571"><span style="color: #7f848e;"> Powershell can operate non-blocking functions when invoked as Jobs.</span>
</span><span class="athl-line" data-athl-line="572"><span style="color: #7f848e;">#&gt;</span>
</span><span class="athl-line" data-athl-line="573">
</span><span class="athl-line" data-athl-line="574"><span style="color: #7f848e;"># This function is known to be non-optimized, and therefore slow.</span>
</span><span class="athl-line" data-athl-line="575"><span style="color: #ef596f;">$installedApps</span> <span style="color: #2bbac5;"><span style="color: #2bbac5;">=</span></span> <span style="color: #61afef;">Get-CimInstance</span><span style="color: #abb2bf;"> </span><span style="color: #61afef;">-ClassName</span><span style="color: #abb2bf;"> </span><span style="color: #ef596f;">Win32_Product</span>
</span><span class="athl-line" data-athl-line="576">
</span><span class="athl-line" data-athl-line="577"><span style="color: #7f848e;"># If we had a script, it would hang at this func for a period of time.</span>
</span><span class="athl-line" data-athl-line="578"><span style="color: #ef596f;">$scriptBlock</span> <span style="color: #2bbac5;"><span style="color: #2bbac5;">=</span></span> <span style="color: #d55fde;">{</span><span style="color: #61afef;">Get-CimInstance</span><span style="color: #abb2bf;"> </span><span style="color: #61afef;">-ClassName</span><span style="color: #abb2bf;"> </span><span style="color: #ef596f;">Win32_Product</span><span style="color: #d55fde;">}</span>
</span><span class="athl-line" data-athl-line="579"><span style="color: #61afef;">Start-Job</span><span style="color: #abb2bf;"> </span><span style="color: #61afef;">-ScriptBlock</span><span style="color: #abb2bf;"> </span><span style="color: #ef596f;">$scriptBlock</span>
</span><span class="athl-line" data-athl-line="580">
</span><span class="athl-line" data-athl-line="581"><span style="color: #7f848e;"># This will start a background job that runs the command.</span>
</span><span class="athl-line" data-athl-line="582"><span style="color: #7f848e;"># You can then obtain the status of jobs and their returned results.</span>
</span><span class="athl-line" data-athl-line="583"><span style="color: #ef596f;">$allJobs</span> <span style="color: #2bbac5;"><span style="color: #2bbac5;">=</span></span> <span style="color: #61afef;">Get-Job</span>
</span><span class="athl-line" data-athl-line="584"><span style="color: #ef596f;">$jobResponse</span> <span style="color: #2bbac5;"><span style="color: #2bbac5;">=</span></span> <span style="color: #61afef;">Get-Job</span><span style="color: #abb2bf;"> </span><span style="color: #2bbac5;">|</span> <span style="color: #61afef;">Receive-Job</span>
</span><span class="athl-line" data-athl-line="585">
</span><span class="athl-line" data-athl-line="586">
</span><span class="athl-line" data-athl-line="587"><span style="color: #7f848e;"># Math is built in to powershell and has many functions.</span>
</span><span class="athl-line" data-athl-line="588"><span style="color: #ef596f;">$r</span><span style="color: #2bbac5;"><span style="color: #2bbac5;">=</span></span><span style="color: #d19a66;">2</span>
</span><span class="athl-line" data-athl-line="589"><span style="color: #ef596f;">$pi</span><span style="color: #2bbac5;"><span style="color: #2bbac5;">=</span></span><span style="color: #d55fde;">[</span><span style="color: #e5c07b;">math</span><span style="color: #d55fde;">]</span><span style="color: #abb2bf;">::</span><span style="color: #ef596f;">pi</span>
</span><span class="athl-line" data-athl-line="590"><span style="color: #ef596f;">$r2</span><span style="color: #2bbac5;"><span style="color: #2bbac5;">=</span></span><span style="color: #d55fde;">[</span><span style="color: #e5c07b;">math</span><span style="color: #d55fde;">]</span><span style="color: #abb2bf;">::</span><span style="color: #61afef;">pow</span><span style="color: #d55fde;">(</span> <span style="color: #ef596f;">$r</span><span style="color: #abb2bf;">,</span> <span style="color: #d19a66;">2</span> <span style="color: #d55fde;">)</span>
</span><span class="athl-line" data-athl-line="591"><span style="color: #ef596f;">$area</span> <span style="color: #2bbac5;"><span style="color: #2bbac5;">=</span></span> <span style="color: #ef596f;">$pi</span><span style="color: #2bbac5;">*</span><span style="color: #ef596f;">$r2</span>
</span><span class="athl-line" data-athl-line="592"><span style="color: #ef596f;">$area</span>
</span><span class="athl-line" data-athl-line="593">
</span><span class="athl-line" data-athl-line="594"><span style="color: #7f848e;"># To see all possibilities, check the members.</span>
</span><span class="athl-line" data-athl-line="595"><span style="color: #d55fde;">[</span><span style="color: #e5c07b;">System<span style="color: #abb2bf;">.</span>Math</span><span style="color: #d55fde;">]</span> <span style="color: #2bbac5;">|</span> <span style="color: #61afef;">Get-Member</span><span style="color: #abb2bf;"> </span><span style="color: #61afef;">-Static</span><span style="color: #abb2bf;"> </span><span style="color: #61afef;">-MemberType</span><span style="color: #abb2bf;"> </span><span style="color: #ef596f;">All</span>
</span><span class="athl-line" data-athl-line="596">
</span><span class="athl-line" data-athl-line="597">
</span><span class="athl-line" data-athl-line="598"><span style="color: #7f848e;">&lt;#</span>
</span><span class="athl-line" data-athl-line="599"><span style="color: #7f848e;"> This is a silly one:</span>
</span><span class="athl-line" data-athl-line="600"><span style="color: #7f848e;"> You may one day be asked to create a func that could take $start and $end</span>
</span><span class="athl-line" data-athl-line="601"><span style="color: #7f848e;"> and reverse anything in an array within the given range</span>
</span><span class="athl-line" data-athl-line="602"><span style="color: #7f848e;"> based on an arbitrary array without mutating the original array.</span>
</span><span class="athl-line" data-athl-line="603"><span style="color: #7f848e;"> Let&#39;s see one way to do that and introduce another data structure.</span>
</span><span class="athl-line" data-athl-line="604"><span style="color: #7f848e;">#&gt;</span>
</span><span class="athl-line" data-athl-line="605">
</span><span class="athl-line" data-athl-line="606"><span style="color: #ef596f;">$targetArray</span> <span style="color: #2bbac5;"><span style="color: #2bbac5;">=</span></span> <span style="color: #89ca78;">&#39;a&#39;</span><span style="color: #abb2bf;">,</span><span style="color: #89ca78;">&#39;b&#39;</span><span style="color: #abb2bf;">,</span><span style="color: #89ca78;">&#39;c&#39;</span><span style="color: #abb2bf;">,</span><span style="color: #89ca78;">&#39;d&#39;</span><span style="color: #abb2bf;">,</span><span style="color: #89ca78;">&#39;e&#39;</span><span style="color: #abb2bf;">,</span><span style="color: #89ca78;">&#39;f&#39;</span><span style="color: #abb2bf;">,</span><span style="color: #89ca78;">&#39;g&#39;</span><span style="color: #abb2bf;">,</span><span style="color: #89ca78;">&#39;h&#39;</span><span style="color: #abb2bf;">,</span><span style="color: #89ca78;">&#39;i&#39;</span><span style="color: #abb2bf;">,</span><span style="color: #89ca78;">&#39;j&#39;</span><span style="color: #abb2bf;">,</span><span style="color: #89ca78;">&#39;k&#39;</span><span style="color: #abb2bf;">,</span><span style="color: #89ca78;">&#39;l&#39;</span><span style="color: #abb2bf;">,</span><span style="color: #89ca78;">&#39;m&#39;</span>
</span><span class="athl-line" data-athl-line="607">
</span><span class="athl-line" data-athl-line="608"><span style="color: #d55fde;">function</span> <span style="color: #61afef;">Format-Range</span> <span style="color: #d55fde;">(</span><span style="color: #ef596f;">$start</span><span style="color: #abb2bf;">,</span> <span style="color: #ef596f;">$end</span><span style="color: #abb2bf;">,</span> <span style="color: #ef596f;">$array</span><span style="color: #d55fde;">)</span> <span style="color: #d55fde;">{</span>
</span><span class="athl-line" data-athl-line="609">    <span style="color: #d55fde;">[</span><span style="color: #e5c07b;">System<span style="color: #abb2bf;">.</span>Collections<span style="color: #abb2bf;">.</span>ArrayList</span><span style="color: #d55fde;">]</span><span style="color: #ef596f;">$firstSectionArray</span> <span style="color: #2bbac5;"><span style="color: #2bbac5;">=</span></span> <span style="color: #abb2bf;">@(</span><span style="color: #abb2bf;">)</span>
</span><span class="athl-line" data-athl-line="610">    <span style="color: #d55fde;">[</span><span style="color: #e5c07b;">System<span style="color: #abb2bf;">.</span>Collections<span style="color: #abb2bf;">.</span>ArrayList</span><span style="color: #d55fde;">]</span><span style="color: #ef596f;">$secondSectionArray</span> <span style="color: #2bbac5;"><span style="color: #2bbac5;">=</span></span> <span style="color: #abb2bf;">@(</span><span style="color: #abb2bf;">)</span>
</span><span class="athl-line" data-athl-line="611">    <span style="color: #d55fde;">[</span><span style="color: #e5c07b;">System<span style="color: #abb2bf;">.</span>Collections<span style="color: #abb2bf;">.</span>Stack</span><span style="color: #d55fde;">]</span><span style="color: #ef596f;">$stack</span> <span style="color: #2bbac5;"><span style="color: #2bbac5;">=</span></span> <span style="color: #abb2bf;">@(</span><span style="color: #abb2bf;">)</span>
</span><span class="athl-line" data-athl-line="612">    <span style="color: #d55fde;">for</span> <span style="color: #d55fde;">(</span><span style="color: #ef596f;">$index</span> <span style="color: #2bbac5;"><span style="color: #2bbac5;">=</span></span> <span style="color: #d19a66;">0</span><span style="color: #abb2bf;">;</span> <span style="color: #ef596f;">$index</span> <span style="color: #2bbac5;">-lt</span> <span style="color: #ef596f;">$array</span><span style="color: #abb2bf;">.</span><span style="color: #ef596f;">Count</span><span style="color: #abb2bf;">;</span> <span style="color: #2bbac5;"><span style="color: #ef596f;">$index</span>++</span><span style="color: #d55fde;">)</span> <span style="color: #d55fde;">{</span>
</span><span class="athl-line" data-athl-line="613">        <span style="color: #d55fde;">if</span> <span style="color: #d55fde;">(</span><span style="color: #ef596f;">$index</span> <span style="color: #2bbac5;">-lt</span> <span style="color: #ef596f;">$start</span><span style="color: #d55fde;">)</span> <span style="color: #d55fde;">{</span>
</span><span class="athl-line" data-athl-line="614">            <span style="color: #ef596f;">$firstSectionArray</span><span style="color: #abb2bf;">.</span><span style="color: #61afef;">Add</span><span style="color: #d55fde;">(</span><span style="color: #ef596f;">$array</span><span style="color: #d55fde;">[</span><span style="color: #ef596f;">$index</span><span style="color: #d55fde;">]</span><span style="color: #d55fde;">)</span> &gt;<span style="color: #abb2bf;"> </span><span style="color: #e5c07b;">$null</span>
</span><span class="athl-line" data-athl-line="615">        <span style="color: #d55fde;">}</span>
</span><span class="athl-line" data-athl-line="616">        <span style="color: #d55fde;">elseif</span> <span style="color: #d55fde;">(</span><span style="color: #ef596f;">$index</span> <span style="color: #2bbac5;">-ge</span> <span style="color: #ef596f;">$start</span> <span style="color: #2bbac5;">-and</span> <span style="color: #ef596f;">$index</span> <span style="color: #2bbac5;">-le</span> <span style="color: #ef596f;">$end</span><span style="color: #d55fde;">)</span> <span style="color: #d55fde;">{</span>
</span><span class="athl-line" data-athl-line="617">            <span style="color: #ef596f;">$stack</span><span style="color: #abb2bf;">.</span><span style="color: #61afef;">Push</span><span style="color: #d55fde;">(</span><span style="color: #ef596f;">$array</span><span style="color: #d55fde;">[</span><span style="color: #ef596f;">$index</span><span style="color: #d55fde;">]</span><span style="color: #d55fde;">)</span>
</span><span class="athl-line" data-athl-line="618">        <span style="color: #d55fde;">}</span>
</span><span class="athl-line" data-athl-line="619">        <span style="color: #d55fde;">else</span> <span style="color: #d55fde;">{</span>
</span><span class="athl-line" data-athl-line="620">            <span style="color: #ef596f;">$secondSectionArray</span><span style="color: #abb2bf;">.</span><span style="color: #61afef;">Add</span><span style="color: #d55fde;">(</span><span style="color: #ef596f;">$array</span><span style="color: #d55fde;">[</span><span style="color: #ef596f;">$index</span><span style="color: #d55fde;">]</span><span style="color: #d55fde;">)</span> &gt;<span style="color: #abb2bf;"> </span><span style="color: #e5c07b;">$null</span>
</span><span class="athl-line" data-athl-line="621">        <span style="color: #d55fde;">}</span>
</span><span class="athl-line" data-athl-line="622">    <span style="color: #d55fde;">}</span>
</span><span class="athl-line" data-athl-line="623">    <span style="color: #ef596f;">$finalArray</span> <span style="color: #2bbac5;"><span style="color: #2bbac5;">=</span></span> <span style="color: #ef596f;">$firstSectionArray</span> <span style="color: #2bbac5;">+</span> <span style="color: #ef596f;">$stack</span><span style="color: #abb2bf;">.</span><span style="color: #61afef;">ToArray</span><span style="color: #d55fde;">(</span><span style="color: #d55fde;">)</span> <span style="color: #2bbac5;">+</span> <span style="color: #ef596f;">$secondSectionArray</span>
</span><span class="athl-line" data-athl-line="624">    <span style="color: #d55fde;">return</span> <span style="color: #ef596f;">$finalArray</span>
</span><span class="athl-line" data-athl-line="625"><span style="color: #d55fde;">}</span>
</span><span class="athl-line" data-athl-line="626">
</span><span class="athl-line" data-athl-line="627"><span style="color: #d55fde;">For</span>mat<span style="color: #61afef;">-Range</span> 2 6 <span style="color: #ef596f;">$targetArray</span> 
</span><span class="athl-line" data-athl-line="628"><span style="color: #7f848e;"># =&gt; &#39;a&#39;,&#39;b&#39;,&#39;g&#39;,&#39;f&#39;,&#39;e&#39;,&#39;d&#39;,&#39;c&#39;,&#39;h&#39;,&#39;i&#39;,&#39;j&#39;,&#39;k&#39;,&#39;l&#39;,&#39;m&#39;</span>
</span><span class="athl-line" data-athl-line="629">
</span><span class="athl-line" data-athl-line="630"><span style="color: #7f848e;"># The previous method works, but uses extra memory by allocating new arrays.</span>
</span><span class="athl-line" data-athl-line="631"><span style="color: #7f848e;"># It&#39;s also kind of lengthy.</span>
</span><span class="athl-line" data-athl-line="632"><span style="color: #7f848e;"># Let&#39;s see how we can do this without allocating a new array.</span>
</span><span class="athl-line" data-athl-line="633"><span style="color: #7f848e;"># This is slightly faster as well.</span>
</span><span class="athl-line" data-athl-line="634">
</span><span class="athl-line" data-athl-line="635"><span style="color: #d55fde;">function</span> <span style="color: #61afef;">Format-Range</span> <span style="color: #d55fde;">(</span><span style="color: #ef596f;">$start</span><span style="color: #abb2bf;">,</span> <span style="color: #ef596f;">$end</span><span style="color: #d55fde;">)</span> <span style="color: #d55fde;">{</span>
</span><span class="athl-line" data-athl-line="636">  <span style="color: #d55fde;">while</span> <span style="color: #d55fde;">(</span><span style="color: #ef596f;">$start</span> <span style="color: #2bbac5;">-lt</span> <span style="color: #ef596f;">$end</span><span style="color: #d55fde;">)</span>
</span><span class="athl-line" data-athl-line="637">  <span style="color: #d55fde;">{</span>
</span><span class="athl-line" data-athl-line="638">      <span style="color: #ef596f;">$temp</span> <span style="color: #2bbac5;"><span style="color: #2bbac5;">=</span></span> <span style="color: #ef596f;">$targetArray</span><span style="color: #d55fde;">[</span><span style="color: #ef596f;">$start</span><span style="color: #d55fde;">]</span>
</span><span class="athl-line" data-athl-line="639">      <span style="color: #ef596f;">$targetArray</span><span style="color: #d55fde;">[</span><span style="color: #ef596f;">$start</span><span style="color: #d55fde;">]</span> <span style="color: #2bbac5;"><span style="color: #2bbac5;">=</span></span> <span style="color: #ef596f;">$targetArray</span><span style="color: #d55fde;">[</span><span style="color: #ef596f;">$end</span><span style="color: #d55fde;">]</span>
</span><span class="athl-line" data-athl-line="640">      <span style="color: #ef596f;">$targetArray</span><span style="color: #d55fde;">[</span><span style="color: #ef596f;">$end</span><span style="color: #d55fde;">]</span> <span style="color: #2bbac5;"><span style="color: #2bbac5;">=</span></span> <span style="color: #ef596f;">$temp</span>
</span><span class="athl-line" data-athl-line="641">      <span style="color: #2bbac5;"><span style="color: #ef596f;">$start</span>++</span>
</span><span class="athl-line" data-athl-line="642">      <span style="color: #2bbac5;"><span style="color: #ef596f;">$end</span>--</span>
</span><span class="athl-line" data-athl-line="643">  <span style="color: #d55fde;">}</span>
</span><span class="athl-line" data-athl-line="644">  <span style="color: #d55fde;">return</span> <span style="color: #ef596f;">$targetArray</span>
</span><span class="athl-line" data-athl-line="645"><span style="color: #d55fde;">}</span>
</span><span class="athl-line" data-athl-line="646">
</span><span class="athl-line" data-athl-line="647"><span style="color: #d55fde;">For</span>mat<span style="color: #61afef;">-Range</span> 2 6<span style="color: #7f848e;"> # =&gt; &#39;a&#39;,&#39;b&#39;,&#39;g&#39;,&#39;f&#39;,&#39;e&#39;,&#39;d&#39;,&#39;c&#39;,&#39;h&#39;,&#39;i&#39;,&#39;j&#39;,&#39;k&#39;,&#39;l&#39;,&#39;m&#39;</span>
</span><span class="athl-line" data-athl-line="648">```
</span><span class="athl-line" data-athl-line="649">
</span><span class="athl-line" data-athl-line="650">Powershell as a Tool:
</span><span class="athl-line" data-athl-line="651">
</span><span class="athl-line" data-athl-line="652">Getting Help:
</span><span class="athl-line" data-athl-line="653">
</span><span class="athl-line" data-athl-line="654">```powershell<span style="color: #7f848e;"></span>
</span><span class="athl-line" data-athl-line="655"><span style="color: #7f848e;"># Find commands</span>
</span><span class="athl-line" data-athl-line="656">Get<span style="color: #61afef;">-Command</span> about_<span style="color: #2bbac5;">*</span><span style="color: #7f848e;"> # alias: gcm</span>
</span><span class="athl-line" data-athl-line="657">Get<span style="color: #61afef;">-Command</span><span style="color: #61afef;"> -Verb</span> Add
</span><span class="athl-line" data-athl-line="658">Get<span style="color: #61afef;">-Alias</span> ps
</span><span class="athl-line" data-athl-line="659">Get<span style="color: #61afef;">-Alias</span><span style="color: #61afef;"> -Definition</span> Get<span style="color: #61afef;">-Process</span>
</span><span class="athl-line" data-athl-line="660">
</span><span class="athl-line" data-athl-line="661">Get<span style="color: #61afef;">-Help</span> ps<span style="color: #2bbac5;"> |</span> less<span style="color: #7f848e;"> # alias: help</span>
</span><span class="athl-line" data-athl-line="662">ps<span style="color: #2bbac5;"> |</span> Get<span style="color: #61afef;">-Member</span><span style="color: #7f848e;"> # alias: gm</span>
</span><span class="athl-line" data-athl-line="663">
</span><span class="athl-line" data-athl-line="664">Show<span style="color: #61afef;">-Command</span> Get<span style="color: #61afef;">-WinEvent</span><span style="color: #7f848e;"> # Display GUI to fill in the parameters</span>
</span><span class="athl-line" data-athl-line="665">
</span><span class="athl-line" data-athl-line="666">Update<span style="color: #61afef;">-Help</span><span style="color: #7f848e;"> # Run as admin</span>
</span><span class="athl-line" data-athl-line="667">```
</span><span class="athl-line" data-athl-line="668">
</span><span class="athl-line" data-athl-line="669"><span style="color: #d55fde;">If</span> you are uncertain about your environment:
</span><span class="athl-line" data-athl-line="670">
</span><span class="athl-line" data-athl-line="671">```powershell
</span><span class="athl-line" data-athl-line="672">Get<span style="color: #61afef;">-ExecutionPolicy</span><span style="color: #61afef;"> -List</span>
</span><span class="athl-line" data-athl-line="673">Set<span style="color: #61afef;">-ExecutionPolicy</span> AllSigned<span style="color: #7f848e;"></span>
</span><span class="athl-line" data-athl-line="674"><span style="color: #7f848e;"># Execution policies include:</span><span style="color: #7f848e;"></span>
</span><span class="athl-line" data-athl-line="675"><span style="color: #7f848e;"># - Restricted: Scripts won&#39;t run.</span><span style="color: #7f848e;"></span>
</span><span class="athl-line" data-athl-line="676"><span style="color: #7f848e;"># - RemoteSigned: Downloaded scripts run only if signed by a trusted publisher. </span><span style="color: #7f848e;"></span>
</span><span class="athl-line" data-athl-line="677"><span style="color: #7f848e;"># - AllSigned: Scripts need to be signed by a trusted publisher.</span><span style="color: #7f848e;"></span>
</span><span class="athl-line" data-athl-line="678"><span style="color: #7f848e;"># - Unrestricted: Run all scripts.</span>
</span><span class="athl-line" data-athl-line="679">help about_Execution_Policies<span style="color: #7f848e;"> # for more info</span><span style="color: #7f848e;"></span>
</span><span class="athl-line" data-athl-line="680"><span style="color: #7f848e;"></span>
</span><span class="athl-line" data-athl-line="681"><span style="color: #7f848e;"># Current PowerShell version:</span>
</span><span class="athl-line" data-athl-line="682"><span style="color: #e5c07b;">$PSVersionTable</span>
</span><span class="athl-line" data-athl-line="683">```
</span><span class="athl-line" data-athl-line="684">
</span><span class="athl-line" data-athl-line="685">```powershell<span style="color: #7f848e;"></span>
</span><span class="athl-line" data-athl-line="686"><span style="color: #7f848e;"># Calling external commands, executables, </span><span style="color: #7f848e;"></span>
</span><span class="athl-line" data-athl-line="687"><span style="color: #7f848e;"># and functions with the call operator.</span><span style="color: #7f848e;"></span>
</span><span class="athl-line" data-athl-line="688"><span style="color: #7f848e;"># Exe paths with arguments passed or containing spaces can create issues.</span>
</span><span class="athl-line" data-athl-line="689">C:<span style="color: #2bbac5;">\</span>Program Files<span style="color: #2bbac5;">\</span><span style="color: #d55fde;">do</span>tnet<span style="color: #2bbac5;">\</span><span style="color: #d55fde;">do</span>tnet<span style="color: #abb2bf;">.</span>exe<span style="color: #7f848e;"></span>
</span><span class="athl-line" data-athl-line="690"><span style="color: #7f848e;"># The term &#39;C:\Program&#39; is not recognized as a name of a cmdlet,</span><span style="color: #7f848e;"></span>
</span><span class="athl-line" data-athl-line="691"><span style="color: #7f848e;"># function, script file, or executable program.</span><span style="color: #7f848e;"></span>
</span><span class="athl-line" data-athl-line="692"><span style="color: #7f848e;"># Check the spelling of the name, or if a path was included, </span><span style="color: #7f848e;"></span>
</span><span class="athl-line" data-athl-line="693"><span style="color: #7f848e;"># verify that the path is correct and try again</span>
</span><span class="athl-line" data-athl-line="694">
</span><span class="athl-line" data-athl-line="695">&quot;C:<span style="color: #2bbac5;">\</span>Program Files<span style="color: #2bbac5;">\</span><span style="color: #d55fde;">do</span>tnet<span style="color: #2bbac5;">\</span><span style="color: #d55fde;">do</span>tnet<span style="color: #abb2bf;">.</span>exe&quot;
</span><span class="athl-line" data-athl-line="696">C:<span style="color: #2bbac5;">\</span>Program Files<span style="color: #2bbac5;">\</span><span style="color: #d55fde;">do</span>tnet<span style="color: #2bbac5;">\</span><span style="color: #d55fde;">do</span>tnet<span style="color: #abb2bf;">.</span>exe<span style="color: #7f848e;">    # returns string rather than execute</span>
</span><span class="athl-line" data-athl-line="697">
</span><span class="athl-line" data-athl-line="698"><span style="color: #2bbac5;">&amp;</span><span style="color: #89ca78;">&quot;C:\Program Files\dotnet\dotnet.exe --help&quot;</span><span style="color: #abb2bf;">   </span><span style="color: #7f848e;"># fail</span>
</span><span class="athl-line" data-athl-line="699"><span style="color: #2bbac5;">&amp;</span><span style="color: #89ca78;">&quot;C:\Program Files\dotnet\dotnet.exe&quot;</span><span style="color: #abb2bf;"> </span><span style="color: #61afef;">--help</span><span style="color: #abb2bf;">   </span><span style="color: #7f848e;"># success</span>
</span><span class="athl-line" data-athl-line="700"><span style="color: #7f848e;"># Alternatively, you can use dot-sourcing here</span>
</span><span class="athl-line" data-athl-line="701"><span style="color: #abb2bf;"><span style="color: #2bbac5;">.</span></span><span style="color: #89ca78;">&quot;C:\Program Files\dotnet\dotnet.exe&quot;</span><span style="color: #abb2bf;"> </span><span style="color: #61afef;">--help</span><span style="color: #abb2bf;">   </span><span style="color: #7f848e;"># success</span>
</span><span class="athl-line" data-athl-line="702">
</span><span class="athl-line" data-athl-line="703"><span style="color: #7f848e;"># the call operator (&amp;) is similar to Invoke-Expression, </span>
</span><span class="athl-line" data-athl-line="704"><span style="color: #7f848e;"># but IEX runs in current scope.</span>
</span><span class="athl-line" data-athl-line="705"><span style="color: #7f848e;"># One usage of &#39;&amp;&#39; would be to invoke a scriptblock inside of your script.</span>
</span><span class="athl-line" data-athl-line="706"><span style="color: #7f848e;"># Notice the variables are scoped</span>
</span><span class="athl-line" data-athl-line="707"><span style="color: #ef596f;">$i</span> <span style="color: #2bbac5;"><span style="color: #2bbac5;">=</span></span> <span style="color: #d19a66;">2</span>
</span><span class="athl-line" data-athl-line="708"><span style="color: #ef596f;">$scriptBlock</span> <span style="color: #2bbac5;"><span style="color: #2bbac5;">=</span></span> <span style="color: #d55fde;">{</span> <span style="color: #ef596f;">$i</span><span style="color: #2bbac5;"><span style="color: #2bbac5;">=</span></span><span style="color: #d19a66;">5</span><span style="color: #abb2bf;"><span style="color: #abb2bf;">;</span></span> <span style="color: #61afef;">Write-Output</span><span style="color: #abb2bf;"> </span><span style="color: #ef596f;">$i</span> <span style="color: #d55fde;">}</span>
</span><span class="athl-line" data-athl-line="709"><span style="color: #2bbac5;">&amp;</span> <span style="color: #ef596f;">$scriptBlock</span><span style="color: #abb2bf;"> </span><span style="color: #7f848e;"># =&gt; 5</span>
</span><span class="athl-line" data-athl-line="710"><span style="color: #ef596f;">$i</span> <span style="color: #7f848e;"># =&gt; 2</span>
</span><span class="athl-line" data-athl-line="711">
</span><span class="athl-line" data-athl-line="712"><span style="color: #61afef;">invoke-expression</span><span style="color: #abb2bf;"> </span><span style="color: #89ca78;">&#39; $i=5; Write-Output $i &#39;</span><span style="color: #abb2bf;"> </span><span style="color: #7f848e;"># =&gt; 5</span>
</span><span class="athl-line" data-athl-line="713"><span style="color: #ef596f;">$i</span> <span style="color: #7f848e;"># =&gt; 5</span>
</span><span class="athl-line" data-athl-line="714">
</span><span class="athl-line" data-athl-line="715"><span style="color: #7f848e;"># Alternatively, to preserve changes to public variables</span>
</span><span class="athl-line" data-athl-line="716"><span style="color: #7f848e;"># you can use &quot;Dot-Sourcing&quot;. This will run in the current scope.</span>
</span><span class="athl-line" data-athl-line="717"><span style="color: #ef596f;">$x</span><span style="color: #2bbac5;"><span style="color: #2bbac5;">=</span></span><span style="color: #d19a66;">1</span>
</span><span class="athl-line" data-athl-line="718"><span style="color: #2bbac5;">&amp;</span><span style="color: #d55fde;">{</span><span style="color: #ef596f;">$x</span><span style="color: #2bbac5;"><span style="color: #2bbac5;">=</span></span><span style="color: #d19a66;">2</span><span style="color: #d55fde;">}</span><span style="color: #abb2bf;"><span style="color: #abb2bf;">;</span></span><span style="color: #ef596f;">$x</span> <span style="color: #7f848e;"># =&gt; 1</span>
</span><span class="athl-line" data-athl-line="719">
</span><span class="athl-line" data-athl-line="720"><span style="color: #abb2bf;"><span style="color: #2bbac5;">.</span></span><span style="color: #d55fde;">{</span><span style="color: #ef596f;">$x</span><span style="color: #2bbac5;"><span style="color: #2bbac5;">=</span></span><span style="color: #d19a66;">2</span><span style="color: #d55fde;">}</span><span style="color: #abb2bf;"><span style="color: #abb2bf;">;</span></span><span style="color: #ef596f;">$x</span> <span style="color: #7f848e;"># =&gt; 2</span>
</span><span class="athl-line" data-athl-line="721">
</span><span class="athl-line" data-athl-line="722">
</span><span class="athl-line" data-athl-line="723"><span style="color: #7f848e;"># Remoting into computers is easy.</span>
</span><span class="athl-line" data-athl-line="724"><span style="color: #61afef;">Enter-PSSession</span><span style="color: #abb2bf;"> </span><span style="color: #61afef;">-ComputerName</span><span style="color: #abb2bf;"> </span><span style="color: #ef596f;">RemoteComputer</span>
</span><span class="athl-line" data-athl-line="725">
</span><span class="athl-line" data-athl-line="726"><span style="color: #7f848e;"># Once remoted in, you can run commands as if you&#39;re local.</span>
</span><span class="athl-line" data-athl-line="727"><span style="color: #61afef;">RemoteComputer\PS&gt;</span><span style="color: #abb2bf;"> </span><span style="color: #ef596f;">Get-Process</span><span style="color: #abb2bf;"> </span><span style="color: #ef596f;">powershell</span>
</span><span class="athl-line" data-athl-line="728">
</span><span class="athl-line" data-athl-line="729"><span style="color: #7f848e;">&lt;#</span>
</span><span class="athl-line" data-athl-line="730"><span style="color: #7f848e;">Handles  NPM(K)    PM(K)      WS(K)     CPU(s)     Id  SI ProcessName                                             </span>
</span><span class="athl-line" data-athl-line="731"><span style="color: #7f848e;">-------  ------    -----      -----     ------     --  -- -----------                                             </span>
</span><span class="athl-line" data-athl-line="732"><span style="color: #7f848e;">   1096      44   156324     179068      29.92  11772   1 powershell                                              </span>
</span><span class="athl-line" data-athl-line="733"><span style="color: #7f848e;">    545      25    49512      49852             25348   0 powershell </span>
</span><span class="athl-line" data-athl-line="734"><span style="color: #7f848e;">#&gt;</span>
</span><span class="athl-line" data-athl-line="735"><span style="color: #61afef;">RemoteComputer\PS&gt;</span><span style="color: #abb2bf;"> </span><span style="color: #ef596f;">Exit-PSSession</span>
</span><span class="athl-line" data-athl-line="736">
</span><span class="athl-line" data-athl-line="737"><span style="color: #7f848e;">&lt;#</span>
</span><span class="athl-line" data-athl-line="738"><span style="color: #7f848e;"> Powershell is an incredible tool for Windows management and Automation.</span>
</span><span class="athl-line" data-athl-line="739"><span style="color: #7f848e;"> Let&#39;s take the following scenario:</span>
</span><span class="athl-line" data-athl-line="740"><span style="color: #7f848e;"> You have 10 servers.</span>
</span><span class="athl-line" data-athl-line="741"><span style="color: #7f848e;"> You need to check whether a service is running on all of them.</span>
</span><span class="athl-line" data-athl-line="742"><span style="color: #7f848e;"> You can RDP and log in, or PSSession to all of them, but why?</span>
</span><span class="athl-line" data-athl-line="743"><span style="color: #7f848e;"> Check out the following</span>
</span><span class="athl-line" data-athl-line="744"><span style="color: #7f848e;">#&gt;</span>
</span><span class="athl-line" data-athl-line="745">
</span><span class="athl-line" data-athl-line="746"><span style="color: #ef596f;">$serverList</span> <span style="color: #2bbac5;"><span style="color: #2bbac5;">=</span></span> <span style="color: #abb2bf;">@(</span>
</span><span class="athl-line" data-athl-line="747">    <span style="color: #89ca78;">&#39;server1&#39;</span><span style="color: #abb2bf;">,</span>
</span><span class="athl-line" data-athl-line="748">    <span style="color: #89ca78;">&#39;server2&#39;</span><span style="color: #abb2bf;">,</span>
</span><span class="athl-line" data-athl-line="749">    <span style="color: #89ca78;">&#39;server3&#39;</span><span style="color: #abb2bf;">,</span>
</span><span class="athl-line" data-athl-line="750">    <span style="color: #89ca78;">&#39;server4&#39;</span><span style="color: #abb2bf;">,</span>
</span><span class="athl-line" data-athl-line="751">    <span style="color: #89ca78;">&#39;server5&#39;</span><span style="color: #abb2bf;">,</span>
</span><span class="athl-line" data-athl-line="752">    <span style="color: #89ca78;">&#39;server6&#39;</span><span style="color: #abb2bf;">,</span>
</span><span class="athl-line" data-athl-line="753">    <span style="color: #89ca78;">&#39;server7&#39;</span><span style="color: #abb2bf;">,</span>
</span><span class="athl-line" data-athl-line="754">    <span style="color: #89ca78;">&#39;server8&#39;</span><span style="color: #abb2bf;">,</span>
</span><span class="athl-line" data-athl-line="755">    <span style="color: #89ca78;">&#39;server9&#39;</span><span style="color: #abb2bf;">,</span>
</span><span class="athl-line" data-athl-line="756">    <span style="color: #89ca78;">&#39;server10&#39;</span>
</span><span class="athl-line" data-athl-line="757"><span style="color: #abb2bf;">)</span>
</span><span class="athl-line" data-athl-line="758">
</span><span class="athl-line" data-athl-line="759"><span style="color: #d55fde;">[</span><span style="color: #e5c07b;">scriptblock</span><span style="color: #d55fde;">]</span><span style="color: #ef596f;">$script</span> <span style="color: #2bbac5;"><span style="color: #2bbac5;">=</span></span> <span style="color: #d55fde;">{</span>
</span><span class="athl-line" data-athl-line="760">    <span style="color: #61afef;">Get-Service</span><span style="color: #abb2bf;"> </span><span style="color: #61afef;">-DisplayName</span><span style="color: #abb2bf;"> </span><span style="color: #89ca78;">&#39;Task Scheduler&#39;</span>
</span><span class="athl-line" data-athl-line="761"><span style="color: #d55fde;">}</span>
</span><span class="athl-line" data-athl-line="762">
</span><span class="athl-line" data-athl-line="763"><span style="color: #d55fde;">foreach</span> <span style="color: #d55fde;">(</span><span style="color: #ef596f;">$server</span> <span style="color: #d55fde;">in</span> <span style="color: #ef596f;">$serverList</span><span style="color: #d55fde;">)</span> <span style="color: #d55fde;">{</span>
</span><span class="athl-line" data-athl-line="764">    <span style="color: #ef596f;">$cmdSplat</span> <span style="color: #2bbac5;"><span style="color: #2bbac5;">=</span></span> <span style="color: #abb2bf;">@{</span>
</span><span class="athl-line" data-athl-line="765">        <span style="color: #ef596f;">ComputerName</span>  <span style="color: #2bbac5;">=</span> <span style="color: #ef596f;">$server</span>
</span><span class="athl-line" data-athl-line="766">        <span style="color: #ef596f;">JobName</span>       <span style="color: #2bbac5;">=</span> <span style="color: #89ca78;">&#39;checkService&#39;</span>
</span><span class="athl-line" data-athl-line="767">        <span style="color: #ef596f;">ScriptBlock</span>   <span style="color: #2bbac5;">=</span> <span style="color: #ef596f;">$script</span>
</span><span class="athl-line" data-athl-line="768">        <span style="color: #ef596f;">AsJob</span>         <span style="color: #2bbac5;">=</span> <span style="color: #d19a66;">$true</span>
</span><span class="athl-line" data-athl-line="769">        <span style="color: #ef596f;">ErrorAction</span>   <span style="color: #2bbac5;">=</span> <span style="color: #89ca78;">&#39;SilentlyContinue&#39;</span>
</span><span class="athl-line" data-athl-line="770">    <span style="color: #abb2bf;">}</span>
</span><span class="athl-line" data-athl-line="771">    <span style="color: #61afef;">Invoke-Command</span><span style="color: #abb2bf;"> </span><span style="color: #ef596f;">@cmdSplat</span><span style="color: #abb2bf;"> </span><span style="color: #2bbac5;">|</span> <span style="color: #61afef;">Out-Null</span>
</span><span class="athl-line" data-athl-line="772"><span style="color: #d55fde;">}</span>
</span><span class="athl-line" data-athl-line="773">
</span><span class="athl-line" data-athl-line="774"><span style="color: #7f848e;">&lt;#</span>
</span><span class="athl-line" data-athl-line="775"><span style="color: #7f848e;"> Here we&#39;ve invoked jobs across many servers.</span>
</span><span class="athl-line" data-athl-line="776"><span style="color: #7f848e;"> We can now Receive-Job and see if they&#39;re all running.</span>
</span><span class="athl-line" data-athl-line="777"><span style="color: #7f848e;"> Now scale this up 100x as many servers :)</span>
</span><span class="athl-line" data-athl-line="778"><span style="color: #7f848e;">#&gt;</span>
</span></code></pre>
</body>
</html>